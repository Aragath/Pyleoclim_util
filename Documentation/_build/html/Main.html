
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Main Functions &#8212; Pyleoclim 0.3.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mapping Functions" href="Map.html" />
    <link rel="prev" title="Pyleoclim" href="Introduction.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="main-functions">
<h1>Main Functions<a class="headerlink" href="#main-functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="using-pyleoclim-with-a-lipd-file">
<h2>Using Pyleoclim with a LiPD file<a class="headerlink" href="#using-pyleoclim-with-a-lipd-file" title="Permalink to this headline">¶</a></h2>
<div class="section" id="getting-started">
<h3>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<p>Pyleoclim relies heavily on the concept of timeseries objects introduced in
<a class="reference external" href="http://www.clim-past.net/12/1093/2016/">LiPD</a> and implemented in the
<a class="reference external" href="http://nickmckay.github.io/LiPD-utilities/">LiPD utilities</a>.</p>
<p>Briefly, timeseries objects are dictionaries containing the ChronData values and
PaleoData values as well as the metadata associated with the record. If one record
has three ProxyObservations (e.g., Mg/Ca, d18O, d13C) then it will have three timeseries
objects, one for each of the observations.</p>
<p>The LiPD utilities function lipd.extractTs() returns a list of dictionaries for
the selected LiPD files, which need to be passed to Pyleoclim along with the path
to the directory containing the LiPD files.</p>
<dl class="docutils">
<dt>This is done through the functions pyleoclim.readLiPD() and pyleoclim.extracTs(),</dt>
<dd>which are lightweight versions of their counterparts in the LiPD utilities:</dd>
</dl>
<dl class="function">
<dt id="pyleoclim.readLipd">
<code class="descclassname">pyleoclim.</code><code class="descname">readLipd</code><span class="sig-paren">(</span><em>usr_path=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#readLipd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.readLipd" title="Permalink to this definition">¶</a></dt>
<dd><p>Read Lipd files into a dictionary</p>
<p>This function is based on the function of the same name in the LiPD utilities.
Sets the dictionary as global variable so that it doesn’t have to be provided
as an argument for every function.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>usr_path (str): The path to a directory or a single file. (Optional argument)</dd>
<dt>Returns:</dt>
<dd>lipd_dict - a dictionary containing the LiPD library</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.extractTs">
<code class="descclassname">pyleoclim.</code><code class="descname">extractTs</code><span class="sig-paren">(</span><em>lipds=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#extractTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.extractTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract timeseries dictionary</p>
<p>This function is based on the function of the same name in the LiPD utilities.
Set the dictionary as a global variable so that it doesn’t have to be
provided as an argument for every function.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>lipds (dict): A dictionary of LiPD files obtained through the 
readLipd function</dd>
<dt>Returns:</dt>
<dd>ts_list - A list of timeseries object</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="mapping">
<h3>Mapping<a class="headerlink" href="#mapping" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pyleoclim.mapAllArchive">
<code class="descclassname">pyleoclim.</code><code class="descname">mapAllArchive</code><span class="sig-paren">(</span><em>lipds='', markersize=50, background='shadedrelief', figsize=[10, 4], saveFig=False, dir='', format='eps'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#mapAllArchive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.mapAllArchive" title="Permalink to this definition">¶</a></dt>
<dd><p>Map all the available records loaded into the workspace by archiveType.</p>
<dl class="docutils">
<dt>Map of all the records into the workspace by archiveType.</dt>
<dd>Uses the default color palette. Enter pyleoclim.plot_default for detail.</dd>
<dt>Args:</dt>
<dd><p class="first">lipds (dict): A dictionary of LiPD files. (Optional)
markersize (int): The size of the markers. Default is 50
background (str): Plots one of the following images on the map:</p>
<blockquote>
<div>bluemarble, etopo, shadedrelief, or none (filled continents).
Default is shadedrelief.</div></blockquote>
<p>figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)     
saveFig (bool): Default is to not save the figure
dir (str): The absolute path of the directory in which to save the</p>
<blockquote>
<div>figure. If not provided, creates a default folder called ‘figures’
in the LiPD working directory (lipd.path).</div></blockquote>
<dl class="last docutils">
<dt>format (str): One of the file extensions supported by the active</dt>
<dd>backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>The figure</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.mapLipd">
<code class="descclassname">pyleoclim.</code><code class="descname">mapLipd</code><span class="sig-paren">(</span><em>timeseries='', countries=True, counties=False, rivers=False, states=False, background='shadedrelief', scale=0.5, markersize=50, marker='default', figsize=[4, 4], saveFig=False, dir='', format='eps'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#mapLipd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.mapLipd" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Map for a single record</p>
<p>Orthographic projection map of a single record.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">timeseries: a LiPD timeseries object. Will prompt for one if not given
countries (bool): Draws the country borders. Default is on (True).
counties (bool): Draws the USA counties. Default is off (False).
rivers (bool): Draws the rivers. Default is off (False).
states (bool): Draws the American and Australian states borders.</p>
<blockquote>
<div>Default is off (False)</div></blockquote>
<dl class="docutils">
<dt>background (str): Plots one of the following images on the map:</dt>
<dd>bluemarble, etopo, shadedrelief, or none (filled continents).
Default is shadedrelief</dd>
<dt>scale (float): useful to downgrade the original image resolution to</dt>
<dd>speed up the process. Default is 0.5.</dd>
</dl>
<p>markersize (int): default is 50
marker (str): a string (or list) containing the color and shape of the</p>
<blockquote>
<div>marker. Default is by archiveType. Type pyleo.plot_default to see
the default palette.</div></blockquote>
<p>figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.</p>
<blockquote>
<div>If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).</div></blockquote>
<dl class="last docutils">
<dt>format (str): One of the file extensions supported by the active</dt>
<dd>backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>The figure</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pyleoclim.plotTs">
<code class="descclassname">pyleoclim.</code><code class="descname">plotTs</code><span class="sig-paren">(</span><em>timeseries='', x_axis='', markersize=50, marker='default', figsize=[10, 4], saveFig=False, dir='', format='eps'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#plotTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.plotTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a single time series.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">A timeseries: By default, will prompt the user for one.
x_axis (str): The representation against which to plot the paleo-data.</p>
<blockquote>
<div>Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.</div></blockquote>
<p>markersize (int): default is 50.
marker (str): a string (or list) containing the color and shape of the</p>
<blockquote>
<div>marker. Default is by archiveType. Type pyleo.plot_default to see
the default palette.</div></blockquote>
<p>figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.</p>
<blockquote>
<div>If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).</div></blockquote>
<dl class="last docutils">
<dt>format (str): One of the file extensions supported by the active</dt>
<dd>backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>The figure.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.histTs">
<code class="descclassname">pyleoclim.</code><code class="descname">histTs</code><span class="sig-paren">(</span><em>timeseries='', bins=None, hist=True, kde=True, rug=False, fit=None, hist_kws={'label': 'Histogram'}, kde_kws={'label': 'KDE fit'}, rug_kws={'label': 'Rug'}, fit_kws={'label': 'Fit'}, color='default', vertical=False, norm_hist=True, figsize=[5, 5], saveFig=False, format='eps', dir=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#histTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.histTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a univariate distribution of the PaleoData values</p>
<p>This function is based on the seaborn displot function, which is
itself a combination of the matplotlib hist function with the
seaborn kdeplot() and rugplot() functions. It can also fit
scipy.stats distributions and plot the estimated PDF over the data.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">timeseries: A timeseries. By default, will prompt the user for one.
bins (int): Specification of hist bins following matplotlib(hist),</p>
<blockquote>
<div>or None to use Freedman-Diaconis rule</div></blockquote>
<p>hist (bool): Whether to plot a (normed) histogram
kde (bool): Whether to plot a gaussian kernel density estimate
rug (bool): Whether to draw a rugplot on the support axis
fit: Random variable object. An object with fit method, returning</p>
<blockquote>
<div>a tuple that can be passed to a pdf method of positional
arguments following a grid of values to evaluate the pdf on.</div></blockquote>
<dl class="docutils">
<dt>{hist, kde, rug, fit}_kws: Dictionaries. Keyword arguments for</dt>
<dd>underlying plotting functions. If modifying the dictionary, make
sure the labels “hist”, “kde”, “rug” and “fit” are still passed.</dd>
<dt>color (str): matplotlib color. Color to plot everything but the</dt>
<dd>fitted curve in. Default is to use the default paletter for each
archive type.</dd>
</dl>
<p>vertical (bool): if True, oberved values are on y-axis.
norm_hist (bool): If True (default), the histrogram height shows</p>
<blockquote>
<div>a density rather than a count. This is implied if a KDE or
fitted density is plotted</div></blockquote>
<p>figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.</p>
<blockquote>
<div>If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).</div></blockquote>
<dl class="last docutils">
<dt>format (str): One of the file extensions supported by the active</dt>
<dd>backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.</dd>
</dl>
</dd>
<dt>Returns</dt>
<dd>fig - The figure</dd>
</dl>
</dd></dl>

<div class="section" id="summary-plots">
<h4>Summary Plots<a class="headerlink" href="#summary-plots" title="Permalink to this headline">¶</a></h4>
<p>Summary plots are a special categories of plots enabled by Pyleoclim.
They allow to plot specific information about a timeseries but are not customizable.</p>
<dl class="function">
<dt id="pyleoclim.summaryTs">
<code class="descclassname">pyleoclim.</code><code class="descname">summaryTs</code><span class="sig-paren">(</span><em>timeseries=''</em>, <em>x_axis=''</em>, <em>saveFig=False</em>, <em>dir=''</em>, <em>format='eps'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#summaryTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.summaryTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic summary plot</p>
<p>Plots the following information: the time series, a histogram of
the PaleoData_values, location map, spectral density using the wwz 
method, and metadata about the record.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">timeseries: a timeseries object. By default, will prompt for one
x_axis (str): The representation against which to plot the paleo-data.</p>
<blockquote>
<div>Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.</div></blockquote>
<p>saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.</p>
<blockquote>
<div>If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).</div></blockquote>
<dl class="last docutils">
<dt>format (str): One of the file extensions supported by the active</dt>
<dd>backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>The figure</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="statistics">
<h3>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pyleoclim.statsTs">
<code class="descclassname">pyleoclim.</code><code class="descname">statsTs</code><span class="sig-paren">(</span><em>timeseries=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#statsTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.statsTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate simple statistics of a timeseries</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>timeseries: sytem will prompt for one if not given</dd>
<dt>Returns:</dt>
<dd>the mean, median, min, max, standard deviation and the
inter-quartile range (IQR) of a timeseries.</dd>
<dt>Examples:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">IQR</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">statsTs</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.corrSigTs">
<code class="descclassname">pyleoclim.</code><code class="descname">corrSigTs</code><span class="sig-paren">(</span><em>timeseries1=''</em>, <em>timeseries2=''</em>, <em>x_axis=''</em>, <em>interp_step=''</em>, <em>start=''</em>, <em>end=''</em>, <em>nsim=1000</em>, <em>method='isospectral'</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#corrSigTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.corrSigTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the significance of correlations between non IID timeseries.</p>
<p>Function written by. F. Zhu.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">timeseries1, timeseries2: timeseries object. Default is blank.
x-axis (str): The representation against which to express the</p>
<blockquote>
<div>paleo-data. Options are “age”, “year”, and “depth”.
Default is to let the system choose if only one available
or prompt the user.</div></blockquote>
<p>interp_step (float): the step size. By default, will prompt the user.
start (float): Start time/age/depth. Default is the maximum of</p>
<blockquote>
<div>the minima of the two timeseries</div></blockquote>
<dl class="docutils">
<dt>end (float): End time/age/depth. Default is the minimum of the</dt>
<dd>maxima of the two timeseries</dd>
</dl>
<p>nsim (int): the number of simulations. Default is 1000
method (str): method use to estimate the correlation and significance.</p>
<blockquote>
<div><dl class="docutils">
<dt>Available methods include:</dt>
<dd><ul class="first simple">
<li>‘ttest’: T-test where the degrees of freedom are corrected for</li>
</ul>
<p>the effect of serial correlation</p>
<ul class="simple">
<li>‘isopersistant’: AR(1) modeling of the two timeseries</li>
<li>‘isospectral’ (default): phase randomization of original</li>
</ul>
<p class="last">inputs.</p>
</dd>
</dl>
<p>The T-test is parametric test, hence cheap but usually wrong
except in idyllic circumstances.
The others are non-parametric, but their computational
requirements scales with nsim.</p>
</div></blockquote>
<p class="last">alpha (float): significance level for critical value estimation. Default is 0.05</p>
</dd>
<dt>Returns:</dt>
<dd><p class="first">r (float) - correlation between the two timeseries</p>
<p>sig (bool) -  Returns True if significant, False otherwise</p>
<p class="last">p (real) - the p-value</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="timeseries">
<h3>Timeseries<a class="headerlink" href="#timeseries" title="Permalink to this headline">¶</a></h3>
<p>Basic manipulations of the timeseries objects.</p>
<dl class="function">
<dt id="pyleoclim.binTs">
<code class="descclassname">pyleoclim.</code><code class="descname">binTs</code><span class="sig-paren">(</span><em>timeseries=''</em>, <em>x_axis=''</em>, <em>bin_size=''</em>, <em>start=''</em>, <em>end=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#binTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.binTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin the paleoData values of the timeseries</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">timeseries. By default, will prompt the user for one.
x-axis (str): The representation against which to plot the paleo-data.</p>
<blockquote>
<div>Options are “age”, “year”, and “depth”. Default is to let the
system  choose if only one available or prompt the user.</div></blockquote>
<dl class="docutils">
<dt>bin_size (float): the size of the bins to be used. By default,</dt>
<dd>will prompt for one</dd>
</dl>
<p class="last">start (float): Start time/age/depth. Default is the minimum
end (float): End time/age/depth. Default is the maximum</p>
</dd>
<dt>Returns:</dt>
<dd><p class="first">binned_values- the binned output,</p>
<p>bins-  the bins (centered on the median, i.e. the 100-200 bin is 150),</p>
<p>n-  number of data points in each bin,</p>
<p class="last">error- the standard error on the mean in each bin</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.interpTs">
<code class="descclassname">pyleoclim.</code><code class="descname">interpTs</code><span class="sig-paren">(</span><em>timeseries=''</em>, <em>x_axis=''</em>, <em>interp_step=''</em>, <em>start=''</em>, <em>end=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#interpTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.interpTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple linear interpolation</p>
<p>Simple linear interpolation of the data using the numpy.interp method</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">timeseries. Default is blank, will prompt for it
x-axis (str): The representation against which to plot the paleo-data.</p>
<blockquote>
<div>Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.</div></blockquote>
<p class="last">interp_step (float): the step size. By default, will prompt the user.
start (float): Start year/age/depth. Default is the minimum
end (float): End year/age/depth. Default is the maximum</p>
</dd>
<dt>Returns:</dt>
<dd><p class="first">interp_age - the interpolated age/year/depth according to the end/start
and time step,</p>
<p class="last">interp_values - the interpolated values</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.standardizeTs">
<code class="descclassname">pyleoclim.</code><code class="descname">standardizeTs</code><span class="sig-paren">(</span><em>timeseries=''</em>, <em>scale=1</em>, <em>ddof=0</em>, <em>eps=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#standardizeTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.standardizeTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Centers and normalizes the paleoData values of a  given time series.</p>
<p>Constant or nearly constant time series not rescaled.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>x (array): vector of (real) numbers as a time series, NaNs allowed
scale (real): a scale factor used to scale a record to a match a given variance
axis (int or None): axis along which to operate, if None, compute over the whole array
ddof (int): degress of freedom correction in the calculation of the standard deviation
eps (real): a threshold to determine if the standard deviation is too close to zero</dd>
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>z (array): the standardized time series (z-score), Z = (X - E[X])/std(X)*scale, NaNs allowed</li>
<li>mu (real): the mean of the original time series, E[X]</li>
<li>sig (real): the standard deviation of the original time series, std[X]</li>
</ul>
</dd>
<dt>References:</dt>
<dd><ol class="first last arabic simple">
<li>Tapio Schneider’s MATLAB code: <a class="reference external" href="http://www.clidyn.ethz.ch/imputation/standardize.m">http://www.clidyn.ethz.ch/imputation/standardize.m</a></li>
<li>The zscore function in SciPy: <a class="reference external" href="https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py">https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py</a></li>
</ol>
</dd>
</dl>
<p>&#64;author: fzhu</p>
</dd></dl>

</div>
<div class="section" id="analysis-in-the-frequency-domain">
<h3>Analysis in the frequency domain<a class="headerlink" href="#analysis-in-the-frequency-domain" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pyleoclim.wwzTs">
<code class="descclassname">pyleoclim.</code><code class="descname">wwzTs</code><span class="sig-paren">(</span><em>timeseries=''</em>, <em>wwz=False</em>, <em>psd=True</em>, <em>wwz_default=True</em>, <em>psd_default=True</em>, <em>wwaplot_default=True</em>, <em>psdplot_default=True</em>, <em>fig=True</em>, <em>saveFig=False</em>, <em>dir=''</em>, <em>format='eps'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim.html#wwzTs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.wwzTs" title="Permalink to this definition">¶</a></dt>
<dd><p>Weigthed wavelet Z-transform analysis</p>
<p>Wavelet analysis for unevenly spaced data adapted from Foster et al. (1996)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">timeseries (dict): A LiPD timeseries object (Optional, will prompt for one.)
wwz (bool): If True, will perform wavelet analysis
psd (bool): If True, will inform the power spectral density of the timeseries
wwz_default: If True, will use the following default parameters:</p>
<blockquote>
<div><dl class="docutils">
<dt>wwz_default = {‘tau’:None,’freqs’:None,’c’:1/(8*np.pi**2),’Neff’:3,’nMC’:200,</dt>
<dd>‘nproc’:8,’detrend’:’no’,’method’:’Kirchner_f2py’}.</dd>
</dl>
<p>Modify the values for specific keys to change the default behavior.</p>
</div></blockquote>
<p>psd_default: If True, will use the following default parameters:</p>
<blockquote>
<div><dl class="docutils">
<dt>psd_default = {‘tau’:None,</dt>
<dd>‘freqs’: None,
‘c’:1e-3,
‘nproc’:8,
‘nMC’:200,
‘detrend’:’no’,
‘Neff’:3,
‘anti_alias’:False,
‘avgs’:2,
‘method’:’Kirchner_f2py’}</dd>
</dl>
<p>Modify the values for specific keys to change the default behavior.</p>
</div></blockquote>
<p>wwaplot_default: If True, will use the following default parameters:</p>
<blockquote>
<div><dl class="docutils">
<dt>wwaplot_default={‘Neff’:3,</dt>
<dd>‘AR1_q’:AR1_q,
‘coi’:coi,
‘levels’:None,
‘tick_range’:None,
‘yticks’:None,
‘ylim’:None,
‘xticks’:None,
‘xlabels’:None,
‘figsize’:[20,8],
‘clr_map’:’OrRd’,
‘cbar_drawedges’:False,
‘cone_alpha’:0.5,
‘plot_signif’:True,
‘signif_style’:’contour’,
‘plot_cone’:True}</dd>
</dl>
<p>Modify the values for specific keys to change the default behavior.</p>
</div></blockquote>
<p>psdplot_default: If True, will use the following default parameters:</p>
<blockquote>
<div><dl class="docutils">
<dt>psdplot_default={‘lmstyle’:None,</dt>
<dd>‘linewidth’:None,
‘xticks’:None,
‘xlim’:None,
‘ylim’:None,
‘figsize’:[20,8],
‘label’:’PSD’,
‘plot_ar1’:True,
‘psd_ar1_q95’:psd_ar1_q95,
‘psd_ar1_color’:sns.xkcd_rgb[“pale red”]}</dd>
</dl>
<p>Modify the values for specific keys to change the default behavior.</p>
</div></blockquote>
<p>fig (bool): If True, plots the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.</p>
<blockquote>
<div>If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).</div></blockquote>
<dl class="last docutils">
<dt>format (str): One of the file extensions supported by the active</dt>
<dd>backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><p class="first">dict_out (dict): A dictionary of outputs.</p>
<blockquote>
<div><p>For wwz:</p>
<ul class="simple">
<li>wwa (array): The weights wavelet amplitude</li>
<li>AR1_q (array): AR1 simulations</li>
<li>coi (array): cone of influence</li>
<li>freqs (array): vector for frequencies</li>
<li>tau (array): the evenly-spaced time points, namely the time</li>
</ul>
<p>shift for wavelet analysis.</p>
<ul class="simple">
<li>Neffs (array): The matrix of effective number of points in the</li>
</ul>
<p>time-scale coordinates.</p>
<ul class="simple">
<li>coeff (array): The wavelet transform coefficients</li>
</ul>
<p>For psd:</p>
<ul class="simple">
<li>psd (array): power spectral density</li>
<li>freqs (array): vector of frequency</li>
<li>psd_ar1_q95 (array): the 95% quantile of the psds of AR1 processes</li>
</ul>
</div></blockquote>
<p>fig: The figure</p>
<dl class="last docutils">
<dt>References:</dt>
<dd>Foster, G. (1996). Wavelets for period analysis of unevenly 
sampled time series. The Astronomical Journal, 112(4), 1709-1729.</dd>
<dt>Examples:</dt>
<dd><p class="first">To run both wwz and psd:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dict_out</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">pyleoclim</span><span class="o">.</span><span class="n">wwzTs</span><span class="p">(</span><span class="n">wwz</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: This will return a single figure with wwa and psd</p>
<p>To change a default behavior:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dict_out</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">pyleoclim</span><span class="o">.</span><span class="n">wwzTs</span><span class="p">(</span><span class="n">psd_default</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nMC&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">})</span> 
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="using-pyleoclim-without-a-lipd-file">
<h2>Using Pyleoclim without a LiPD file<a class="headerlink" href="#using-pyleoclim-without-a-lipd-file" title="Permalink to this headline">¶</a></h2>
<p>The Pyleoclim modules can be called separately so the main functions can be used without a timeseries objects.
The following modules are available:</p>
<ul class="simple">
<li>pyleoclim.Map: mapping functions</li>
<li>pyleoclim.Plot: plotting functions</li>
<li>pyleoclim.Stats: statistics (including correlation)</li>
<li>pyleoclim.Timeseries: binning, interpolating</li>
<li>pyleoclim.Spectral: analysis in the frequency domain</li>
</ul>
<p>In addition, the pyleoclim.LipdUtils module allows the basic manipulation of LiPD files and the pyleoclim.SummaryPlots module
contains some functions to extract information about a timeseries object.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Pyleoclim</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Pyleoclim</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Main Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-pyleoclim-with-a-lipd-file">Using Pyleoclim with a LiPD file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-started">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mapping">Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#statistics">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timeseries">Timeseries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-in-the-frequency-domain">Analysis in the frequency domain</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-pyleoclim-without-a-lipd-file">Using Pyleoclim without a LiPD file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Map.html">Mapping Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plot.html">Plotting Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Stats.html">Statistics Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Timeseries.html">Timeseries Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="LipdUtils.html">LiPD Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="SummaryPlots.html">Summary Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectral.html">Spectral Functions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Introduction.html" title="previous chapter">Pyleoclim</a></li>
      <li>Next: <a href="Map.html" title="next chapter">Mapping Functions</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Deborah Khider, Julien Emile-Geay, Feng Zhu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/Main.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>