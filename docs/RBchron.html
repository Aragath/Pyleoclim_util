
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RBchron &#8212; Pyleoclim 0.4.0 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Spectral Functions" href="Spectral.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Spectral.html" title="Spectral Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyleoclim 0.4.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="Spectral.html"
                        title="previous chapter">Spectral Functions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/RBchron.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="rbchron">
<h1>RBchron<a class="headerlink" href="#rbchron" title="Permalink to this headline">¶</a></h1>
<p>This module helps in the preparation of a Bchron run.</p>
<p>When using this module, please cite:
* Haslett, J., and Parnell, A.C. (2008). A simple monotone process with application to radiocarbon-dated depth chronologies. Journal of the Royal Statistical Society, Series C, 57, 399-418, DOI:10.111/j.1467-9876.2008.00623.x
* Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E.,  and Huntley, B. (2008). A flexible approach to assessing  synchroneity of past events using Bayesian reconstructions of sedimentation history. Quaternary Science Reviews, 27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009</p>
<dl class="function">
<dt id="pyleoclim.RBchron.chooseCalCurves">
<code class="descclassname">pyleoclim.RBchron.</code><code class="descname">chooseCalCurves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.RBchron.chooseCalCurves" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompt for a calibration curve if not given by the user.</p>
<p>Prompt the user for the name of a calibration curve used to run the Bchron 
software package. The user can enter either enter only one name that will
be applied to each age or a list of names of different ages. To enter a list, 
separate each name with a comma. No quotation marks needed.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A list of calibration curves to be applied</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.RBchron.reservoirAgeCorrection">
<code class="descclassname">pyleoclim.RBchron.</code><code class="descname">reservoirAgeCorrection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.RBchron.reservoirAgeCorrection" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate reservoir age correction</p>
<p>Assists in estimating the reservoir age correction for marine records.
If unknown, will direct the user to copy and paste the table available
on the 14Chrono Marine Reservoir database: <a class="reference external" href="http://intcal.qub.ac.uk/marine/">http://intcal.qub.ac.uk/marine/</a></p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><p class="first">ageCorr -  the DeltaR for the site.</p>
<p class="last">ageCorrStd - The error on DeltaR estimated as the standard error on the 
mean if using the 14Chrono Marine Reservoir database.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.RBchron.runBchron">
<code class="descclassname">pyleoclim.RBchron.</code><code class="descname">runBchron</code><span class="sig-paren">(</span><em>ages</em>, <em>agesStd</em>, <em>positions</em>, <em>rejectAges=None</em>, <em>positionsThickness=None</em>, <em>calCurves=None</em>, <em>reservoirAgeCorr=None</em>, <em>outlierProbs=None</em>, <em>predictPositions=None</em>, <em>iterations=10000</em>, <em>burn=2000</em>, <em>thin=8</em>, <em>extractDate=-68</em>, <em>maxExtrap=500</em>, <em>thetaMhSd=0.5</em>, <em>muMhSd=0.1</em>, <em>psiMhSd=0.1</em>, <em>ageScaleVal=1000</em>, <em>positionScaleVal=100</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.RBchron.runBchron" title="Permalink to this definition">¶</a></dt>
<dd><p>Age model for Tie-Point chronologies</p>
<p>Fits a non-parametric chronology model to age/position data according to
the Compound Poisson-Gamma model defined by Haslett and Parnell (2008). 
This version used a slightly modified Markov chain Monte-Carlo fitting
algorithm which aims to converge quicker and requires fewer iterations.
It also a slightly modified procedure for identifying outliers.</p>
<p>The Bchronology functions fits a compounf Poisson-Gamma distribution to the
incrememnts between the dated levels. This involves a stochastic linear
interpolation step where the age gaps are Gamma distributed, and the position
gaps are Exponential. Radiocarbon and non-radiocarbon dates (including outliers)
are updated within the fucntion also by MCMC.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ages (array): A vector of ages (most likely 14C)
ageSds (array): A vector of 1-sigma values for the ages given above
positions (array): Position values (e.g. depths) for each age
rejectAges (vector): A vector of 1/0 where 1 include the dates to be rejected.</p>
<blockquote>
<div>Default it None.</div></blockquote>
<dl class="last docutils">
<dt>positionsThickness (array): (Optional) Thickness values for each of the positions.</dt>
<dd>The thickness values should be the full thickness value of the
slice. By default set to zero.</dd>
<dt>calCurves (list): (Optional) A vector of values containing either ‘intcal13’,</dt>
<dd>‘marine13’, ‘shcal13’, or ‘normal’. If none is provided, will
prompt the user. Should be either of length =1 if using the same
calibration for each age or the same length as the vector of ages.</dd>
<dt>reservoirAgeCorr (array): (Optional) A list (matrix) of two floats that correspond to the</dt>
<dd>DeltaR and DeltaR uncertainty. If already added to the ages and
ages standard deviation, then enter [0,0] to bypass the prompt.
Will only be applied if CalCurves is set to ‘marine13’. Otherwise,
leave to none.</dd>
<dt>outlierProbs (array): (Optional) A vector of prior outlier probabilities,</dt>
<dd>one for each age. Defaults to 0.01</dd>
<dt>predictPositions (array): (Optional) a vector of positions </dt>
<dd>(e.g. depths) at which predicted age values are required. 
Defaults to a sequence of length 100 from the top position to the
bottom position.</dd>
<dt>iterations (int): (Optional) The number of iterations to start the procedure. </dt>
<dd>Default and minimum should be 10000.</dd>
<dt>burn (int): (Optional) The number of starting iterations to discard.</dt>
<dd>Default is 200</dd>
<dt>thin (int): (Optional) The step size for every iteration to keep beyond</dt>
<dd>the burnin. Default is 8.</dd>
<dt>extractDate (float): (Optional) The top age of the core. Used for</dt>
<dd>extrapolation purposes so that no extrapolated ages go beyond the
top age of the core. Defaults to the current year.</dd>
<dt>maxExtrap (int): (Optional) The maximum number of extrapolations to</dt>
<dd>perform before giving up and setting the predicted ages to NA. 
Useful for when large amounts of extrapolation are required, i.e.
some of the predictPositions are a long way from the dated
positions. Defaults to 500.</dd>
<dt>thetaMhSd (float):  (Optional)  The Metropolis-Hastings standard</dt>
<dd>deviation for the age parameters. Defaults to 0.5.</dd>
<dt>muMhSd (float): (Optional)  The Metropolis-Hastings standard deviation</dt>
<dd>for the compound Poisson-Gamma Scale. Defaults to 0.1</dd>
<dt>psiMhSd (float): (Optional) The Metropolis-Hastings standard deviation </dt>
<dd>for the Compound Poisson-Gamma Scale.</dd>
<dt>ageScaleVal (int): (Optional) A scale value for the ages. </dt>
<dd>Bchronology works best when the ages are scaled to be 
approximately between 0 and 100.
The default value is thus 1000 for ages given in years.</dd>
<dt>positionScaleVal (int):  (Optional) A scale value for the positions. </dt>
<dd>Bchronology works best when the positions are scaled to be 
approximately between 0 and 100. The default value is thus
100 for positions given in cm.</dd>
<dt>Returns:</dt>
<dd><p class="first">depth - the predicted positions (either same as the user or the default)</p>
<dl class="docutils">
<dt>chron -  a numpy array of possible chronologies in each column.</dt>
<dd>The number of rows is the same as the length of depth</dd>
</dl>
<p class="last">ageDist - the distribution of ages around each dates.
run - the full R object containing the outputs of the Bchron run</p>
</dd>
<dt>Warnings:</dt>
<dd><dl class="first last docutils">
<dt>This function requires R and the Bchron package and all its</dt>
<dd>dependencies to be installed on the same machine.</dd>
</dl>
</dd>
<dt>Reference:</dt>
<dd><ul class="first last simple">
<li><dl class="first docutils">
<dt>Haslett, J., and Parnell, A. C. (2008). A simple monotone </dt>
<dd>process with application to radiocarbon-dated depth 
chronologies. Journal of the Royal Statistical Society, 
Series C, 57, 399-418. DOI:10.1111/j.1467-9876.2008.00623.x</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E., </dt>
<dd>and Huntley, B. (2008). A flexible approach to assessing 
synchroneity of past events using Bayesian reconstructions
of sedimentation history. Quaternary Science Reviews, 
27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.RBchron.plotBchron">
<code class="descclassname">pyleoclim.RBchron.</code><code class="descname">plotBchron</code><span class="sig-paren">(</span><em>depth, chron, positions, ageDist, flipCoor=False, xlabel='Depth', ylabel='Age', xlim=None, ylim=None, violinColor='#8B008B', medianLineColor='black', medianLineWidth=2.0, CIFillColor='Silver', samplePaths=True, samplePathNumber=10, alpha=0.5, figsize=[4, 8], ax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.RBchron.plotBchron" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a Bchron output</p>
<p>This function creates a plot showing the calibrated calendar ages and
associated 95% confidence interval as error bars, the 95% ensemble from
the produced age model as well as randomly drawn members of the ensemble.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>depth (array): the positions in the archive (often referred to as</dt>
<dd>depth) where the age model was interpolated to. Should be a vector</dd>
<dt>chron (array): The possible age models returned by BChron. The number</dt>
<dd>of rows should be the same length as the depth vector, with each
possible realization stored in the columns.</dd>
<dt>positions (array): The depth on the archive at which chronological</dt>
<dd>measurements have been made. Should be a vector</dd>
<dt>agesDist (array): The distribution of ages for each chronological tie</dt>
<dd>points. The number of columns should correspond to the number of
chronological tie points available.</dd>
</dl>
<p>flipCoor (bool): If True, plots depth on the y-axis.     
xlabel (str): The label for the x-axis
ylabel (str): The label for the y-axis
xlim (list): Limits for the x-axis. Default corresponds to the min/max</p>
<blockquote>
<div>of the depth vector.</div></blockquote>
<p>ylim (list): Limits for the y-axis. Default set by matplotlib
violinColor (str): The color for the violins. Default is purple
medianLineColor (str): The color for the median line. Default is black.
medianLineWidth (float): The width for the median line
CIFillColor (str): Fill color in between the 95% confidence interval.</p>
<blockquote>
<div>Default is silver.</div></blockquote>
<dl class="docutils">
<dt>samplePaths (bool): If True, draws sample paths from the distribution.</dt>
<dd>Use the same color as the violins.</dd>
<dt>samplePathNumber (int): The number of sample paths to draw. Default is 10.</dt>
<dd>Note: samplePaths need to be set to True.</dd>
</dl>
<p class="last">alpha (float): The violins’ transparency. Number between 0 and 1
figsize (list): The figure size. Default is [4,8]
ax: Default is None. Useful to set for subplots.</p>
</dd>
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>fig: the figure.</li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Spectral.html" title="Spectral Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyleoclim 0.4.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2018, Deborah Khider, Julien Emile-Geay, Feng Zhu.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>