
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Timeseries Functions &#8212; Pyleoclim 0.4.8 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Summary Plots" href="SummaryPlots.html" />
    <link rel="prev" title="Statistics Functions" href="Stats.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="SummaryPlots.html" title="Summary Plots"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Stats.html" title="Statistics Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyleoclim 0.4.8 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="Stats.html"
                        title="previous chapter">Statistics Functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="SummaryPlots.html"
                        title="next chapter">Summary Plots</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Timeseries.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="timeseries-functions">
<h1>Timeseries Functions<a class="headerlink" href="#timeseries-functions" title="Permalink to this headline">¶</a></h1>
<p>This module allows the manipulation of timeseries.</p>
<dl class="function">
<dt id="pyleoclim.Timeseries.bin">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">bin</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>bin_size=''</em>, <em>start=''</em>, <em>end=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin the values</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>x (array): the x-axis series.
y (array): the y-axis series.
bin_size (float): The size of the bins. Default is the average resolution
start (float): Where/when to start binning. Default is the minimum
end (float): When/where to stop binning. Defulat is the maximum</dd>
<dt>Returns:</dt>
<dd><p class="first">binned_values - the binned output</p>
<p>bins - the bins (centered on the median, i.e., the 100-200 bin is 150)</p>
<p>n - number of data points in each bin</p>
<p class="last">error -  the standard error on the mean in each bin</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.interp">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">interp</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>interp_step=''</em>, <em>start=''</em>, <em>end=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear interpolation onto a new x-axis</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>x (array): the x-axis
y (array): the y-axis
interp_step (float): the interpolation step. Default is mean resolution.
start (float): where/when to start the interpolation. Default is min..
end (float): where/when to stop the interpolation. Default is max.</dd>
<dt>Returns:</dt>
<dd><p class="first">xi - the interpolated x-axis</p>
<p class="last">interp_values - the interpolated values</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.onCommonAxis">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">onCommonAxis</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>interp_step=''</em>, <em>start=''</em>, <em>end=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.onCommonAxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Places two timeseries on a common axis</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>x1 (array): x-axis values of the first timeseries
y1 (array): y-axis values of the first timeseries
x2 (array): x-axis values of the second timeseries
y2 (array): y-axis values of the second timeseries
interp_step (float): The interpolation step. Default is mean resolution
of lowest resolution series
start (float): where/when to start. Default is the maximum of the minima of
the two timeseries
end (float): Where/when to end. Default is the minimum of the maxima of
the two timeseries</dd>
<dt>Returns:</dt>
<dd><p class="first">xi -  the interpolated x-axis</p>
<p class="last">interp_values1 -  the interpolated y-values for the first timeseries
interp_values2 - the intespolated y-values for the second timeseries</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.standardize">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">standardize</code><span class="sig-paren">(</span><em>x</em>, <em>scale=1</em>, <em>axis=0</em>, <em>ddof=0</em>, <em>eps=0.001</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Centers and normalizes a given time series. Constant or nearly constant time series not rescaled.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>x (array): vector of (real) numbers as a time series, NaNs allowed
scale (real): a scale factor used to scale a record to a match a given variance
axis (int or None): axis along which to operate, if None, compute over the whole array
ddof (int): degress of freedom correction in the calculation of the standard deviation
eps (real): a threshold to determine if the standard deviation is too close to zero</dd>
<dt>Returns:</dt>
<dd>z (array): the standardized time series (z-score), Z = (X - E[X])/std(X)*scale, NaNs allowed
mu (real): the mean of the original time series, E[X]
sig (real): the standard deviation of the original time series, std[X]</dd>
<dt>References:</dt>
<dd><ol class="first last arabic simple">
<li>Tapio Schneider’s MATLAB code: <a class="reference external" href="http://www.clidyn.ethz.ch/imputation/standardize.m">http://www.clidyn.ethz.ch/imputation/standardize.m</a></li>
<li>The zscore function in SciPy: <a class="reference external" href="https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py">https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py</a></li>
</ol>
</dd>
</dl>
<p>&#64;author: fzhu</p>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.ts2segments">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">ts2segments</code><span class="sig-paren">(</span><em>ys</em>, <em>ts</em>, <em>factor=10</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.ts2segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Chop a time series into several segments based on gap detection.</p>
<dl class="docutils">
<dt>The rule of gap detection is very simple:</dt>
<dd>we define the intervals between time points as dts, then if dts[i] is larger than factor * dts[i-1],
we think that the change of dts (or the gradient) is too large, and we regard it as a breaking point
and chop the time series into two segments here</dd>
<dt>Args:</dt>
<dd>ys (array): a time series, NaNs allowed
ts (array): the time points
factor (float): the factor that adjusts the threshold for gap detection</dd>
<dt>Returns:</dt>
<dd>seg_ys (list): a list of several segments with potentially different lengths
seg_ts (list): a list of the time axis of the several segments
n_segs (int): the number of segments</dd>
</dl>
<p>&#64;author: fzhu</p>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.clean_ts">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">clean_ts</code><span class="sig-paren">(</span><em>ys</em>, <em>ts</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.clean_ts" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the NaNs in the time series and sort it with time axis ascending</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ys (array): a time series, NaNs allowed
ts (array): the time axis of the time series, NaNs allowed</dd>
<dt>Returns:</dt>
<dd>ys (array): the time series without nans
ts (array): the time axis of the time series without nans</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.annualize">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">annualize</code><span class="sig-paren">(</span><em>ys</em>, <em>ts</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.annualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Annualize a time series whose time resolution is finer than 1 year</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ys (array): a time series, NaNs allowed
ts (array): the time axis of the time series, NaNs allowed</dd>
<dt>Returns:</dt>
<dd>ys_ann (array): the annualized time series
year_int (array): the time axis of the annualized time series</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.gaussianize">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">gaussianize</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.gaussianize" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a (proxy) timeseries to Gaussian distribution.</p>
<p>Originator: Michael Erb, Univ. of Southern California - April 2017</p>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.gaussianize_single">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">gaussianize_single</code><span class="sig-paren">(</span><em>X_single</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.gaussianize_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a single (proxy) timeseries to Gaussian distribution.</p>
<p>Originator: Michael Erb, Univ. of Southern California - April 2017</p>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.Timeseries.detrend">
<code class="descclassname">pyleoclim.Timeseries.</code><code class="descname">detrend</code><span class="sig-paren">(</span><em>y, x=None, method='linear', params=['default', 4, 0, 1]</em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.Timeseries.detrend" title="Permalink to this definition">¶</a></dt>
<dd><p>Detrend a timeseries according to three methods</p>
<dl class="docutils">
<dt>Detrending methods include, “linear” (default), “constant”, and using a low-pass</dt>
<dd>Savitzky-Golay filters.</dd>
<dt>Args:</dt>
<dd><p class="first">y (array): The series to be detrended.
x (array): The time axis for the timeseries. Necessary for use with</p>
<blockquote>
<div>the Savitzky-Golay filters method since the series should be evenly spaced.</div></blockquote>
<dl class="last docutils">
<dt>method (str): The type of detrending. If linear (default), the result of</dt>
<dd>a linear least-squares fit to y is subtracted from y. If constant,
only the mean of data is subtrated. If “savitzy-golay”, y is filtered
using the Savitzky-Golay filters and the resulting filtered series
is subtracted from y.</dd>
<dt>params (list): The paramters for the Savitzky-Golay filters. The first parameter</dt>
<dd>corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>ys (array) - the detrended timeseries.</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="SummaryPlots.html" title="Summary Plots"
             >next</a> |</li>
        <li class="right" >
          <a href="Stats.html" title="Statistics Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyleoclim 0.4.8 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2018, Deborah Khider, Julien Emile-Geay, Feng Zhu.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>