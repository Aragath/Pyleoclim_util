%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{2}



\title{Pyleoclim Documentation}
\date{Sep 04, 2019}
\release{0.4.9}
\author{Deborah Khider, Feng Zhu, Julien Emile-Geay}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


Contents:


\chapter{Pyleoclim}
\label{\detokenize{Introduction:pyleoclim}}\label{\detokenize{Introduction::doc}}

\section{What is it?}
\label{\detokenize{Introduction:what-is-it}}
Pyleoclim is a Python package primarily geared towards the analysis and visualization of paleoclimate data.
Such data often come in the form of timeseries with missing values and age uncertainties,
so the package includes several low-level methods to deal with these issues,
as well as high-level methods that re-use those within scientific workflows.

High-level modules assume that data are stored in the Linked Paleo Data (\sphinxhref{http://www.clim-past.net/12/1093/2016/}{LiPD}) format
and makes extensive use of the \sphinxhref{http://nickmckay.github.io/LiPD-utilities/}{LiPD utilities}. Low-level modules are primarily
based on numpy arrays or Pandas dataframes, so Pyleoclim contains a lot of
timeseries analysis code (e.g. spectral analysis, singular spectrum analysis,
wavelet analysis, correlation analysis) that can apply to these more common types
as well. See the example folder for details.

The package is aware of age ensembles stored via LiPD and uses them for time-uncertain analyses very much like \sphinxhref{http://nickmckay.github.io/GeoChronR/}{GeoChronR}.

\sphinxstylestrong{Current Capabilities:}
\begin{itemize}
\item {} 
binning

\item {} 
interpolation

\item {} 
plotting maps, timeseries, and basic age model information

\item {} 
paleo-aware correlation analysis (isopersistent, isospectral, and classical t-test)

\item {} 
weighted wavelet Z transform (WWZ)

\item {} 
age modeling through Bchron

\end{itemize}

\sphinxstylestrong{Future capabilities:}
\begin{itemize}
\item {} 
paleo-aware singular spectrum analysis (AR(1) null eigenvalue identification, missing data)

\item {} 
spectral analysis (Multi-Taper Method, Lomb-Scargle)

\item {} 
cross-wavelet analysis

\item {} 
index reconstruction

\item {} 
climate reconstruction

\item {} 
causality

\item {} 
ensemble methods for most of the above

\end{itemize}


\section{Installation}
\label{\detokenize{Introduction:installation}}
Python v3.6 is \sphinxstylestrong{required}.

We recommend using \sphinxhref{https://www.anaconda.com/distribution/}{Anaconda} and creating a new environment:
\begin{quote}

conda create \textendash{}name pyleoclim python=3.6
\end{quote}

Activate the environment:
\begin{quote}

conda activate pyleoclim
\end{quote}

To install Pyleoclim, first install Cartopy and Numpy through Anaconda.
\begin{quote}

conda install -c conda-forge cartopy
conda install numpy
\end{quote}

Pyleoclim is published through Pypi and easily installed via pip:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{pyleoclim}
\end{sphinxVerbatim}

Some functionalities require R. See Installation for details.


\section{Version Information}
\label{\detokenize{Introduction:version-information}}
\sphinxstylestrong{Current Version}

\begin{DUlineblock}{0em}
\item[] 0.4.9: Major bug fixes; mapping module based on cartopy; compatibility with latest numpy package
\end{DUlineblock}

\sphinxstylestrong{Past Version}
\textbar{} 0.4.8: Add support of f2py WWZ for Linux
\textbar{} 0.4.7: Update to coherence function
\textbar{} 0.4.0: New functionalities: map nearest records by archive type, plot ensemble time series, age modelling through Bchron.
\textbar{} 0.3.1: New functionalities: segment a timeseries using a gap detection criteria, update to summary plot to perform spectral analysis
\textbar{} 0.3.0: Compatibility with LiPD 1.3 and Spectral module added
\textbar{} 0.2.5: Fix error on loading (Looking for Spectral Module)
\textbar{} 0.2.4: Fix load error from init
\textbar{} 0.2.3: Freeze LiPD version to 1.2 to avoid conflicts with 1.3
\textbar{} 0.2.2: Change progressbar to tqdm and add standardization function
\textbar{} 0.2.1: Update package requirements
\textbar{} 0.2.0: Restructure the package so that the main functions can be called without the use of a LiPD files and associated timeseries objects.
\textbar{} 0.1.4: Rename functions using camel case convention and consistency with LiPD utilities version 0.1.8.5
\textbar{} 0.1.3: Compatible with LiPD utilities version 0.1.8.5
\textbar{}        Function openLiPD() renamed openLiPDs()
\textbar{} 0.1.2: Compatible with LiPD utilities version 0.1.8.3
\textbar{}        Uses Basemap instead of cartopy
\textbar{} 0.1.1: Freezes the package prior to version 0.1.8.2 of LiPD utilities
\textbar{} 0.1.0: First release


\section{Quickstart guide}
\label{\detokenize{Introduction:quickstart-guide}}\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
Install Pyleoclim

\end{enumerate}
\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\setcounter{enumi}{2}
\item {} 
Wait for installation to complete, then:

\end{enumerate}
\begin{enumerate}
\def\theenumi{\alph{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
Import the package into your favorite Python environment (we recommend the use of Spyder, which comes standard with the Anaconda build)

\item {} 
Use Jupyter Notebook to go through the tutorial contained in the \sphinxhref{https://github.com/LinkedEarth/Pyleoclim\_util/tree/master/Example}{PyleolimQuickstart.ipynb}

\end{enumerate}


\section{Requirements}
\label{\detokenize{Introduction:requirements}}
Tested with:
\begin{itemize}
\item {} 
LiPD 0.2.7

\item {} 
pandas v0.25.0

\item {} 
numpy v1.16.4

\item {} 
matplotlib v3.1.0

\item {} 
Cartopy v1.17.0

\item {} 
scipy v1.3.1

\item {} 
statsmodel v0.8.0

\item {} 
seaborn 0.9.0

\item {} 
scikit-learn 0.21.3

\item {} 
tqdm 4.33.0

\item {} 
pathos 0.2.4

\item {} 
rpy2 3.0.5

\end{itemize}

The installer will automatically check for the needed updates.


\section{Known issues}
\label{\detokenize{Introduction:known-issues}}\begin{itemize}
\item {} 
Some of the packages supporting Pyleoclim do not have a build for Windows

\item {} 
Known issues with proj4 v5.0-5.1, make sure your environment is setup with 5.2

\end{itemize}


\section{Further information}
\label{\detokenize{Introduction:further-information}}
\begin{DUlineblock}{0em}
\item[] GitHub: \sphinxurl{https://github.com/LinkedEarth/Pyleoclim\_util}
\item[] LinkedEarth: \sphinxurl{http://linked.earth}
\item[] Python and Anaconda: \sphinxurl{http://conda.pydata.org/docs/test-drive.html}
\item[] Jupyter Notebook: \sphinxurl{http://jupyter.org/}
\end{DUlineblock}


\section{Contact}
\label{\detokenize{Introduction:contact}}
Please report issues to \sphinxhref{mailto:linkedearth@gmail.com}{linkedearth@gmail.com}


\section{License}
\label{\detokenize{Introduction:license}}
The project is licensed under the \sphinxhref{https://github.com/LinkedEarth/Pyleoclim\_util/blob/master/license}{GNU Public License} .
If you use the code in publications, please credit the work using \sphinxhref{https://zenodo.org/record/1212692\#.WsaZ7maZNE4}{this citation}.


\section{Disclaimer}
\label{\detokenize{Introduction:disclaimer}}
This material is based upon work supported by the U.S. National Science Foundation under Grant Number
ICER-1541029. Any opinions, findings, and conclusions or recommendations expressed in this material are those
of the investigators and do not necessarily reflect the views of the National Science Foundation.


\chapter{Installation}
\label{\detokenize{Installation:installation}}\label{\detokenize{Installation::doc}}
We recommend the use of Anaconda or Miniconda, with Pyleoclim setup in
its own environment.


\section{Installing Anaconda or Miniconda}
\label{\detokenize{Installation:installing-anaconda-or-miniconda}}
To install Anaconda or Miniconda on your platform, follow the instructions from \sphinxhref{https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html}{this page}.


\section{Creating a new Anaconda environment}
\label{\detokenize{Installation:creating-a-new-anaconda-environment}}
To create a new environment using Python 3.6 via command line:
\begin{quote}

conda create -n pyleoenv python=3.6
\end{quote}

To view a list of available environment:
\begin{quote}

conda env list
\end{quote}

To activate your new environment:
\begin{quote}

conda activate pyleoenv
\end{quote}

To view the list of packages in your environment:
\begin{quote}

conda list
\end{quote}

To remove the environment:
\begin{quote}

conda remove \textendash{}name pyleoenv \textendash{}all
\end{quote}

More information about managing conda environments can be found \sphinxhref{https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html\#}{here}.


\section{Installing Pyleoclim}
\label{\detokenize{Installation:installing-pyleoclim}}
Make sure that the pyleoenv environment is activated.

\sphinxstylestrong{First} install numpy and Cartopy:
\begin{quote}

conda install numpy
conda install -c conda-forge cartopy
\end{quote}

Make sure that the package proj4 is version 5.2+
\begin{quote}

conda list
\end{quote}

Install Pyleoclim
\begin{quote}

pip install pyleoclim
\end{quote}


\section{Installing R}
\label{\detokenize{Installation:installing-r}}
Some functionalities require an installation of \sphinxhref{https://www.r-project.org?}{R}.

To install R, download a mirror \sphinxtitleref{here \textless{}https://cran.r-project.org/mirrors.html\textgreater{}{}`\_}.
Note that Rstudio is not needed when calling R from Python.

Pyleoclim requires the \sphinxtitleref{Bchron package \textless{}https://cran.r-project.org/web/packages/Bchron/index.html\textgreater{}{}`\_}. Pyleoclim will check for an installation of Bchron. It it doesn’t exist, it will be installed.


\chapter{Main Functions}
\label{\detokenize{Main:main-functions}}\label{\detokenize{Main::doc}}

\section{Using Pyleoclim with a LiPD file}
\label{\detokenize{Main:using-pyleoclim-with-a-lipd-file}}

\subsection{Getting started}
\label{\detokenize{Main:getting-started}}
Pyleoclim relies heavily on the concept of timeseries objects introduced in
\sphinxhref{http://www.clim-past.net/12/1093/2016/}{LiPD} and implemented in the
\sphinxhref{http://nickmckay.github.io/LiPD-utilities/}{LiPD utilities}.

Briefly, timeseries objects are dictionaries containing the ChronData values and
PaleoData values as well as the metadata associated with the record. If one record
has three ProxyObservations (e.g., Mg/Ca, d18O, d13C) then it will have three timeseries
objects, one for each of the observations.

The LiPD utilities function lipd.extractTs() returns a list of dictionaries for
the selected LiPD files, which need to be passed to Pyleoclim along with the path
to the directory containing the LiPD files.
\begin{description}
\item[{This is done through the functions pyleoclim.openLiPD() and pyleoclim.fetchTs(),}] \leavevmode
which are lightweight versions of their counterparts in the LiPD utilities:

\end{description}
\index{openLipd() (in module pyleoclim)@\spxentry{openLipd()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.openLipd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{openLipd}}}{\emph{usr\_path=None}}{}
Read Lipd files into a dictionary

Sets the dictionary as global variable so that it doesn’t have to be provided
as an argument for every function.
\begin{description}
\item[{Args:}] \leavevmode
usr\_path (str): The path to a directory or a single file. (Optional argument)

\item[{Returns:}] \leavevmode
lipd\_dict - a dictionary containing the LiPD library

\end{description}

\end{fulllineitems}

\index{fetchTs() (in module pyleoclim)@\spxentry{fetchTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.fetchTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{fetchTs}}}{\emph{lipds=None}}{}
Extract timeseries dictionary

This function is based on the function of the same name in the LiPD utilities.
Set the dictionary as a global variable so that it doesn’t have to be
provided as an argument for every function.
\begin{description}
\item[{Args:}] \leavevmode
lipds (dict): A dictionary of LiPD files obtained through the
readLipd function

\item[{Returns:}] \leavevmode
ts\_list - A list of timeseries object

\end{description}

\end{fulllineitems}



\subsection{Mapping}
\label{\detokenize{Main:mapping}}\index{mapAllArchive() (in module pyleoclim)@\spxentry{mapAllArchive()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.mapAllArchive}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{mapAllArchive}}}{\emph{lipds=None, markersize=50, projection='Robinson', proj\_default=True, background=True, borders=False, rivers=False, lakes=False, figsize={[}10, 4{]}, saveFig=False, dir=None, format='eps'}}{}
Map all the available records loaded into the workspace by archiveType.
\begin{description}
\item[{Map of all the records into the workspace by archiveType.}] \leavevmode
Uses the default color palette. Enter pyleoclim.plot\_default for detail.

\item[{Args:}] \leavevmode
lipds (dict): A list of LiPD files. (Optional)
markersize (int): The size of the markers. Default is 50
projection (string): the map projection. Available projections:
\begin{quote}

‘Robinson’, ‘PlateCarree’, ‘AlbertsEqualArea’,
‘AzimuthalEquidistant’,’EquidistantConic’,’LambertConformal’,
‘LambertCylindrical’,’Mercator’,’Miller’,’Mollweide’,’Orthographic’ (Default),
‘Sinusoidal’,’Stereographic’,’TransverseMercator’,’UTM’,
‘InterruptedGoodeHomolosine’,’RotatedPole’,’OSGB’,’EuroPP’,
‘Geostationary’,’NearsidePerspective’,’EckertI’,’EckertII’,
‘EckertIII’,’EckertIV’,’EckertV’,’EckertVI’,’EqualEarth’,’Gnomonic’,
‘LambertAzimuthalEqualArea’,’NorthPolarStereo’,’OSNI’,’SouthPolarStereo’
\end{quote}
\begin{description}
\item[{proj\_default (bool): If True, uses the standard projection attributes, including centering.}] \leavevmode
Enter new attributes in a dictionary to change them. Lists of attributes
can be found in the Cartopy documentation:
\begin{quote}

\sphinxurl{https://scitools.org.uk/cartopy/docs/latest/crs/projections.html\#eckertiv}
\end{quote}

\item[{background (bool): If True, uses a shaded relief background (only one }] \leavevmode
available in Cartopy)

\end{description}

borders (bool): Draws the countries border. Defaults is off (False). 
rivers (bool): Draws major rivers. Default is off (False).
lakes (bool): Draws major lakes.
\begin{quote}

Default is off (False).
\end{quote}

figsize (list): the size for the figure
saveFig (bool): Default is to not save the figure
dir (str): The absolute path of the directory in which to save the
\begin{quote}

figure. If not provided, creates a default folder called ‘figures’
in the LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{mapLipd() (in module pyleoclim)@\spxentry{mapLipd()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.mapLipd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{mapLipd}}}{\emph{timeseries=None, projection='Orthographic', proj\_default=True, background=True, label='default', borders=False, rivers=False, lakes=False, markersize=50, marker='default', figsize={[}4, 4{]}, saveFig=False, dir=None, format='eps'}}{}
Create a Map for a single record

Orthographic projection map of a single record.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a LiPD timeseries object. Will prompt for one if not given
projection (string): the map projection. Available projections:
\begin{quote}

‘Robinson’, ‘PlateCarree’, ‘AlbertsEqualArea’,
‘AzimuthalEquidistant’,’EquidistantConic’,’LambertConformal’,
‘LambertCylindrical’,’Mercator’,’Miller’,’Mollweide’,’Orthographic’ (Default),
‘Sinusoidal’,’Stereographic’,’TransverseMercator’,’UTM’,
‘InterruptedGoodeHomolosine’,’RotatedPole’,’OSGB’,’EuroPP’,
‘Geostationary’,’NearsidePerspective’,’EckertI’,’EckertII’,
‘EckertIII’,’EckertIV’,’EckertV’,’EckertVI’,’EqualEarth’,’Gnomonic’,
‘LambertAzimuthalEqualArea’,’NorthPolarStereo’,’OSNI’,’SouthPolarStereo’
\end{quote}
\begin{description}
\item[{proj\_default (bool): If True, uses the standard projection attributes, including centering.}] \leavevmode
Enter new attributes in a dictionary to change them. Lists of attributes
can be found in the Cartopy documentation:
\begin{quote}

\sphinxurl{https://scitools.org.uk/cartopy/docs/latest/crs/projections.html\#eckertiv}
\end{quote}

\item[{background (bool): If True, uses a shaded relief background (only one }] \leavevmode
available in Cartopy)

\item[{label (str): label for archive marker. Default is to use the name of the }] \leavevmode
physical sample. If no archive name is available, default to
None. None returns no label.

\end{description}

borders (bool): Draws the countries border. Defaults is off (False). 
rivers (bool): Draws major rivers. Default is off (False).
lakes (bool): Draws major lakes.
\begin{quote}

Default is off (False).
\end{quote}

markersize (int): The size of the marker.
marker (str or list): color and type of marker. Default will use the
default color palette for archives
figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{mapNearRecords() (in module pyleoclim)@\spxentry{mapNearRecords()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.mapNearRecords}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{mapNearRecords}}}{\emph{timeseries=None, lipds=None, n=5, radius=None, sameArchive=False, projection='Orthographic', proj\_default=True, borders=False, rivers=False, lakes=False, background=True, markersize=200, markersize\_adjust=True, marker\_r='ko', marker\_c='default', cmap='Reds', colorbar=True, location='right', label='Distance in km', figsize={[}4, 4{]}, ax=None, saveFig=False, dir=None, format='eps'}}{}
Map the nearest records from the record of interest
\begin{description}
\item[{Args:}] \leavevmode
timeseries (dict): A timeseries object. If none given, will prompt for one
lipds (list): A list of LiPD files. (Optional)
n (int): the number of records to match
radius (float): The distance (in km) to search for nearby records.
\begin{quote}

Default is to search the entire globe
\end{quote}
\begin{description}
\item[{sameArchive (bool): Returns only records with the same archiveType.}] \leavevmode
Default is not to do so.

\item[{projection (string): the map projection. Available projections:}] \leavevmode
‘Robinson’, ‘PlateCarree’, ‘AlbertsEqualArea’,
‘AzimuthalEquidistant’,’EquidistantConic’,’LambertConformal’,
‘LambertCylindrical’,’Mercator’,’Miller’,’Mollweide’,’Orthographic’ (Default),
‘Sinusoidal’,’Stereographic’,’TransverseMercator’,’UTM’,
‘InterruptedGoodeHomolosine’,’RotatedPole’,’OSGB’,’EuroPP’,
‘Geostationary’,’NearsidePerspective’,’EckertI’,’EckertII’,
‘EckertIII’,’EckertIV’,’EckertV’,’EckertVI’,’EqualEarth’,’Gnomonic’,
‘LambertAzimuthalEqualArea’,’NorthPolarStereo’,’OSNI’,’SouthPolarStereo’

\item[{proj\_default (bool): If True, uses the standard projection attributes, including centering.}] \leavevmode
Enter new attributes in a dictionary to change them. Lists of attributes
can be found in the Cartopy documentation:
\begin{quote}

\sphinxurl{https://scitools.org.uk/cartopy/docs/latest/crs/projections.html\#eckertiv}
\end{quote}

\item[{background (bool): If True, uses a shaded relief background (only one }] \leavevmode
available in Cartopy)

\end{description}

borders (bool): Draws the countries border. Defaults is off (False). 
rivers (bool): Draws major rivers. Default is off (False).
lakes (bool): Draws major lakes.
\begin{quote}

Default is off (False).
\end{quote}

markersize (int): the size of the marker
markersize\_adjust (bool): If True, will proportionaly adjust the size of
\begin{quote}

the marker according to distance.
\end{quote}
\begin{description}
\item[{marker\_r (list or str): The color and shape of the marker for the}] \leavevmode
reference record.

\item[{marker\_c (list or str): The color and shape of the marker for the other}] \leavevmode
records. Default is to use the color palette by archiveType. If set
to None then the color of the marker will represent the distance from
the reference records.

\item[{cmap (str): The colormap to use to represent the distance from the}] \leavevmode
reference record if no marker is selected.

\end{description}

colorbar (bool): Create a colorbar. Default is True
location (str): Location of the colorbar
label (str): Label for the colorbar.
figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
ax - The figure

\end{description}

\end{fulllineitems}



\subsection{Plotting}
\label{\detokenize{Main:plotting}}\index{plotTs() (in module pyleoclim)@\spxentry{plotTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.plotTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{plotTs}}}{\emph{timeseries=None, x\_axis=None, markersize=50, marker='default', figsize={[}10, 4{]}, saveFig=False, dir=None, format='eps'}}{}
Plot a single time series.
\begin{description}
\item[{Args:}] \leavevmode
A timeseries: By default, will prompt the user for one.
x\_axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.
\end{quote}

markersize (int): default is 50.
marker (str): a string (or list) containing the color and shape of the
\begin{quote}

marker. Default is by archiveType. Type pyleo.plot\_default to see
the default palette.
\end{quote}

figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure.

\end{description}

\end{fulllineitems}

\index{histTs() (in module pyleoclim)@\spxentry{histTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.histTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{histTs}}}{\emph{timeseries=None, bins=None, hist=True, kde=True, rug=False, fit=None, hist\_kws=\{'label': 'Histogram'\}, kde\_kws=\{'label': 'KDE fit'\}, rug\_kws=\{'label': 'Rug'\}, fit\_kws=\{'label': 'Fit'\}, color='default', vertical=False, norm\_hist=True, figsize={[}5, 5{]}, saveFig=False, format='eps', dir=None}}{}
Plot a univariate distribution of the PaleoData values

This function is based on the seaborn displot function, which is
itself a combination of the matplotlib hist function with the
seaborn kdeplot() and rugplot() functions. It can also fit
scipy.stats distributions and plot the estimated PDF over the data.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: A timeseries. By default, will prompt the user for one.
bins (int): Specification of hist bins following matplotlib(hist),
\begin{quote}

or None to use Freedman-Diaconis rule
\end{quote}

hist (bool): Whether to plot a (normed) histogram
kde (bool): Whether to plot a gaussian kernel density estimate
rug (bool): Whether to draw a rugplot on the support axis
fit: Random variable object. An object with fit method, returning
\begin{quote}

a tuple that can be passed to a pdf method of positional
arguments following a grid of values to evaluate the pdf on.
\end{quote}
\begin{description}
\item[{\{hist, kde, rug, fit\}\_kws: Dictionaries. Keyword arguments for}] \leavevmode
underlying plotting functions. If modifying the dictionary, make
sure the labels “hist”, “kde”, “rug” and “fit” are still passed.

\item[{color (str): matplotlib color. Color to plot everything but the}] \leavevmode
fitted curve in. Default is to use the default paletter for each
archive type.

\end{description}

vertical (bool): if True, oberved values are on y-axis.
norm\_hist (bool): If True (default), the histrogram height shows
\begin{quote}

a density rather than a count. This is implied if a KDE or
fitted density is plotted
\end{quote}

figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns}] \leavevmode
fig - The figure

\end{description}

\end{fulllineitems}



\subsubsection{Summary Plots}
\label{\detokenize{Main:summary-plots}}
Summary plots are a special categories of plots enabled by Pyleoclim.
They allow to plot specific information about a timeseries but are not customizable.
\index{summaryTs() (in module pyleoclim)@\spxentry{summaryTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.summaryTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{summaryTs}}}{\emph{timeseries=None}, \emph{x\_axis=None}, \emph{saveFig=False}, \emph{dir=None}, \emph{format='eps'}}{}
Basic summary plot

Plots the following information: the time series, a histogram of
the PaleoData\_values, location map, spectral density using the wwz
method, and metadata about the record.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a timeseries object. By default, will prompt for one
x\_axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.
\end{quote}

saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}



\subsection{Statistics}
\label{\detokenize{Main:statistics}}\index{statsTs() (in module pyleoclim)@\spxentry{statsTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.statsTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{statsTs}}}{\emph{timeseries=None}}{}
Calculate simple statistics of a timeseries
\begin{description}
\item[{Args:}] \leavevmode
timeseries: sytem will prompt for one if not given

\item[{Returns:}] \leavevmode
the mean, median, min, max, standard deviation and the
inter-quartile range (IQR) of a timeseries.

\item[{Examples:}] \leavevmode
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{mean}\PYG{p}{,} \PYG{n}{median}\PYG{p}{,} \PYG{n}{min\PYGZus{}}\PYG{p}{,} \PYG{n}{max\PYGZus{}}\PYG{p}{,} \PYG{n}{std}\PYG{p}{,} \PYG{n}{IQR} \PYG{o}{=} \PYG{n}{pyleo}\PYG{o}{.}\PYG{n}{statsTs}\PYG{p}{(}\PYG{n}{timeseries}\PYG{p}{)}
\end{sphinxVerbatim}

\end{description}

\end{fulllineitems}

\index{corrSigTs() (in module pyleoclim)@\spxentry{corrSigTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.corrSigTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{corrSigTs}}}{\emph{timeseries1=None}, \emph{timeseries2=None}, \emph{x\_axis=None}, \emph{autocorrect=True}, \emph{autocorrect\_param=1950}, \emph{interp\_method='interpolation'}, \emph{interp\_step=None}, \emph{start=None}, \emph{end=None}, \emph{nsim=1000}, \emph{method='isospectral'}, \emph{alpha=0.05}}{}
Estimates the significance of correlations between non IID timeseries.
\begin{description}
\item[{Args:}] \leavevmode
timeseries1, timeseries2: timeseries object. Default is blank.
x-axis (str): The representation against which to express the
\begin{quote}

paleo-data. Options are “age”, “year”, and “depth”.
Default is to let the system choose if only one available
or prompt the user.
\end{quote}
\begin{description}
\item[{interp\_method (str): If the timeseries are not on the same axis, which}] \leavevmode
interpolation method to use. Valid entries are ‘interpolation’
(default) and ‘bin’.

\item[{autocorrect (bool): If applicable, convert age to year automatically.}] \leavevmode
If set to False, timeseries objects should have converted time
axis and updated units label in the dictionary

\end{description}

autocorrect\_param (float): Reference for age/year conversion.
interp\_step (float): the step size. By default, will prompt the user.
start (float): Start time/age/depth. Default is the maximum of
\begin{quote}

the minima of the two timeseries
\end{quote}
\begin{description}
\item[{end (float): End time/age/depth. Default is the minimum of the}] \leavevmode
maxima of the two timeseries

\end{description}

nsim (int): the number of simulations. Default is 1000
method (str): method use to estimate the correlation and significance.
\begin{quote}
\begin{description}
\item[{Available methods include:}] \leavevmode\begin{itemize}
\item {} 
‘ttest’: T-test where the degrees of freedom are corrected for

\end{itemize}

the effect of serial correlation
\begin{itemize}
\item {} 
‘isopersistant’: AR(1) modeling of the two timeseries

\item {} 
‘isospectral’ (default): phase randomization of original

\end{itemize}

inputs.

\end{description}

The T-test is parametric test, hence cheap but usually wrong
except in idyllic circumstances.
The others are non-parametric, but their computational
requirements scales with nsim.
\end{quote}

alpha (float): significance level for critical value estimation. Default is 0.05

\item[{Returns:}] \leavevmode
r (float) - correlation between the two timeseries

sig (bool) -  Returns True if significant, False otherwise

p (real) - the p-value

\end{description}

\end{fulllineitems}



\subsection{Timeseries}
\label{\detokenize{Main:timeseries}}
Basic manipulations of the timeseries objects.
\index{binTs() (in module pyleoclim)@\spxentry{binTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.binTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{binTs}}}{\emph{timeseries=None}, \emph{x\_axis=None}, \emph{bin\_size=None}, \emph{start=None}, \emph{end=None}}{}
Bin the paleoData values of the timeseries
\begin{description}
\item[{Args:}] \leavevmode
timeseries. By default, will prompt the user for one.
x-axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system  choose if only one available or prompt the user.
\end{quote}
\begin{description}
\item[{bin\_size (float): the size of the bins to be used. By default,}] \leavevmode
will prompt for one

\end{description}

start (float): Start time/age/depth. Default is the minimum
end (float): End time/age/depth. Default is the maximum

\item[{Returns:}] \leavevmode
binned\_values- the binned output,

bins-  the bins (centered on the median, i.e. the 100-200 bin is 150),

n-  number of data points in each bin,

error- the standard error on the mean in each bin

\end{description}

\end{fulllineitems}

\index{interpTs() (in module pyleoclim)@\spxentry{interpTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.interpTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{interpTs}}}{\emph{timeseries=None}, \emph{x\_axis=None}, \emph{interp\_step=None}, \emph{start=None}, \emph{end=None}}{}
Simple linear interpolation

Simple linear interpolation of the data using the numpy.interp method
\begin{description}
\item[{Args:}] \leavevmode
timeseries. Default is blank, will prompt for it
x-axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.
\end{quote}

interp\_step (float): the step size. By default, will prompt the user.
start (float): Start year/age/depth. Default is the minimum
end (float): End year/age/depth. Default is the maximum

\item[{Returns:}] \leavevmode
interp\_age - the interpolated age/year/depth according to the end/start
and time step,

interp\_values - the interpolated values

\end{description}

\end{fulllineitems}

\index{standardizeTs() (in module pyleoclim)@\spxentry{standardizeTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.standardizeTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{standardizeTs}}}{\emph{timeseries=None}, \emph{scale=1}, \emph{ddof=0}, \emph{eps=0.001}}{}
Centers and normalizes the paleoData values of a  given time series.

Constant or nearly constant time series not rescaled.
\begin{description}
\item[{Args:}] \leavevmode
timeseries (array): A LiPD timeseries object 
scale (real): a scale factor used to scale a record to a match a given variance
ddof (int): degress of freedom correction in the calculation of the standard deviation
eps (real): a threshold to determine if the standard deviation is too close to zero

\item[{Returns:}] \leavevmode
z (array): the standardized time series (z-score), Z = (X - E{[}X{]})/std(X)*scale, NaNs allowed

mu (real): the mean of the original time series, E{[}X{]}

sig (real): the standard deviation of the original time series, std{[}X{]}

\item[{References:}] \leavevmode\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
Tapio Schneider’s MATLAB code: \sphinxurl{http://www.clidyn.ethz.ch/imputation/standardize.m}

\item {} 
The zscore function in SciPy: \sphinxurl{https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py}

\end{enumerate}

\end{description}

@author: fzhu

\end{fulllineitems}

\index{segmentTs() (in module pyleoclim)@\spxentry{segmentTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.segmentTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{segmentTs}}}{\emph{timeseries=None}, \emph{factor=2}}{}
Divides a time series into several segments using a gap detection algorithm

Gap detection rule: If the time interval between some two data points is
larger than some factor times the mean resolution of the timeseries, then
a brak point is applied and the timseries is divided.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a LiPD timeseries object
factor (float): factor to adjust the threshold. threshold = factor*dt\_mean.
\begin{quote}

Default is 2.
\end{quote}

\item[{Returns:}] \leavevmode
seg\_y (list) - a list of several segments with potentially different length
seg\_t (list) - A list of the time values for each y segment.
n\_segs (int) - the number of segments

\end{description}

\end{fulllineitems}



\subsection{Analysis in the frequency domain}
\label{\detokenize{Main:analysis-in-the-frequency-domain}}\index{wwzTs() (in module pyleoclim)@\spxentry{wwzTs()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.wwzTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{wwzTs}}}{\emph{timeseries=None}, \emph{lim=None}, \emph{wwz=False}, \emph{psd=True}, \emph{wwz\_default=True}, \emph{psd\_default=True}, \emph{fig=True}, \emph{wwaplot\_default=True}, \emph{psdplot\_default=True}, \emph{saveFig=False}, \emph{dir=None}, \emph{format='eps'}}{}
Weigthed wavelet Z-transform analysis

Wavelet analysis for unevenly spaced data adapted from Foster et al. (1996)
\begin{description}
\item[{Args:}] \leavevmode
timeseries (dict): A LiPD timeseries object (Optional, will prompt for one.)
lim (list): Truncate the timeseries between min/max time (e.g., {[}0,10000{]})
wwz (bool): If True, will perform wavelet analysis
psd (bool): If True, will inform the power spectral density of the timeseries
wwz\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{wwz\_default = \{‘tau’:None,}] \leavevmode
‘freqs’:None,
‘c’:1/(8*np.pi**2),
‘Neff’:3,
‘Neff\_coi’:3,
‘nMC’:200,
‘nproc’:8,
‘detrend’:False,
‘params’ : {[}“default”,4,0,1{]},
‘gaussianize’: False,
‘standardize’:True,
‘method’:’Kirchner\_f2py’,
‘bc\_mode’:’reflect’,
‘reflect\_type’:’odd’,
‘len\_bd’:0\}

\end{description}

Modify the values for specific keys to change the default behavior.
See Spectral.wwz for details
\end{quote}

psd\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{psd\_default = \{‘tau’:None,}] \leavevmode
‘freqs’: None,
‘c’:1e-3,
‘nproc’:8,
‘nMC’:200,
‘detrend’:False,
‘params’ : {[}“default”,4,0,1{]},
‘gaussianize’: False,
‘standardize’:True,
‘Neff’:3,
‘anti\_alias’:False,
‘avgs’:2,
‘method’:’Kirchner\_f2py’,
\}

\end{description}

Modify the values for specific keys to change the default behavior.
See Spectral.wwz\_psd for detail.s
\end{quote}

fig (bool): If True, plots the figure    
wwaplot\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{wwaplot\_default=\{‘AR1\_q’:AR1\_q,}] \leavevmode
‘coi’:coi,
‘levels’:None,
‘tick\_range’:None,
‘yticks’:None,
‘yticks\_label’: None,
‘ylim’:None,
‘xticks’:None,
‘xlabels’:None,
‘figsize’:{[}20,8{]},
‘clr\_map’:’OrRd’,
‘cbar\_drawedges’:False,
‘cone\_alpha’:0.5,
‘plot\_signif’:True,
‘signif\_style’:’contour’,
‘plot\_cone’:True,
‘title’:None,
‘ax’:None,
‘xlabel’: the chondata label,
‘ylabel’: ‘Period (units from ChronData)’,
‘plot\_cbar’:’True’,
‘cbar\_orientation’:’vertical’,
‘cbar\_pad’:0.05,
‘cbar\_frac’:0.15,
‘cbar\_labelsize’:None\}

\end{description}

Modify the values for specific keys to change the default behavior.
\end{quote}

psdplot\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{psdplot\_default=\{‘lmstyle’:’-‘,}] \leavevmode
‘linewidth’:None,
‘color’: sns.xkcd\_rgb{[}“denim blue”{]},
‘ar1\_lmstyle’:’-‘,
‘ar1\_linewidth’:1,
‘period\_ticks’:None,
‘period\_tickslabel’:None,
‘psd\_lim’:None,
‘period\_lim’:None,
‘alpha’:1,
‘figsize’:{[}20,8{]},
‘label’:’PSD’,
‘plot\_ar1’:True,
‘psd\_ar1\_q95’:95\% quantile from psd,
‘title’: None,
‘legend’: ‘True’
‘psd\_ar1\_color’:sns.xkcd\_rgb{[}“pale red”{]},
‘ax’:None,
‘vertical’:False,
‘plot\_gridlines’:True,
‘period\_label’:’Period (units of age)’,
‘psd\_label’:’Spectral Density’,
‘zorder’ : None\}

\end{description}

Modify the values for specific keys to change the default behavior.
\end{quote}

saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
dict\_out (dict): A dictionary of outputs.
\begin{quote}

For wwz:
\begin{itemize}
\item {} 
wwa (array): The weights wavelet amplitude

\item {} 
AR1\_q (array): AR1 simulations

\item {} 
coi (array): cone of influence

\item {} 
freqs (array): vector for frequencies

\item {} 
tau (array): the evenly-spaced time points, namely the time

\end{itemize}

shift for wavelet analysis.
\begin{itemize}
\item {} 
Neffs (array): The matrix of effective number of points in the

\end{itemize}

time-scale coordinates.
\begin{itemize}
\item {} 
coeff (array): The wavelet transform coefficients

\end{itemize}

For psd:
\begin{itemize}
\item {} 
psd (array): power spectral density

\item {} 
freqs (array): vector of frequency

\item {} 
psd\_ar1\_q95 (array): the 95\% quantile of the psds of AR1 processes

\end{itemize}
\end{quote}

fig: The figure
\begin{description}
\item[{References:}] \leavevmode
Foster, G. (1996). Wavelets for period analysis of unevenly
sampled time series. The Astronomical Journal, 112(4), 1709-1729.

\item[{Examples:}] \leavevmode
To run both wwz and psd:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dict\PYGZus{}out}\PYG{p}{,} \PYG{n}{fig} \PYG{o}{=} \PYG{n}{pyleoclim}\PYG{o}{.}\PYG{n}{wwzTs}\PYG{p}{(}\PYG{n}{wwz}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

Note: This will return a single figure with wwa and psd

To change a default behavior:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dict\PYGZus{}out}\PYG{p}{,} \PYG{n}{fig} \PYG{o}{=} \PYG{n}{pyleoclim}\PYG{o}{.}\PYG{n}{wwzTs}\PYG{p}{(}\PYG{n}{psd\PYGZus{}default} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nMC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+m+mi}{1000}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{description}

\end{description}

\end{fulllineitems}



\subsection{Age modelling}
\label{\detokenize{Main:age-modelling}}\index{Bchron() (in module pyleoclim)@\spxentry{Bchron()}\spxextra{in module pyleoclim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.Bchron}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{Bchron}}}{\emph{lipd, modelNum=None, objectName=None, rejectAges=None, calCurves=None, reservoirAgeCorr=None, predictPositions='paleo', positionsThickness=None, outlierProbs=None, iterations=1000, burn=2000, thin=8, extractDate=-69, maxExtrap=500, thetaMhSd=0.5, muMhSd=0.1, psiMhSd=0.1, ageScaleVal=1000, positionScaleVal=100, saveLipd=True, plot=True, figsize={[}4, 8{]}, flipCoor=False, xlabel=None, ylabel=None, xlim=None, ylim=None, violinColor='\#8B008B', medianLineColor='black', medianLineWidth=2.0, CIFillColor='Silver', samplePaths=True, samplePathNumber=10, alpha=0.5, saveFig=False, dir=None, format='eps'}}{}
Runs Bchron and plot if asked

Fits a non-parametric chronology model to age/position data according to
the Compound Poisson-Gamma model defined by Haslett and Parnell (2008).
This version used a slightly modified Markov chain Monte-Carlo fitting
algorithm which aims to converge quicker and requires fewer iterations.
It also a slightly modified procedure for identifying outliers.

The Bchronology functions fits a compounf Poisson-Gamma distribution to the
incrememnts between the dated levels. This involves a stochastic linear
interpolation step where the age gaps are Gamma distributed, and the position
gaps are Exponential. Radiocarbon and non-radiocarbon dates (including outliers)
are updated within the fucntion also by MCMC.

This function also allows to save the ensemble, distributions, and probability
tables as well as the parameters with which the model was run into the LiPD file.

Finally allows to make a plot.
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{lipd (dict): A dictionary containing the entry of a LiPD file. Can be}] \leavevmode
obtained from lipd.readLipd() or pyleoclim.openLipd(). Please note
that the Bchron function currently only allows for a single LiPD file
(i.e., not the entire directory).

\item[{modelNum (int): The model number in which to place the Bchron output.}] \leavevmode
If unknown, the function will try to make a guess and/or prompt
based on the number of already available models.

\item[{objectName (str): The name of the chron object in which to store the new}] \leavevmode
model (e.g. “chron0”)

\item[{rejectAges (vector): A vector of 1/0 where 1 include the dates to be rejected.}] \leavevmode
Default it None.

\item[{calCurves (list): (Optional) A vector of values containing either ‘intcal13’,}] \leavevmode
‘marine13’, ‘shcal13’, or ‘normal’. If none is provided, will
prompt the user. Should be either of length =1 if using the same
calibration for each age or the same length as the vector of ages.

\item[{reservoirAgeCorr (array): (Optional) A list (matrix) of two floats that correspond to the}] \leavevmode
DeltaR and DeltaR uncertainty. If already added to the ages and
ages standard deviation, then enter {[}0,0{]} to bypass the prompt.
Will only be applied if CalCurves is set to ‘marine13’. Otherwise,
leave to none.

\item[{predictPositions (array): (Optional) a vector of positions}] \leavevmode
(e.g. depths) at which predicted age values are required.
Defaults to a sequence of length 100 from the top position to the
bottom position.

\item[{positionsThickness (array): (Optional) Thickness values for each of the positions.}] \leavevmode
The thickness values should be the full thickness value of the
slice. By default set to zero.

\item[{outlierProbs (array): (Optional) A vector of prior outlier probabilities,}] \leavevmode
one for each age. Defaults to 0.01

\item[{iterations (int): (Optional) The number of iterations to start the procedure.}] \leavevmode
Default and minimum should be 10000.

\item[{burn (int): (Optional) The number of starting iterations to discard.}] \leavevmode
Default is 200

\item[{thin (int): (Optional) The step size for every iteration to keep beyond}] \leavevmode
the burnin. Default is 8.

\item[{extractDate (float): (Optional) The top age of the core. Used for}] \leavevmode
extrapolation purposes so that no extrapolated ages go beyond the
top age of the core. Defaults to the current year.

\item[{maxExtrap (int): (Optional) The maximum number of extrapolations to}] \leavevmode
perform before giving up and setting the predicted ages to NA.
Useful for when large amounts of extrapolation are required, i.e.
some of the predictPositions are a long way from the dated
positions. Defaults to 500.

\item[{thetaMhSd (float):  (Optional)  The Metropolis-Hastings standard}] \leavevmode
deviation for the age parameters. Defaults to 0.5.

\item[{muMhSd (float): (Optional)  The Metropolis-Hastings standard deviation}] \leavevmode
for the compound Poisson-Gamma Scale. Defaults to 0.1

\item[{psiMhSd (float): (Optional) The Metropolis-Hastings standard deviation}] \leavevmode
for the Compound Poisson-Gamma Scale.

\item[{ageScaleVal (int): (Optional) A scale value for the ages.}] \leavevmode
Bchronology works best when the ages are scaled to be
approximately between 0 and 100.
The default value is thus 1000 for ages given in years.

\item[{positionScaleVal (int):  (Optional) A scale value for the positions.}] \leavevmode
Bchronology works best when the positions are scaled to be
approximately between 0 and 100. The default value is thus
100 for positions given in cm.

\item[{saveLipd (bool): If True, saves the ensemble, distribution, and probability}] \leavevmode
tables along with the parameters used to run the model in the LiPD
file.

\end{description}

plot (bool): If True, makes a plot for the chronology
figsize (list): The figure size. Default is {[}4,8{]}
flipCoor (bool): If True, plots depth on the y-axis.
xlabel (str): The label for the x-axis
ylabel (str): The label for the y-axis
xlim (list): Limits for the x-axis. Default corresponds to the min/max
\begin{quote}

of the depth vector.
\end{quote}

ylim (list): Limits for the y-axis. Default set by matplotlib
violinColor (str): The color for the violins. Default is purple
medianLineColor (str): The color for the median line. Default is black.
medianLineWidth (float): The width for the median line
CIFillColor (str): Fill color in between the 95\% confidence interval.
\begin{quote}

Default is silver.
\end{quote}
\begin{description}
\item[{samplePaths (bool): If True, draws sample paths from the distribution.}] \leavevmode
Use the same color as the violins.

\item[{samplePathNumber (int): The number of sample paths to draw. Default is 10.}] \leavevmode
Note: samplePaths need to be set to True.

\end{description}

alpha (float): The violins’ transparency. Number between 0 and 1
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
depth - the predicted positions (either same as the user or the default)
\begin{description}
\item[{chron -  a numpy array of possible chronologies in each column.}] \leavevmode
The number of rows is the same as the length of depth

\end{description}

ageDist - the distribution of ages around each dates.
fig - the figure
run - the full R object containing the outputs of the Bchron run

\item[{Warnings:}] \leavevmode\begin{description}
\item[{This function requires R and the Bchron package and all its}] \leavevmode
dependencies to be installed on the same machine.

\end{description}

\item[{Reference:}] \leavevmode\begin{itemize}
\item {} \begin{description}
\item[{Haslett, J., and Parnell, A. C. (2008). A simple monotone}] \leavevmode
process with application to radiocarbon-dated depth
chronologies. Journal of the Royal Statistical Society,
Series C, 57, 399-418. DOI:10.1111/j.1467-9876.2008.00623.x

\end{description}

\item {} \begin{description}
\item[{Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E.,}] \leavevmode
and Huntley, B. (2008). A flexible approach to assessing
synchroneity of past events using Bayesian reconstructions
of sedimentation history. Quaternary Science Reviews,
27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009

\end{description}

\end{itemize}

\end{description}

\end{fulllineitems}



\section{Using Pyleoclim without a LiPD file}
\label{\detokenize{Main:using-pyleoclim-without-a-lipd-file}}
The Pyleoclim modules can be called separately so the main functions can be used without a timeseries objects.
The following modules are available:
\begin{itemize}
\item {} 
pyleoclim.Map: mapping functions

\item {} 
pyleoclim.Plot: plotting functions

\item {} 
pyleoclim.Stats: statistics (including correlation)

\item {} 
pyleoclim.Timeseries: binning, interpolating

\item {} 
pyleoclim.Spectral: analysis in the frequency domain

\item {} 
pyleoclim.RBchron: Bchron age model analysis

\end{itemize}

In addition, the pyleoclim.LipdUtils module allows the basic manipulation of LiPD files and the pyleoclim.SummaryPlots module
contains some functions to extract information about a timeseries object.


\chapter{Mapping Functions}
\label{\detokenize{Map:mapping-functions}}\label{\detokenize{Map::doc}}
This module uses the Cartopy package for mapping.
\index{setProj() (in module pyleoclim.Map)@\spxentry{setProj()}\spxextra{in module pyleoclim.Map}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Map:pyleoclim.Map.setProj}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Map.}}\sphinxbfcode{\sphinxupquote{setProj}}}{\emph{projection='Robinson'}, \emph{proj\_default=True}}{}
Set the projection for Cartopy.
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{projection (string): the map projection. Available projections:}] \leavevmode
‘Robinson’ (default), ‘PlateCarree’, ‘AlbertsEqualArea’,
‘AzimuthalEquidistant’,’EquidistantConic’,’LambertConformal’,
‘LambertCylindrical’,’Mercator’,’Miller’,’Mollweide’,’Orthographic’,
‘Sinusoidal’,’Stereographic’,’TransverseMercator’,’UTM’,
‘InterruptedGoodeHomolosine’,’RotatedPole’,’OSGB’,’EuroPP’,
‘Geostationary’,’NearsidePerspective’,’EckertI’,’EckertII’,
‘EckertIII’,’EckertIV’,’EckertV’,’EckertVI’,’EqualEarth’,’Gnomonic’,
‘LambertAzimuthalEqualArea’,’NorthPolarStereo’,’OSNI’,’SouthPolarStereo’

\item[{proj\_default (bool): If True, uses the standard projection attributes.}] \leavevmode
Enter new attributes in a dictionary to change them. Lists of attributes
can be found in the Cartopy documentation:
\begin{quote}

\sphinxurl{https://scitools.org.uk/cartopy/docs/latest/crs/projections.html\#eckertiv}
\end{quote}

\end{description}

\item[{Returns:}] \leavevmode
proj - the Cartopy projection object

\end{description}

\end{fulllineitems}

\index{mapAll() (in module pyleoclim.Map)@\spxentry{mapAll()}\spxextra{in module pyleoclim.Map}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Map:pyleoclim.Map.mapAll}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Map.}}\sphinxbfcode{\sphinxupquote{mapAll}}}{\emph{lat, lon, criteria, projection='Robinson', proj\_default=True, background=True, borders=False, rivers=False, lakes=False, figsize={[}10, 4{]}, ax=None, palette=None, markersize=50}}{}
Map the location of all lat/lon according to some criteria

Map the location of all lat/lon according to some criteria. The choice of 
plotting color/marker is passed through palette according to unique 
criteria (e.g., record name, archive type, proxy observation type).
\begin{description}
\item[{Args:}] \leavevmode
lat (list): a list of latitude.
lon (list): a list of longitude.
criteria (list): a list of criteria for plotting purposes. For instance,
\begin{quote}

a map by the types of archive present in the dataset or proxy
observations.
\end{quote}
\begin{description}
\item[{projection (string): the map projection. Available projections:}] \leavevmode
‘Robinson’ (default), ‘PlateCarree’, ‘AlbertsEqualArea’,
‘AzimuthalEquidistant’,’EquidistantConic’,’LambertConformal’,
‘LambertCylindrical’,’Mercator’,’Miller’,’Mollweide’,’Orthographic’,
‘Sinusoidal’,’Stereographic’,’TransverseMercator’,’UTM’,
‘InterruptedGoodeHomolosine’,’RotatedPole’,’OSGB’,’EuroPP’,
‘Geostationary’,’NearsidePerspective’,’EckertI’,’EckertII’,
‘EckertIII’,’EckertIV’,’EckertV’,’EckertVI’,’EqualEarth’,’Gnomonic’,
‘LambertAzimuthalEqualArea’,’NorthPolarStereo’,’OSNI’,’SouthPolarStereo’

\item[{proj\_default (bool): If True, uses the standard projection attributes.}] \leavevmode
Enter new attributes in a dictionary to change them. Lists of attributes
can be found in the Cartopy documentation:
\begin{quote}

\sphinxurl{https://scitools.org.uk/cartopy/docs/latest/crs/projections.html\#eckertiv}
\end{quote}

\item[{background (bool): If True, uses a shaded relief background (only one }] \leavevmode
available in Cartopy)

\end{description}

borders (bool): Draws the countries border. Defaults is off (False). 
rivers (bool): Draws major rivers. Default is off (False).
lakes (bool): Draws major lakes.
\begin{quote}

Default is off (False).
\end{quote}
\begin{description}
\item[{palette (dict): A dictionary of plotting color/marker by criteria. The}] \leavevmode
keys should correspond to \sphinxstylestrong{*unique*} criteria with a list of 
associated values. The list should be in the format 
{[}‘color’, ‘marker’{]}.

\end{description}

markersize (int): The size of the marker.
figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{mapOne() (in module pyleoclim.Map)@\spxentry{mapOne()}\spxextra{in module pyleoclim.Map}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Map:pyleoclim.Map.mapOne}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Map.}}\sphinxbfcode{\sphinxupquote{mapOne}}}{\emph{lat, lon, projection='Orthographic', proj\_default=True, label=None, background=True, borders=False, rivers=False, lakes=False, markersize=50, marker='ro', figsize={[}4, 4{]}, ax=None}}{}
Map one location on the globe
\begin{description}
\item[{Args:}] \leavevmode
lat (float): a float number representing latitude
lon (float): a float number representing longitude
projection (string): the map projection. Available projections:
\begin{quote}

‘Robinson’, ‘PlateCarree’, ‘AlbertsEqualArea’,
‘AzimuthalEquidistant’,’EquidistantConic’,’LambertConformal’,
‘LambertCylindrical’,’Mercator’,’Miller’,’Mollweide’,’Orthographic’ (Default),
‘Sinusoidal’,’Stereographic’,’TransverseMercator’,’UTM’,
‘InterruptedGoodeHomolosine’,’RotatedPole’,’OSGB’,’EuroPP’,
‘Geostationary’,’NearsidePerspective’,’EckertI’,’EckertII’,
‘EckertIII’,’EckertIV’,’EckertV’,’EckertVI’,’EqualEarth’,’Gnomonic’,
‘LambertAzimuthalEqualArea’,’NorthPolarStereo’,’OSNI’,’SouthPolarStereo’
\end{quote}
\begin{description}
\item[{proj\_default (bool): If True, uses the standard projection attributes, including centering.}] \leavevmode
Enter new attributes in a dictionary to change them. Lists of attributes
can be found in the Cartopy documentation:
\begin{quote}

\sphinxurl{https://scitools.org.uk/cartopy/docs/latest/crs/projections.html\#eckertiv}
\end{quote}

\item[{background (bool): If True, uses a shaded relief background (only one }] \leavevmode
available in Cartopy)

\end{description}

label (str): label for the point. Default is None. 
borders (bool): Draws the countries border. Defaults is off (False). 
rivers (bool): Draws major rivers. Default is off (False).
lakes (bool): Draws major lakes.
\begin{quote}

Default is off (False).
\end{quote}

markersize (int): The size of the marker.
marker (str or list): color and type of marker. 
figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\end{description}

\end{fulllineitems}



\chapter{Plotting Functions}
\label{\detokenize{Plot:plotting-functions}}\label{\detokenize{Plot::doc}}\index{plot() (in module pyleoclim.Plot)@\spxentry{plot()}\spxextra{in module pyleoclim.Plot}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Plot:pyleoclim.Plot.plot}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Plot.}}\sphinxbfcode{\sphinxupquote{plot}}}{\emph{x, y, markersize=50, marker='ro', x\_label='', y\_label='', title='', figsize={[}10, 4{]}, ax=None}}{}
Make a 2-D plot
\begin{description}
\item[{Args:}] \leavevmode
x (numpy array): a 1xn numpy array of values for the x-axis
y (numpy array): a 1xn numpy array for the y-axis
markersize (int): the size of the marker
marker (string or list): color and shape of the marker
x\_axis\_label (str): the label for the x-axis
y\_axis\_label (str): the label for the y-axis
title (str): the title for the plot
figsize (list): the size of the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\item[{Return:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{plot\_hist() (in module pyleoclim.Plot)@\spxentry{plot\_hist()}\spxextra{in module pyleoclim.Plot}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Plot:pyleoclim.Plot.plot_hist}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Plot.}}\sphinxbfcode{\sphinxupquote{plot\_hist}}}{\emph{y, bins=None, hist=True, label='', kde=True, rug=False, fit=None, hist\_kws=\{'label': 'Histogram'\}, kde\_kws=\{'label': 'KDE fit'\}, rug\_kws=\{'label': 'rug'\}, fit\_kws=\{'label': 'fit'\}, color='0.7', vertical=False, norm\_hist=True, figsize={[}5, 5{]}, ax=None}}{}
Plot a univariate distribution of the PaleoData values

This function is based on the seaborn displot function, which is
itself a combination of the matplotlib hist function with the 
seaborn kdeplot() and rugplot() functions. It can also fit 
scipy.stats distributions and plot the estimated PDF over the data.
\begin{description}
\item[{Args:}] \leavevmode
y (array): nx1 numpy array. No missing values allowed 
bins (int): Specification of hist bins following matplotlib(hist),
\begin{quote}

or None to use Freedman-Diaconis rule
\end{quote}

hist (bool): Whether to plot a (normed) histogram 
label (str): The label for the axis
kde (bool): Whether to plot a gaussian kernel density estimate
rug (bool): Whether to draw a rugplot on the support axis
fit: Random variable object. An object with fit method, returning
\begin{quote}

a tuple that can be passed to a pdf method of positional 
arguments following a grid of values to evaluate the pdf on.
\end{quote}
\begin{description}
\item[{\{hist, kde, rug, fit\}\_kws: Dictionaries. Keyword arguments for }] \leavevmode
underlying plotting functions. If modifying the dictionary, make
sure the labels “hist”, “kde”, “rug” and “fit” are still passed.

\item[{color (str): matplotlib color. Color to plot everything but the}] \leavevmode
fitted curve in.

\end{description}

vertical (bool): if True, oberved values are on y-axis.
norm\_hist (bool): If True (default), the histrogram height shows
\begin{quote}

a density rather than a count. This is implied if a KDE or 
fitted density is plotted
\end{quote}

figsize (list): the size of the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\item[{Returns}] \leavevmode
fig - The figure

\end{description}

\end{fulllineitems}



\chapter{Statistics Functions}
\label{\detokenize{Stats:statistics-functions}}\label{\detokenize{Stats::doc}}\index{simpleStats() (in module pyleoclim.Stats)@\spxentry{simpleStats()}\spxextra{in module pyleoclim.Stats}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Stats:pyleoclim.Stats.simpleStats}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Stats.}}\sphinxbfcode{\sphinxupquote{simpleStats}}}{\emph{y}, \emph{axis=None}}{}
Computes simple statistics

Computes the mean, median, min, max, standard deviation, and interquartile
range of a numpy array y.
\begin{description}
\item[{Args:}] \leavevmode
y (array): A Numpy array
axis (int, typle of ints): Optional. Axis or Axes along which the means
\begin{quote}

are computed, the default is to compute the mean of the flattened
array. If a tuple of ints, performed over multiple axes
\end{quote}

\item[{Returns:}] \leavevmode
The mean, median, min, max, standard deviation and IQR by columns

\end{description}

\end{fulllineitems}

\index{corrsig() (in module pyleoclim.Stats)@\spxentry{corrsig()}\spxextra{in module pyleoclim.Stats}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Stats:pyleoclim.Stats.corrsig}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Stats.}}\sphinxbfcode{\sphinxupquote{corrsig}}}{\emph{y1}, \emph{y2}, \emph{nsim=1000}, \emph{method='isospectral'}, \emph{alpha=0.05}}{}~\begin{description}
\item[{Estimates the significance of correlations between non IID time series by 3 independent methods:}] \leavevmode\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi )}
\makeatletter\def\p@enumii{\p@enumi \theenumi )}\makeatother
\item {} 
‘ttest’: T-test where d.o.f are corrected for the effect of serial correlation

\item {} 
‘isopersistent’: AR(1) modeling of x and y.

\end{enumerate}

3) ‘isospectral’: phase randomization of original inputs. (default)
The T-test is parametric test, hence cheap but usually wrong except in idyllic circumstances.
The others are non-parametric, but their computational requirements scales with nsim.

\item[{Args:}] \leavevmode
y1, y2 (array)- vector of (real) numbers of identical length, no NaNs allowed
nsim (int)- the number of simulations {[}1000{]}
method (str)- methods 1-3 above {[}‘isospectral’{]}
alpha (float)- significance level for critical value estimation {[}0.05{]}

\item[{Returns:}] \leavevmode
r (real): correlation between x and y

signif (int): true  if significant; false otherwise

p (real): Fraction of time series with higher correlation coefficents than observed (approximates the p-value).
\begin{quote}

Note that signif = True if and only if p \textless{}= alpha.
\end{quote}

\end{description}

\end{fulllineitems}



\chapter{Timeseries Functions}
\label{\detokenize{Timeseries:timeseries-functions}}\label{\detokenize{Timeseries::doc}}
This module allows the manipulation of timeseries.
\index{binvalues() (in module pyleoclim.Timeseries)@\spxentry{binvalues()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.binvalues}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{binvalues}}}{\emph{x}, \emph{y}, \emph{bin\_size=None}, \emph{start=None}, \emph{end=None}}{}
Bin the values
\begin{description}
\item[{Args:}] \leavevmode
x (array): the x-axis series.
y (array): the y-axis series.
bin\_size (float): The size of the bins. Default is the average resolution
start (float): Where/when to start binning. Default is the minimum
end (float): When/where to stop binning. Defulat is the maximum

\item[{Returns:}] \leavevmode
binned\_values - the binned output

bins - the bins (centered on the median, i.e., the 100-200 bin is 150)

n - number of data points in each bin

error -  the standard error on the mean in each bin

\end{description}

\end{fulllineitems}

\index{interp() (in module pyleoclim.Timeseries)@\spxentry{interp()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.interp}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{interp}}}{\emph{x}, \emph{y}, \emph{interp\_step=None}, \emph{start=None}, \emph{end=None}}{}
Linear interpolation onto a new x-axis
\begin{description}
\item[{Args:}] \leavevmode
x (array): the x-axis
y (array): the y-axis
interp\_step (float): the interpolation step. Default is mean resolution.
start (float): where/when to start the interpolation. Default is min..
end (float): where/when to stop the interpolation. Default is max.

\item[{Returns:}] \leavevmode
xi - the interpolated x-axis

interp\_values - the interpolated values

\end{description}

\end{fulllineitems}

\index{onCommonAxis() (in module pyleoclim.Timeseries)@\spxentry{onCommonAxis()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.onCommonAxis}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{onCommonAxis}}}{\emph{x1}, \emph{y1}, \emph{x2}, \emph{y2}, \emph{method='interpolation'}, \emph{step=None}, \emph{start=None}, \emph{end=None}}{}
Places two timeseries on a common axis
\begin{description}
\item[{Args:}] \leavevmode
x1 (array): x-axis values of the first timeseries
y1 (array): y-axis values of the first timeseries
x2 (array): x-axis values of the second timeseries
y2 (array): y-axis values of the second timeseries
method (str): Which method to use to get the timeseries on the same x axis.
\begin{quote}

Valid entries: ‘interpolation’ (default), ‘bin’
\end{quote}

step (float): The interpolation step. Default is mean resolution
of lowest resolution series
start (float): where/when to start. Default is the maximum of the minima of
the two timeseries
end (float): Where/when to end. Default is the minimum of the maxima of
the two timeseries

\item[{Returns:}] \leavevmode
xi -  the interpolated x-axis

interp\_values1 -  the interpolated y-values for the first timeseries
interp\_values2 - the intespolated y-values for the second timeseries

\end{description}

\end{fulllineitems}

\index{standardize() (in module pyleoclim.Timeseries)@\spxentry{standardize()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.standardize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{standardize}}}{\emph{x}, \emph{scale=1}, \emph{axis=0}, \emph{ddof=0}, \emph{eps=0.001}}{}
Centers and normalizes a given time series. Constant or nearly constant time series not rescaled.
\begin{description}
\item[{Args:}] \leavevmode
x (array): vector of (real) numbers as a time series, NaNs allowed
scale (real): a scale factor used to scale a record to a match a given variance
axis (int or None): axis along which to operate, if None, compute over the whole array
ddof (int): degress of freedom correction in the calculation of the standard deviation
eps (real): a threshold to determine if the standard deviation is too close to zero

\item[{Returns:}] \leavevmode
z (array): the standardized time series (z-score), Z = (X - E{[}X{]})/std(X)*scale, NaNs allowed
mu (real): the mean of the original time series, E{[}X{]}
sig (real): the standard deviation of the original time series, std{[}X{]}

\item[{References:}] \leavevmode\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
Tapio Schneider’s MATLAB code: \sphinxurl{http://www.clidyn.ethz.ch/imputation/standardize.m}

\item {} 
The zscore function in SciPy: \sphinxurl{https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py}

\end{enumerate}

\end{description}

@author: fzhu

\end{fulllineitems}

\index{ts2segments() (in module pyleoclim.Timeseries)@\spxentry{ts2segments()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.ts2segments}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{ts2segments}}}{\emph{ys}, \emph{ts}, \emph{factor=10}}{}
Chop a time series into several segments based on gap detection.
\begin{description}
\item[{The rule of gap detection is very simple:}] \leavevmode
we define the intervals between time points as dts, then if dts{[}i{]} is larger than factor * dts{[}i-1{]},
we think that the change of dts (or the gradient) is too large, and we regard it as a breaking point
and chop the time series into two segments here

\item[{Args:}] \leavevmode
ys (array): a time series, NaNs allowed
ts (array): the time points
factor (float): the factor that adjusts the threshold for gap detection

\item[{Returns:}] \leavevmode
seg\_ys (list): a list of several segments with potentially different lengths
seg\_ts (list): a list of the time axis of the several segments
n\_segs (int): the number of segments

\end{description}

@author: fzhu

\end{fulllineitems}

\index{clean\_ts() (in module pyleoclim.Timeseries)@\spxentry{clean\_ts()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.clean_ts}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{clean\_ts}}}{\emph{ys}, \emph{ts}}{}
Delete the NaNs in the time series and sort it with time axis ascending
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs allowed
ts (array): the time axis of the time series, NaNs allowed

\item[{Returns:}] \leavevmode
ys (array): the time series without nans
ts (array): the time axis of the time series without nans

\end{description}

\end{fulllineitems}

\index{annualize() (in module pyleoclim.Timeseries)@\spxentry{annualize()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.annualize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{annualize}}}{\emph{ys}, \emph{ts}}{}
Annualize a time series whose time resolution is finer than 1 year
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs allowed
ts (array): the time axis of the time series, NaNs allowed

\item[{Returns:}] \leavevmode
ys\_ann (array): the annualized time series
year\_int (array): the time axis of the annualized time series

\end{description}

\end{fulllineitems}

\index{gaussianize() (in module pyleoclim.Timeseries)@\spxentry{gaussianize()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.gaussianize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{gaussianize}}}{\emph{X}}{}
Transforms a (proxy) timeseries to Gaussian distribution.

Originator: Michael Erb, Univ. of Southern California - April 2017

\end{fulllineitems}

\index{gaussianize\_single() (in module pyleoclim.Timeseries)@\spxentry{gaussianize\_single()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.gaussianize_single}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{gaussianize\_single}}}{\emph{X\_single}}{}
Transforms a single (proxy) timeseries to Gaussian distribution.

Originator: Michael Erb, Univ. of Southern California - April 2017

\end{fulllineitems}

\index{detrend() (in module pyleoclim.Timeseries)@\spxentry{detrend()}\spxextra{in module pyleoclim.Timeseries}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.detrend}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{detrend}}}{\emph{y, x=None, method='linear', params={[}'default', 4, 0, 1{]}}}{}
Detrend a timeseries according to three methods
\begin{description}
\item[{Detrending methods include, “linear” (default), “constant”, and using a low-pass}] \leavevmode
Savitzky-Golay filters.

\item[{Args:}] \leavevmode
y (array): The series to be detrended.
x (array): The time axis for the timeseries. Necessary for use with
\begin{quote}

the Savitzky-Golay filters method since the series should be evenly spaced.
\end{quote}
\begin{description}
\item[{method (str): The type of detrending. If linear (default), the result of}] \leavevmode
a linear least-squares fit to y is subtracted from y. If constant,
only the mean of data is subtrated. If “savitzy-golay”, y is filtered
using the Savitzky-Golay filters and the resulting filtered series
is subtracted from y.

\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

\item[{Returns:}] \leavevmode
ys (array) - the detrended timeseries.

\end{description}

\end{fulllineitems}



\chapter{LiPD Utilities}
\label{\detokenize{LIPDutils:lipd-utilities}}\label{\detokenize{LIPDutils::doc}}
This modules allow basic manipulation of LiPD files


\section{Creating Directories and saving}
\label{\detokenize{LIPDutils:creating-directories-and-saving}}\index{createDir() (in module pyleoclim.LipdUtils)@\spxentry{createDir()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.createDir}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{createDir}}}{\emph{path}, \emph{foldername}}{}
Create a new folder in a working directory

Create a new folder in a working directory to save outputs from Pyleoclim.
\begin{description}
\item[{Args:}] \leavevmode
path(str): the path to the new folder.
foldername(str): the name of the folder to be created

\item[{Returns:}] \leavevmode
newdir - the full path to the new directory

\end{description}

\end{fulllineitems}

\index{saveFigure() (in module pyleoclim.LipdUtils)@\spxentry{saveFigure()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.saveFigure}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{saveFigure}}}{\emph{name}, \emph{format='eps'}, \emph{dir=None}}{}
Save a figure

Save the figure in the directory. If not given, creates a folder in the 
current working directory.
\begin{description}
\item[{Args:}] \leavevmode
name (str): name of the file
format (str): One of the file extensions supported by the active
\begin{quote}

backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.
\end{quote}
\begin{description}
\item[{dir (str): the name of the folder in the LiPD working directory.}] \leavevmode
If not provided, creates a default folder called ‘figures’.

\end{description}

\end{description}

\end{fulllineitems}



\section{LiPD files}
\label{\detokenize{LIPDutils:lipd-files}}\index{enumerateLipds() (in module pyleoclim.LipdUtils)@\spxentry{enumerateLipds()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.enumerateLipds}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{enumerateLipds}}}{\emph{lipds}}{}
Enumerate the LiPD files loaded in the workspace
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{lipds (dict): A dictionary of LiPD files. Can be obtained from}] \leavevmode
pyleoclim.readLipd()

\end{description}

\end{description}

\end{fulllineitems}

\index{getLipd() (in module pyleoclim.LipdUtils)@\spxentry{getLipd()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.getLipd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{getLipd}}}{\emph{lipds}}{}
Prompt for a LiPD file

Ask the user to select a LiPD file from a list
Use this function in conjunction with enumerateLipds()
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{lipds (dict): A dictionary of LiPD files. Can be obtained from}] \leavevmode
pyleoclim.readLipd()

\end{description}

\item[{Returns:}] \leavevmode
The index of the LiPD file

\end{description}

\end{fulllineitems}



\section{Handling Variables}
\label{\detokenize{LIPDutils:handling-variables}}\index{promptForVariable() (in module pyleoclim.LipdUtils)@\spxentry{promptForVariable()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.promptForVariable}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{promptForVariable}}}{}{}
Prompt for a specific variable

Ask the user to select the variable they are interested in.
Use this function in conjunction with readHeaders() or getTSO()
\begin{description}
\item[{Returns:}] \leavevmode
The index of the variable

\end{description}

\end{fulllineitems}

\index{xAxisTs() (in module pyleoclim.LipdUtils)@\spxentry{xAxisTs()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.xAxisTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{xAxisTs}}}{\emph{timeseries}}{}
Prompt the user to choose a x-axis representation for the timeseries.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a timeseries object

\item[{Returns:}] \leavevmode
x\_axis - the values for the x-axis representation,

label - returns either “age”, “year”, or “depth”

\end{description}

\end{fulllineitems}

\index{checkXaxis() (in module pyleoclim.LipdUtils)@\spxentry{checkXaxis()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.checkXaxis}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{checkXaxis}}}{\emph{timeseries}, \emph{x\_axis=None}}{}
Check that a x-axis is present for the timeseries
\begin{description}
\item[{Args:}] \leavevmode
timeseries : a timeseries
x\_axis (str) : the x-axis representation, either depth, age or year

\item[{Returns:}] \leavevmode
x - the values for the x-axis representation,

label - returns either “age”, “year”, or “depth”

\end{description}

\end{fulllineitems}

\index{checkTimeAxis() (in module pyleoclim.LipdUtils)@\spxentry{checkTimeAxis()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.checkTimeAxis}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{checkTimeAxis}}}{\emph{timeseries}, \emph{x\_axis=None}}{}
This function makes sure that time is available for the timeseries
\begin{description}
\item[{Args:}] \leavevmode
timeseries (dict): A LiPD timeseries object

\item[{Returns:}] \leavevmode
x: the time values for the timeseries
label: the time representation for the timeseries

\end{description}

\end{fulllineitems}

\index{searchVar() (in module pyleoclim.LipdUtils)@\spxentry{searchVar()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.searchVar}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{searchVar}}}{\emph{timeseries\_list}, \emph{key}, \emph{exact=True}, \emph{override=True}}{}
This function search for key words (exact match) for a variable
\begin{description}
\item[{Args:}] \leavevmode
timeseries\_list (list): A list of available series
key (list): A list of keys to search
exact (bool): if True, looks for an exact match.
override (bool): if True, override the exact match if no match is found

\item[{Returns:}] \leavevmode\begin{description}
\item[{match (list)- A list of keys for the timeseries that match the selection}] \leavevmode
criteria.

\end{description}

\end{description}

\end{fulllineitems}



\section{Handling timeseries objects}
\label{\detokenize{LIPDutils:handling-timeseries-objects}}\index{enumerateTs() (in module pyleoclim.LipdUtils)@\spxentry{enumerateTs()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.enumerateTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{enumerateTs}}}{\emph{timeseries\_list}}{}
Enumerate the available time series objects
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{timeseries\_list: a  list of available timeseries objects. }] \leavevmode
To use the timeseries loaded upon initiation of the 
pyleoclim package, use pyleo.time\_series.

\end{description}

\end{description}

\end{fulllineitems}

\index{getTs() (in module pyleoclim.LipdUtils)@\spxentry{getTs()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.getTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{getTs}}}{\emph{timeseries\_list}, \emph{option=None}}{}
Get a specific timeseries object from a dictionary of timeseries
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{timeseries\_list: a  list of available timeseries objects. }] \leavevmode
To use the timeseries loaded upon initiation of the 
pyleoclim package, use pyleo.time\_series.

\end{description}

option: An expression to filter the datasets. Uses lipd.filterTs()

\item[{Returns:}] \leavevmode
A single timeseries object if not optional filter selected or a filtered
list if optional arguments given

\end{description}

\end{fulllineitems}



\section{Linking LiPDs to the LinkedEarth Ontology}
\label{\detokenize{LIPDutils:linking-lipds-to-the-linkedearth-ontology}}\index{LipdToOntology() (in module pyleoclim.LipdUtils)@\spxentry{LipdToOntology()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.LipdToOntology}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{LipdToOntology}}}{\emph{archiveType}}{}
standardize archiveType

Transform the archiveType from their LiPD name to their ontology counterpart
\begin{description}
\item[{Args:}] \leavevmode
archiveType (STR): name of the archiveType from the LiPD file

\item[{Returns:}] \leavevmode
archiveType according to the ontology

\end{description}

\end{fulllineitems}

\index{timeUnitsCheck() (in module pyleoclim.LipdUtils)@\spxentry{timeUnitsCheck()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.timeUnitsCheck}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{timeUnitsCheck}}}{\emph{units}}{}
This function attempts to make sense of the time units by checking for equivalence
\begin{description}
\item[{Args:}] \leavevmode
units (str): The units string for the timeseries

\item[{Returns:}] \leavevmode
unit\_group (str): Whether the units belongs to age\_units, kage\_units, year\_units, or undefined

\end{description}

\end{fulllineitems}



\section{Dealing with models}
\label{\detokenize{LIPDutils:dealing-with-models}}\index{isModel() (in module pyleoclim.LipdUtils)@\spxentry{isModel()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.isModel}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{isModel}}}{\emph{csvName}, \emph{lipd}}{}
Check for the presence of a model in the same object than the measurement table
\begin{description}
\item[{Args:}] \leavevmode
csvName (str): The name of the csv file corresponding to the measurement table
lipd (dict): A LiPD object

\item[{Returns:}] \leavevmode
model (list): List of models already available
\begin{description}
\item[{dataObject (str): The name of the paleoData or ChronData}] \leavevmode
object in which the model(s) are stored

\end{description}

\end{description}

\end{fulllineitems}

\index{modelNumber() (in module pyleoclim.LipdUtils)@\spxentry{modelNumber()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.modelNumber}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{modelNumber}}}{\emph{model}}{}
Assign a new or existing model number
\begin{description}
\item[{Args:}] \leavevmode
model (list): List of possible model number. Obtained from isModel

\item[{Returns:}] \leavevmode
modelNum (int): The number of the model

\end{description}

\end{fulllineitems}



\section{Extracting tables}
\label{\detokenize{LIPDutils:extracting-tables}}\index{isMeasurement() (in module pyleoclim.LipdUtils)@\spxentry{isMeasurement()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.isMeasurement}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{isMeasurement}}}{\emph{csv\_dict}}{}
Check whether measurement tables are available
\begin{description}
\item[{Args:}] \leavevmode
csv\_dict (dict): Dictionary of available csv

\item[{Returns:}] \leavevmode
paleoMeasurementTables - List of available paleoMeasurementTables
chronMeasurementTables - List of available chronMeasurementTables

\end{description}

\end{fulllineitems}

\index{whichMeasurement() (in module pyleoclim.LipdUtils)@\spxentry{whichMeasurement()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.whichMeasurement}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{whichMeasurement}}}{\emph{measurementTableList}, \emph{csv\_dict}}{}
Select a measurement table from a list

Use in conjunction with the function isMeasurement
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{measurementTableList (list): List of measurement tables contained in the}] \leavevmode
LiPD file. Output from the isMeasurement function

\end{description}

csv\_list (list): Dictionary of available csv

\item[{Returns:}] \leavevmode
csvName (str) - the name of the csv file

\end{description}

\end{fulllineitems}

\index{getMeasurement() (in module pyleoclim.LipdUtils)@\spxentry{getMeasurement()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.getMeasurement}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{getMeasurement}}}{\emph{csvName}, \emph{lipd}}{}
Extract the dictionary corresponding to the measurement table
\begin{description}
\item[{Args:}] \leavevmode
csvName (str): The name of the csv file
lipd (dict): The LiPD object from which to extract the data

\item[{Returns:}] \leavevmode\begin{description}
\item[{ts\_list - A dictionary containing data and metadata for each column in the}] \leavevmode
csv file.

\end{description}

\end{description}

\end{fulllineitems}



\section{Dealing with ensembles}
\label{\detokenize{LIPDutils:dealing-with-ensembles}}\index{isEnsemble() (in module pyleoclim.LipdUtils)@\spxentry{isEnsemble()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.isEnsemble}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{isEnsemble}}}{\emph{csv\_dict}}{}
Check whether ensembles are available
\begin{description}
\item[{Args:}] \leavevmode
csv\_dict (dict): Dictionary of available csv

\item[{Returns:}] \leavevmode
paleoEnsembleTables - List of available paleoEnsembleTables

chronEnsembleTables - List of availale chronEnsemble Tables

\end{description}

\end{fulllineitems}

\index{mapAgeEnsembleToPaleoData() (in module pyleoclim.LipdUtils)@\spxentry{mapAgeEnsembleToPaleoData()}\spxextra{in module pyleoclim.LipdUtils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{LIPDutils:pyleoclim.LipdUtils.mapAgeEnsembleToPaleoData}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.LipdUtils.}}\sphinxbfcode{\sphinxupquote{mapAgeEnsembleToPaleoData}}}{\emph{ensembleValues}, \emph{depthEnsemble}, \emph{depthPaleo}}{}
Map the depth for the ensemble age values to the paleo depth
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{ensembleValues (array): A matrix of possible age models. Realizations}] \leavevmode
should be stored in columns

\item[{depthEnsemble (array): A vector of depth. The vector should have the same}] \leavevmode
length as the number of rows in the ensembleValues

\item[{depthPaleo (array): A vector corresponding to the depth at which there}] \leavevmode
are paleodata information

\end{description}

\item[{Returns:}] \leavevmode
ensembleValuesToPaleo - A matrix of age ensemble on the PaleoData scale

\end{description}

\end{fulllineitems}



\chapter{Summary Plots}
\label{\detokenize{SummaryPlots:summary-plots}}\label{\detokenize{SummaryPlots::doc}}
This module handles some basic return for the summary plots.

\sphinxstylestrong{Requires} a LiPD file
\index{getMetadata() (in module pyleoclim.SummaryPlots)@\spxentry{getMetadata()}\spxextra{in module pyleoclim.SummaryPlots}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{SummaryPlots:pyleoclim.SummaryPlots.getMetadata}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.SummaryPlots.}}\sphinxbfcode{\sphinxupquote{getMetadata}}}{\emph{timeseries}}{}
Get the necessary metadata to be printed out automatically
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a specific timeseries object.

\item[{Returns:}] \leavevmode
A dictionary containing the following metadata:

archiveType

Authors (if more than 2, replace by et al.

PublicationYear

Publication DOI

Variable Name

Units

Climate Interpretation

Calibration Equation

Calibration References

Calibration Notes

\end{description}

\end{fulllineitems}

\index{TsData() (in module pyleoclim.SummaryPlots)@\spxentry{TsData()}\spxextra{in module pyleoclim.SummaryPlots}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{SummaryPlots:pyleoclim.SummaryPlots.TsData}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.SummaryPlots.}}\sphinxbfcode{\sphinxupquote{TsData}}}{\emph{timeseries}, \emph{x\_axis=''}}{}
Get the PaleoData with age/depth information

Get the necessary information for the TS plots/necessary to allow for
axes specification
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{timeseries: a single timeseries object. }] \leavevmode
By default, will prompt the user

\item[{x-axis (str): The representation against which to plot the }] \leavevmode
paleo-data. Options are “age”, “year”, and “depth”. 
Default is to let the system choose if only one available 
or prompt the user.

\end{description}

\item[{Returns:}] \leavevmode
x - the x-valus

y - the y-values

archiveType - the archiveType (for plot settings)

x\_label - the label for the x-axis

y\_label - the label for the y-axis

label - the results of the x-axis query. Either depth, year, or age

\end{description}

\end{fulllineitems}

\index{agemodelData() (in module pyleoclim.SummaryPlots)@\spxentry{agemodelData()}\spxextra{in module pyleoclim.SummaryPlots}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{SummaryPlots:pyleoclim.SummaryPlots.agemodelData}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.SummaryPlots.}}\sphinxbfcode{\sphinxupquote{agemodelData}}}{\emph{timeseries}}{}
Get the necessary information for the agemodel plot
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{timeseries: a single timeseries object. By default, will}] \leavevmode
prompt the user

\end{description}

\item[{Returns:}] \leavevmode
depth - the depth values

age - the age values

x\_label - the label for the x-axis

y\_label - the label for the y-axis

archiveType - the archiveType (for default plot settings)

\end{description}

\end{fulllineitems}



\chapter{Spectral Functions}
\label{\detokenize{Spectral:spectral-functions}}\label{\detokenize{Spectral::doc}}
This module allows analysis in the frequency domain
\index{ar1\_fit() (in module pyleoclim.Spectral)@\spxentry{ar1\_fit()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.ar1_fit}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{ar1\_fit}}}{\emph{ys, ts=None, detrend=None, params={[}'default', 4, 0, 1{]}}}{}
Returns the lag-1 autocorrelation from ar1 fit OR persistence from tauest.
\begin{description}
\item[{Args:}] \leavevmode
ys (array): the time series
ts (array): the time axis of that series
detrend (str): ‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
\begin{quote}
\begin{quote}

‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}
\end{quote}

\item[{Returns:}] \leavevmode
g (float): lag-1 autocorrelation coefficient (for evenly-spaced time series)
OR estimated persistence (for unevenly-spaced time series)

\end{description}

\end{fulllineitems}

\index{ar1\_sim() (in module pyleoclim.Spectral)@\spxentry{ar1\_sim()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.ar1_sim}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{ar1\_sim}}}{\emph{ys, n, p, ts=None, detrend=False, params={[}'default', 4, 0, 1{]}}}{}
Produce p realizations of an AR1 process of length n with lag-1 autocorrelation g calculated from \sphinxtitleref{ys} and \sphinxtitleref{ts}
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series
n, p (int): dimensions as n rows by p columns
ts (array): the time axis of that series
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

\item[{Returns:}] \leavevmode
red (matrix): n rows by p columns matrix of an AR1 process

\end{description}

\end{fulllineitems}

\index{wwz() (in module pyleoclim.Spectral)@\spxentry{wwz()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.wwz}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{wwz}}}{\emph{ys, ts, tau=None, freqs=None, c=0.012665147955292222, Neff=3, Neff\_coi=3, nMC=200, nproc=8, detrend=False, params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, method='Kirchner\_f2py', len\_bd=0, bc\_mode='reflect', reflect\_type='odd'}}{}
Return the weighted wavelet amplitude (WWA) with phase, AR1\_q, and cone of influence, as well as WT coefficients
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs will be deleted automatically
ts (array): the time points, if \sphinxtitleref{ys} contains any NaNs, some of the time points will be deleted accordingly
tau (array): the evenly-spaced time points
freqs (array): vector of frequency
c (float): the decay constant, the default value 1/(8*np.pi**2) is good for most of the cases
Neff (int): effective number of points
nMC (int): the number of Monte-Carlo simulations
nproc (int): the number of processes for multiprocessing
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\item[{method (str): ‘Foster’ - the original WWZ method;}] \leavevmode
‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner\_f2py’ - the method Kirchner adapted from Foster with f2py

\end{description}

len\_bd (int): the number of the ghost grids want to creat on each boundary
bc\_mode (str): see np.lib.pad()
reflect\_type (str): see np.lib.pad()

\item[{Returns:}] \leavevmode
wwa (array): the weighted wavelet amplitude.
AR1\_q (array): AR1 simulations
coi (array): cone of influence
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
Neffs (array): the matrix of effective number of points in the time-scale coordinates
coeff (array): the wavelet transform coefficents

\end{description}

\end{fulllineitems}

\index{wwz\_psd() (in module pyleoclim.Spectral)@\spxentry{wwz\_psd()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.wwz_psd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{wwz\_psd}}}{\emph{ys, ts, freqs=None, tau=None, c=0.001, nproc=8, nMC=200, detrend=False, params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, Neff=3, anti\_alias=False, avgs=2, method='Kirchner\_f2py'}}{}
Return the psd of a timeseries directly using wwz method.
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs will be deleted automatically
ts (array): the time points, if \sphinxtitleref{ys} contains any NaNs, some of the time points will be deleted accordingly
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
c (float): the decay constant, the default value 1e-3 is good for most of the cases
nproc (int): the number of processes for multiprocessing
nMC (int): the number of Monte-Carlo simulations
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

gaussianize (bool): If True, gaussianizes the timeseries
standardize (bool): If True, standardizes the timeseries
method (str): ‘Foster’ - the original WWZ method;
\begin{quote}

‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner\_f2py’ - the method Kirchner adapted from Foster with f2py
\end{quote}

Neff (int):
anti\_alias (bool): If True, uses anti-aliasing
avgs (int):

\item[{Returns:}] \leavevmode
psd (array): power spectral density
freqs (array): vector of frequency
psd\_ar1\_q95 (array): the 95\% quantile of the psds of AR1 processes
psd\_ar1 (array): the psds of AR1 processes

\end{description}

\end{fulllineitems}

\index{xwt() (in module pyleoclim.Spectral)@\spxentry{xwt()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.xwt}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{xwt}}}{\emph{ys1, ts1, ys2, ts2, tau=None, freqs=None, c=0.012665147955292222, Neff=3, Neff\_coi=6, nproc=8, detrend=False, params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, method='Kirchner\_f2py'}}{}
Return the cross-wavelet transform of two time series.
\begin{description}
\item[{Args:}] \leavevmode
ys1, ys2 (array): the two time series
ts1, ts2 (array): the time axis of the two time series
tau (array): the evenly-spaced time points
freqs (array): vector of frequency
c (float): the decay constant, the default value 1/(8*np.pi**2) is good for most of the cases
Neff (int): effective number of points
nproc (int): the number of processes for multiprocessing
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

gaussianize (bool): If True, gaussianizes the timeseries
standardize (bool): If True, standardizes the timeseries
method (str): ‘Foster’ - the original WWZ method;
\begin{quote}

‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner\_f2py’ - the method Kirchner adapted from Foster with f2py
\end{quote}

\item[{Returns:}] \leavevmode
xw\_amplitude (array): the cross wavelet amplitude
xw\_phase (array): the cross wavelet phase
freqs (array): vector of frequency
tau (array): the evenly-spaced time points
AR1\_q (array): AR1 simulations
coi (array): cone of influence

\end{description}

\end{fulllineitems}

\index{xwc() (in module pyleoclim.Spectral)@\spxentry{xwc()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.xwc}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{xwc}}}{\emph{ys1, ts1, ys2, ts2, smooth\_factor=0.25, tau=None, freqs=None, c=0.012665147955292222, Neff=3, nproc=8, detrend=False, nMC=200, params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, method='Kirchner\_f2py'}}{}
Return the cross-wavelet coherence of two time series.
\begin{description}
\item[{Args:}] \leavevmode
ys1, ys2 (array): the two time series
ts1, ts2 (array): the time axis of the two time series
tau (array): the evenly-spaced time points
freqs (array): vector of frequency
c (float): the decay constant, the default value 1/(8*np.pi**2) is good for most of the cases
Neff (int): effective number of points
nproc (int): the number of processes for multiprocessing
nMC (int): the number of Monte-Carlo simulations
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

gaussianize (bool): If True, gaussianizes the timeseries
standardize (bool): If True, standardizes the timeseries
method (str): ‘Foster’ - the original WWZ method;
\begin{quote}

‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner\_f2py’ - the method Kirchner adapted from Foster with f2py
\end{quote}

\item[{Returns:}] \leavevmode\begin{description}
\item[{res (dict): contains the cross wavelet coherence, cross-wavelet phase,}] \leavevmode
vector of frequency, evenly-spaced time points, AR1 sims, cone of influence

\end{description}

\end{description}

\end{fulllineitems}

\index{plot\_wwa() (in module pyleoclim.Spectral)@\spxentry{plot\_wwa()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_wwa}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_wwa}}}{\emph{wwa, freqs, tau, AR1\_q=None, coi=None, levels=None, tick\_range=None, yticks=None, yticks\_label=None, ylim=None, xticks=None, xlabels=None, figsize={[}20, 8{]}, clr\_map='OrRd', cbar\_drawedges=False, cone\_alpha=0.5, plot\_signif=False, signif\_style='contour', title=None, plot\_cbar=True, plot\_cone=False, ax=None, xlabel='Year CE', ylabel='Period (years)', cbar\_orientation='vertical', cbar\_pad=0.05, cbar\_frac=0.15, cbar\_labelsize=None}}{}
Plot the wavelet amplitude
\begin{description}
\item[{Args:}] \leavevmode
wwa (array): the weighted wavelet amplitude.
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
AR1\_q (array): AR1 simulations
coi (array): cone of influence
levels (array): levels of values to plot
tick\_range (array): levels of ticks to show on the colorbar
yticks (list): ticks on y-axis
ylim (list): limitations for y-axis
xticks (list): ticks on x-axis
figsize (list): the size for the figure
clr\_map (str): the name of the colormap
cbar\_drawedges (bool): whether to draw edges on the colorbar or not
cone\_alpha (float): the alpha value for the area covered by cone of influence
plot\_signif (bool): plot 95\% significant area or not
signif\_style (str): plot 95\% significant area with \sphinxtitleref{contour} or \sphinxtitleref{shade}
title (str): Title for the plot
plot\_cbar (bool): Plot the color scale bar
plot\_cone (bool): plot cone of influence
ax: Return as axis instead of figure (useful to integrate plot into a subplot)
xlabel (str): The x-axis label
ylabel (str): The y-axis label
cbar\_pad (float): the pad for the colorbar
cbar\_frac (float): the frac for the colorbar
cbar\_labelsize (float): the font size of the colorbar label

\item[{Returns:}] \leavevmode
fig (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_coherence() (in module pyleoclim.Spectral)@\spxentry{plot\_coherence()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_coherence}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_coherence}}}{\emph{res\_xwc, pt=0.5, levels=None, tick\_range=None, basey=2, yticks=None, ylim=None, xticks=None, xlabels=None, figsize={[}20, 8{]}, clr\_map='OrRd', skip\_x=5, skip\_y=5, scale=30, width=0.004, cbar\_drawedges=False, cone\_alpha=0.5, plot\_signif=False, signif\_style='contour', title=None, plot\_cone=False, ax=None, xlabel='Year', ylabel='Period', cbar\_orientation='vertical', cbar\_pad=0.05, cbar\_frac=0.15, cbar\_labelsize=None}}{}
Plot the wavelet coherence
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{res\_xwc (dict): contains the cross wavelet coherence, cross-wavelet phase,}] \leavevmode
vector of frequency, evenly-spaced time points, AR1 sims, 
cone of influence. See xwc

\end{description}

pt (float): plot arrows above pt value
levels (array): levels of values to plot
tick\_range (array): levels of ticks to show on the colorbar
basey (int): log base for y. Default is 2. 
yticks (list): ticks on y-axis
ylim (list): limitations for y-axis
xticks (list): ticks on x-axis
xlabels (list): List of labels for the x-axis ticks
figsize (list): the size for the figure
clr\_map (str): the name of the colormap
skip\_x, skip\_y (float): plot every x,y points
scale (int): Scale factor for arrows
width (float):  Width of the arrows  
cbar\_drawedges (bool): whether to draw edges on the colorbar or not
cone\_alpha (float): the alpha value for the area covered by cone of influence
plot\_signif (bool): plot 95\% significant area
signif\_style (str): plot 95\% significant area with \sphinxtitleref{contour} or \sphinxtitleref{shade}
title (str): Add a title to the plot
plot\_cone (bool): plot cone of influence
ax: Return as axis instead of figure (useful to integrate plot into a subplot)
xlabel (str): The x-axis label
ylabel (str): The y-axis label
cbar\_orientation (str): the orientation of the colorbar. Default is vertical
cbar\_pad (float): the pad for the colorbar
cbar\_frac (float): the frac for the colorbar
cbar\_labelsize (float): the font size of the colorbar label

\item[{Returns:}] \leavevmode
fig (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_wwadist() (in module pyleoclim.Spectral)@\spxentry{plot\_wwadist()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_wwadist}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_wwadist}}}{\emph{wwa}, \emph{ylim=None}}{}
Plot the distribution of wwa with the 95\% quantile line.
\begin{description}
\item[{Args:}] \leavevmode
wwa (array): the weighted wavelet amplitude.
ylim (list): limitations for y-axis

\item[{Returns:}] \leavevmode
fig (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_psd() (in module pyleoclim.Spectral)@\spxentry{plot\_psd()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_psd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_psd}}}{\emph{psd, freqs, lmstyle='-', linewidth=None, color='\#3b5b92', ar1\_lmstyle='-', ar1\_linewidth=None, period\_ticks=None, period\_tickslabel=None, psd\_lim=None, period\_lim=None, alpha=1, figsize={[}20, 8{]}, label='PSD', plot\_ar1=False, psd\_ar1\_q95=None, title=None, legend=True, psd\_ar1\_color='\#d9544d', ax=None, vertical=False, plot\_gridlines=True, period\_label='Period (years)', psd\_label='Spectral Density', zorder=None}}{}
Plot power spectral density
\begin{description}
\item[{Args:}] \leavevmode
psd (array): power spectral density
freqs (array): vector of frequency
period\_ticks (list): ticks for period
period\_tickslabel (list): Labels for the period ticks
psd\_lim (list): limits for spectral density axis
label (str): the label for the PSD
plot\_ar1 (bool): plot the ar1 curve
psd\_ar1\_q95 (array): the 95\% quantile of the AR1 PSD
psd\_ar1\_color (str): the color for the 95\% quantile of the AR1 PSD
title (str): the title for the figure
period\_lim (list): limits for period axis
figsize (list): the size for the figure
ax (axis): Return as axis instead of figure (useful to integrate plot into a subplot)
vertical (bool): plot in vertical layout or not
legend (bool): plot legend
lmstyle (str): the line style
linewidth (float): the line width
color (str): Color of the line
ar1\_lmstyle (str): line style for the AR1 ensemble
ar1\_linewidth (int): line width for AR1 ensemble
period\_label (str): the label for period
psd\_label (str): the label for psd
zorder (int): the order of the layer
period\_tickslabel (str): Label for the period tick. 
alpha (float): set transparency
label (str): Label for the figure
plot\_gridlines (bool): Plot gridlines
period\_label (str): Label for the period axis
psd\_label (str): label for the PSD axis

\item[{Returns:}] \leavevmode
ax (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_summary() (in module pyleoclim.Spectral)@\spxentry{plot\_summary()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_summary}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_summary}}}{\emph{ys, ts, freqs=None, tau=None, c1=0.012665147955292222, c2=0.001, nMC=200, nproc=1, detrend=False, params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, levels=None, method='Kirchner\_f2py', anti\_alias=False, period\_ticks=None, ts\_color=None, ts\_style='-o', title=None, ts\_ylabel=None, wwa\_xlabel=None, wwa\_ylabel=None, psd\_lmstyle='-', psd\_lim=None, font\_scale=1.5, period\_S\_str='beta\_I', period\_S={[}0.125, 0.5{]}, period\_L\_str='beta\_D', period\_L={[}0.005, 0.05{]}}}{}
Plot the time series with the wavelet analysis and psd
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series
ts (array): time axis of the time series
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
c1 (float): the decay constant (wwz method)
c2 (float): the decay constant (wwz\_psd method)
nMC(int): Number of Monte-Carlo simulations
nproc (int): fake argument, just for convenience
detrend (str): ‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
\begin{quote}

‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

gaussianize (bool): If True, gaussianizes the timeseries
standardize (bool): If True, standardizes the timeseries
levels (array): levels of values to plot
method (str): method for the WWZ transform. Default is Kirchner\_f2py
anti\_alias (bool): If True, uses anti-aliasing
period\_ticks (list): ticks for period
ts\_color (str): the color for the time series curve
ts\_style (str): Style for the line
title (str): the title for the time series plot
ts\_ylabel (str): label for y-axis in the time series plot
wwa\_xlabel (str): label for x-axis in the wwa plot
wwa\_ylabel (str): label for y-axis in the wwa plot
psd\_lmstyle (str): the line style in the psd plot
psd\_lim (list): the limits for psd
font\_scale (float): Scaling factor for the font on the plot
period\_S, period\_L (list): the ranges for beta estimation
period\_S\_str, period\_L\_str (str): String for beta estimation

\item[{Returns:}] \leavevmode
fig (figure): the summary plot

\end{description}

\end{fulllineitems}

\index{calc\_plot\_psd() (in module pyleoclim.Spectral)@\spxentry{calc\_plot\_psd()}\spxextra{in module pyleoclim.Spectral}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.calc_plot_psd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{calc\_plot\_psd}}}{\emph{ys, ts, ntau=501, dcon=0.001, standardize=False, anti\_alias=False, plot\_fig=True, method='Kirchner\_f2py', nproc=8, period\_ticks={[}0.5, 1, 2, 5, 10, 20, 50, 100, 200, 500, 1000{]}, color=None, figsize={[}10, 6{]}, font\_scale=2, lw=3, label='PSD', zorder=None, xlim=None, ylim=None, loc='upper right', bbox\_to\_anchor=None}}{}
Calculate the PSD and plot the result
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series
ts (array): time axis of the time series
natu (int): the length of tau, the evenly-spaced time points,
\begin{quote}

namely the time shift for wavelet analysis
\end{quote}

dcon (float): the decay constant
standardize(bool): perform standardization or not
anti\_alias(bool): perform anti-alising procedure or not
plot\_fig (bool): plot the result or not
method (str): the WWZ method to use
nproc (int): the number of threads
period\_ticks (list): List of period ticks
color (str): set color
figsize (list): Size of the figure
font\_scale(float): Scale of the font
lw (float): For plotting purposes
label (str): Labeld for the y-axis
zorder (int): the order of the layer
xlim (list): x-axis limits
ylim (list): y-axis limits
loc (str): location for the legend
bbox\_to\_anchor (list): gives a great degree of control for manual
\begin{quote}

legend placement. For example, if you want your axes legend
located at the figure’s top right-hand corner instead of the axes’
corner, simply specify the corner’s location, and the coordinate 
system of that location
\end{quote}

\item[{Returns:}] \leavevmode
fig (figure): the summary plot
psd (array): the spectral density
freqs (array): the frequency vector

\end{description}

\end{fulllineitems}



\chapter{RBchron}
\label{\detokenize{RBchron:rbchron}}\label{\detokenize{RBchron::doc}}
This module helps in the preparation of a Bchron run.

When using this module, please cite:
* Haslett, J., and Parnell, A.C. (2008). A simple monotone process with application to radiocarbon-dated depth chronologies. Journal of the Royal Statistical Society, Series C, 57, 399-418, DOI:10.111/j.1467-9876.2008.00623.x
* Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E.,  and Huntley, B. (2008). A flexible approach to assessing  synchroneity of past events using Bayesian reconstructions of sedimentation history. Quaternary Science Reviews, 27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009
\index{chooseCalCurves() (in module pyleoclim.RBchron)@\spxentry{chooseCalCurves()}\spxextra{in module pyleoclim.RBchron}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.chooseCalCurves}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{chooseCalCurves}}}{}{}
Prompt for a calibration curve if not given by the user.

Prompt the user for the name of a calibration curve used to run the Bchron 
software package. The user can enter either enter only one name that will
be applied to each age or a list of names of different ages. To enter a list, 
separate each name with a comma. No quotation marks needed.
\begin{description}
\item[{Returns:}] \leavevmode
A list of calibration curves to be applied

\end{description}

\end{fulllineitems}

\index{verifyCalCurves() (in module pyleoclim.RBchron)@\spxentry{verifyCalCurves()}\spxextra{in module pyleoclim.RBchron}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.verifyCalCurves}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{verifyCalCurves}}}{\emph{CalCurves}}{}
Verify that the list of calibration curves contain valid entries for BChron

Performs a verification that the names entered in the list of calibration
curves are conformed to the names used by Bchron. Will prompt the user to
replace the name if needed.
\begin{description}
\item[{Agrs:}] \leavevmode\begin{description}
\item[{CalCurves (list): A list of strings containing the name(s) of the}] \leavevmode
calibration curves to be used

\end{description}

\item[{Returns:}] \leavevmode
CalCurves - Checked list of calibration curves names

\end{description}

\end{fulllineitems}

\index{reservoirAgeCorrection() (in module pyleoclim.RBchron)@\spxentry{reservoirAgeCorrection()}\spxextra{in module pyleoclim.RBchron}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.reservoirAgeCorrection}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{reservoirAgeCorrection}}}{}{}
Estimate reservoir age correction

Assists in estimating the reservoir age correction for marine records.
If unknown, will direct the user to copy and paste the table available
on the 14Chrono Marine Reservoir database: \sphinxurl{http://intcal.qub.ac.uk/marine/}
\begin{description}
\item[{Returns:}] \leavevmode
ageCorr -  the DeltaR for the site.

ageCorrStd - The error on DeltaR estimated as the standard error on the 
mean if using the 14Chrono Marine Reservoir database.

\end{description}

\end{fulllineitems}

\index{runBchron() (in module pyleoclim.RBchron)@\spxentry{runBchron()}\spxextra{in module pyleoclim.RBchron}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.runBchron}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{runBchron}}}{\emph{ages}, \emph{agesStd}, \emph{positions}, \emph{rejectAges=None}, \emph{positionsThickness=None}, \emph{calCurves=None}, \emph{reservoirAgeCorr=None}, \emph{outlierProbs=None}, \emph{predictPositions=None}, \emph{iterations=10000}, \emph{burn=2000}, \emph{thin=8}, \emph{extractDate=-69}, \emph{maxExtrap=500}, \emph{thetaMhSd=0.5}, \emph{muMhSd=0.1}, \emph{psiMhSd=0.1}, \emph{ageScaleVal=1000}, \emph{positionScaleVal=100}}{}
Age model for Tie-Point chronologies

Fits a non-parametric chronology model to age/position data according to
the Compound Poisson-Gamma model defined by Haslett and Parnell (2008). 
This version used a slightly modified Markov chain Monte-Carlo fitting
algorithm which aims to converge quicker and requires fewer iterations.
It also a slightly modified procedure for identifying outliers.

The Bchronology functions fits a compounf Poisson-Gamma distribution to the
incrememnts between the dated levels. This involves a stochastic linear
interpolation step where the age gaps are Gamma distributed, and the position
gaps are Exponential. Radiocarbon and non-radiocarbon dates (including outliers)
are updated within the fucntion also by MCMC.
\begin{description}
\item[{Args:}] \leavevmode
ages (array): A vector of ages (most likely 14C)
ageSds (array): A vector of 1-sigma values for the ages given above
positions (array): Position values (e.g. depths) for each age
rejectAges (vector): A vector of 1/0 where 1 include the dates to be rejected.
\begin{quote}

Default it None.
\end{quote}
\begin{description}
\item[{positionsThickness (array): (Optional) Thickness values for each of the positions.}] \leavevmode
The thickness values should be the full thickness value of the
slice. By default set to zero.

\item[{calCurves (list): (Optional) A vector of values containing either ‘intcal13’,}] \leavevmode
‘marine13’, ‘shcal13’, or ‘normal’. If none is provided, will
prompt the user. Should be either of length =1 if using the same
calibration for each age or the same length as the vector of ages.

\item[{reservoirAgeCorr (array): (Optional) A list (matrix) of two floats that correspond to the}] \leavevmode
DeltaR and DeltaR uncertainty. If already added to the ages and
ages standard deviation, then enter {[}0,0{]} to bypass the prompt.
Will only be applied if CalCurves is set to ‘marine13’. Otherwise,
leave to none.

\item[{outlierProbs (array): (Optional) A vector of prior outlier probabilities,}] \leavevmode
one for each age. Defaults to 0.01

\item[{predictPositions (array): (Optional) a vector of positions }] \leavevmode
(e.g. depths) at which predicted age values are required. 
Defaults to a sequence of length 100 from the top position to the
bottom position.

\item[{iterations (int): (Optional) The number of iterations to start the procedure. }] \leavevmode
Default and minimum should be 10000.

\item[{burn (int): (Optional) The number of starting iterations to discard.}] \leavevmode
Default is 200

\item[{thin (int): (Optional) The step size for every iteration to keep beyond}] \leavevmode
the burnin. Default is 8.

\item[{extractDate (float): (Optional) The top age of the core. Used for}] \leavevmode
extrapolation purposes so that no extrapolated ages go beyond the
top age of the core. Defaults to the current year.

\item[{maxExtrap (int): (Optional) The maximum number of extrapolations to}] \leavevmode
perform before giving up and setting the predicted ages to NA. 
Useful for when large amounts of extrapolation are required, i.e.
some of the predictPositions are a long way from the dated
positions. Defaults to 500.

\item[{thetaMhSd (float):  (Optional)  The Metropolis-Hastings standard}] \leavevmode
deviation for the age parameters. Defaults to 0.5.

\item[{muMhSd (float): (Optional)  The Metropolis-Hastings standard deviation}] \leavevmode
for the compound Poisson-Gamma Scale. Defaults to 0.1

\item[{psiMhSd (float): (Optional) The Metropolis-Hastings standard deviation }] \leavevmode
for the Compound Poisson-Gamma Scale.

\item[{ageScaleVal (int): (Optional) A scale value for the ages. }] \leavevmode
Bchronology works best when the ages are scaled to be 
approximately between 0 and 100.
The default value is thus 1000 for ages given in years.

\item[{positionScaleVal (int):  (Optional) A scale value for the positions. }] \leavevmode
Bchronology works best when the positions are scaled to be 
approximately between 0 and 100. The default value is thus
100 for positions given in cm.

\item[{Returns:}] \leavevmode
depth - the predicted positions (either same as the user or the default)
\begin{description}
\item[{chron -  a numpy array of possible chronologies in each column.}] \leavevmode
The number of rows is the same as the length of depth

\end{description}

ageDist - the distribution of ages around each dates.
run - the full R object containing the outputs of the Bchron run

\item[{Warnings:}] \leavevmode\begin{description}
\item[{This function requires R and the Bchron package and all its}] \leavevmode
dependencies to be installed on the same machine.

\end{description}

\item[{Reference:}] \leavevmode\begin{itemize}
\item {} \begin{description}
\item[{Haslett, J., and Parnell, A. C. (2008). A simple monotone }] \leavevmode
process with application to radiocarbon-dated depth 
chronologies. Journal of the Royal Statistical Society, 
Series C, 57, 399-418. DOI:10.1111/j.1467-9876.2008.00623.x

\end{description}

\item {} \begin{description}
\item[{Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E., }] \leavevmode
and Huntley, B. (2008). A flexible approach to assessing 
synchroneity of past events using Bayesian reconstructions
of sedimentation history. Quaternary Science Reviews, 
27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009

\end{description}

\end{itemize}

\end{description}

\end{description}

\end{fulllineitems}

\index{plotBchron() (in module pyleoclim.RBchron)@\spxentry{plotBchron()}\spxextra{in module pyleoclim.RBchron}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.plotBchron}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{plotBchron}}}{\emph{depth, chron, positions, ageDist, flipCoor=False, xlabel='Depth', ylabel='Age', xlim=None, ylim=None, violinColor='\#8B008B', medianLineColor='black', medianLineWidth=2.0, CIFillColor='Silver', samplePaths=True, samplePathNumber=10, alpha=0.5, figsize={[}4, 8{]}, ax=None}}{}
Plot a Bchron output

This function creates a plot showing the calibrated calendar ages and
associated 95\% confidence interval as error bars, the 95\% ensemble from
the produced age model as well as randomly drawn members of the ensemble.
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{depth (array): the positions in the archive (often referred to as}] \leavevmode
depth) where the age model was interpolated to. Should be a vector

\item[{chron (array): The possible age models returned by BChron. The number}] \leavevmode
of rows should be the same length as the depth vector, with each
possible realization stored in the columns.

\item[{positions (array): The depth on the archive at which chronological}] \leavevmode
measurements have been made. Should be a vector

\item[{agesDist (array): The distribution of ages for each chronological tie}] \leavevmode
points. The number of columns should correspond to the number of
chronological tie points available.

\end{description}

flipCoor (bool): If True, plots depth on the y-axis.     
xlabel (str): The label for the x-axis
ylabel (str): The label for the y-axis
xlim (list): Limits for the x-axis. Default corresponds to the min/max
\begin{quote}

of the depth vector.
\end{quote}

ylim (list): Limits for the y-axis. Default set by matplotlib
violinColor (str): The color for the violins. Default is purple
medianLineColor (str): The color for the median line. Default is black.
medianLineWidth (float): The width for the median line
CIFillColor (str): Fill color in between the 95\% confidence interval.
\begin{quote}

Default is silver.
\end{quote}
\begin{description}
\item[{samplePaths (bool): If True, draws sample paths from the distribution.}] \leavevmode
Use the same color as the violins.

\item[{samplePathNumber (int): The number of sample paths to draw. Default is 10.}] \leavevmode
Note: samplePaths need to be set to True.

\end{description}

alpha (float): The violins’ transparency. Number between 0 and 1
figsize (list): The figure size. Default is {[}4,8{]}
ax: Default is None. Useful to set for subplots.

\item[{Returns:}] \leavevmode\begin{itemize}
\item {} 
fig: the figure.

\end{itemize}

\end{description}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}