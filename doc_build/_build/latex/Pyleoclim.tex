%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{2}



\title{Pyleoclim Documentation}
\date{Aug 06, 2018}
\release{0.4.8}
\author{Deborah Khider, Julien Emile-Geay, Feng Zhu}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}


Contents:


\chapter{Pyleoclim}
\label{\detokenize{Introduction:pyleoclim}}\label{\detokenize{Introduction::doc}}

\section{What is it?}
\label{\detokenize{Introduction:what-is-it}}
Pyleoclim is a Python package primarily geared towards the analysis and visualization of paleoclimate data.
Such data often come in the form of timeseries with missing values and age uncertainties, and the package
includes several low-level methods to deal with these issues, as well as high-level methods that re-use those
to perform scientific workflows.

The package assumes that the data are stored in the Linked Paleo Data (\sphinxhref{http://www.clim-past.net/12/1093/2016/}{LiPD})
format and makes extensive use of the \sphinxhref{http://nickmckay.github.io/LiPD-utilities/}{LiPD utilities}. The package
is aware of age ensembles stored via LiPD and uses them for time-uncertain analyses very much like \sphinxhref{http://nickmckay.github.io/GeoChronR/}{GeoChronR}.

\sphinxstylestrong{Current Capabilities:}
\begin{itemize}
\item {} 
binning

\item {} 
interpolation

\item {} 
plotting maps, timeseries, and basic age model information

\item {} 
paleo-aware correlation analysis (isopersistent, isospectral, and classical t-test)

\item {} 
weighted wavelet Z transform (WWZ)

\item {} 
age modeling through Bchron

\end{itemize}

\sphinxstylestrong{Future capabilities:}
\begin{itemize}
\item {} 
paleo-aware singular spectrum analysis (AR(1) null eigenvalue identification, missing data)

\item {} 
spectral analysis (Multi-Taper Method, Lomb-Scargle)

\item {} 
cross-wavelet analysis

\item {} 
index reconstruction

\item {} 
climate reconstruction

\item {} 
ensemble methods for most of the above

\end{itemize}


\section{Version Information}
\label{\detokenize{Introduction:version-information}}
\begin{DUlineblock}{0em}
\item[] 0.4.8: Add support of f2py WWZ for Linux
\item[] 0.4.7: Update to coherence function
\item[] 0.4.0: New functionalities: map nearest records by archive type, plot ensemble time series, age modelling through Bchron.
\item[] 0.3.1: New functionalities: segment a timeseries using a gap detection criteria, update to summary plot to perform spectral analysis
\item[] 0.3.0: Compatibility with LiPD 1.3 and Spectral module added
\item[] 0.2.5: Fix error on loading (Looking for Spectral Module)
\item[] 0.2.4: Fix load error from init
\item[] 0.2.3: Freeze LiPD version to 1.2 to avoid conflicts with 1.3
\item[] 0.2.2: Change progressbar to tqdm and add standardization function
\item[] 0.2.1: Update package requirements
\item[] 0.2.0: Restructure the package so that the main functions can be called without the use of a LiPD files and associated timeseries objects.
\item[] 0.1.4: Rename functions using camel case convention and consistency with LiPD utilities version 0.1.8.5
\item[] 0.1.3: Compatible with LiPD utilities version 0.1.8.5
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Function openLiPD() renamed openLiPDs()
\end{DUlineblock}
\item[] 0.1.2: Compatible with LiPD utilities version 0.1.8.3
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Uses Basemap instead of cartopy
\end{DUlineblock}
\item[] 0.1.1: Freezes the package prior to version 0.1.8.2 of LiPD utilities
\item[] 0.1.0: First release
\end{DUlineblock}


\section{Installation}
\label{\detokenize{Introduction:installation}}
Python v3.4+ is required. Tested with Python v3.5

Will not run on a Windows system.

Pyleoclim is published through Pypi and easily installed via pip:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{pyleoclim}
\end{sphinxVerbatim}


\section{Quickstart guide}
\label{\detokenize{Introduction:quickstart-guide}}\begin{enumerate}
\item {} 
Open your command line application (Terminal or Command Prompt)

\item {} 
Install with command:

\end{enumerate}
\begin{quote}

pip install pyleoclim
\end{quote}
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
Wait for installation to complete, then:

\end{enumerate}
\begin{enumerate}
\item {} 
Import the package into your favorite Python environment (we recommend the use of Spyder, which comes standard with the Anaconda build)

\item {} 
Use Jupyter Notebook to go through the tutorial contained in the \sphinxhref{https://github.com/LinkedEarth/Pyleoclim\_util/tree/master/Example}{PyleolimQuickstart.ipynb}

\end{enumerate}


\section{Requirements}
\label{\detokenize{Introduction:requirements}}\begin{itemize}
\item {} 
LiPD v0.2.5+

\item {} 
pandas v0.22+

\item {} 
numpy v1.14+

\item {} 
matplotlib v2.0+

\item {} 
Basemap v1.0.7+

\item {} 
scipy v0.19.0+

\item {} 
statsmodel v0.8.0+

\item {} 
seaborn v0.7.0+

\item {} 
scikit-learn v0.17.1+

\item {} 
tqdm v4.14.0+

\item {} 
pathos v0.2.0+

\item {} 
tqdm 4.14+

\item {} 
rpy2 2.8.4+

\end{itemize}

The installer will automatically check for the needed updates.


\section{Further information}
\label{\detokenize{Introduction:further-information}}
\begin{DUlineblock}{0em}
\item[] GitHub: \sphinxurl{https://github.com/LinkedEarth/Pyleoclim\_util}
\item[] LinkedEarth: \sphinxurl{http://linked.earth}
\item[] Python and Anaconda: \sphinxurl{http://conda.pydata.org/docs/test-drive.html}
\item[] Jupyter Notebook: \sphinxurl{http://jupyter.org/}
\end{DUlineblock}


\section{Contact}
\label{\detokenize{Introduction:contact}}
Please report issues to \sphinxhref{mailto:linkedearth@gmail.com}{linkedearth@gmail.com}


\section{License}
\label{\detokenize{Introduction:license}}
The project is licensed under the \sphinxhref{https://github.com/LinkedEarth/Pyleoclim\_util/blob/master/license}{GNU Public License} .


\section{Disclaimer}
\label{\detokenize{Introduction:disclaimer}}
This material is based upon work supported by the U.S. National Science Foundation under Grant Number
ICER-1541029. Any opinions, findings, and conclusions or recommendations expressed in this material are those
of the investigators and do not necessarily reflect the views of the National Science Foundation.


\chapter{Main Functions}
\label{\detokenize{Main:main-functions}}\label{\detokenize{Main::doc}}

\section{Using Pyleoclim with a LiPD file}
\label{\detokenize{Main:using-pyleoclim-with-a-lipd-file}}

\subsection{Getting started}
\label{\detokenize{Main:getting-started}}
Pyleoclim relies heavily on the concept of timeseries objects introduced in
\sphinxhref{http://www.clim-past.net/12/1093/2016/}{LiPD} and implemented in the
\sphinxhref{http://nickmckay.github.io/LiPD-utilities/}{LiPD utilities}.

Briefly, timeseries objects are dictionaries containing the ChronData values and
PaleoData values as well as the metadata associated with the record. If one record
has three ProxyObservations (e.g., Mg/Ca, d18O, d13C) then it will have three timeseries
objects, one for each of the observations.

The LiPD utilities function lipd.extractTs() returns a list of dictionaries for
the selected LiPD files, which need to be passed to Pyleoclim along with the path
to the directory containing the LiPD files.
\begin{description}
\item[{This is done through the functions pyleoclim.openLiPD() and pyleoclim.fetchTs(),}] \leavevmode
which are lightweight versions of their counterparts in the LiPD utilities:

\end{description}
\index{openLipd() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.openLipd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{openLipd}}}{\emph{usr\_path=''}}{}
Read Lipd files into a dictionary

Sets the dictionary as global variable so that it doesn’t have to be provided
as an argument for every function.
\begin{description}
\item[{Args:}] \leavevmode
usr\_path (str): The path to a directory or a single file. (Optional argument)

\item[{Returns:}] \leavevmode
lipd\_dict - a dictionary containing the LiPD library

\end{description}

\end{fulllineitems}

\index{fetchTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.fetchTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{fetchTs}}}{\emph{lipds=None}}{}
Extract timeseries dictionary

This function is based on the function of the same name in the LiPD utilities.
Set the dictionary as a global variable so that it doesn’t have to be
provided as an argument for every function.
\begin{description}
\item[{Args:}] \leavevmode
lipds (dict): A dictionary of LiPD files obtained through the
readLipd function

\item[{Returns:}] \leavevmode
ts\_list - A list of timeseries object

\end{description}

\end{fulllineitems}



\subsection{Mapping}
\label{\detokenize{Main:mapping}}\index{mapAllArchive() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.mapAllArchive}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{mapAllArchive}}}{\emph{lipds='', markersize=50, background='shadedrelief', figsize={[}10, 4{]}, saveFig=False, dir='', format='eps'}}{}
Map all the available records loaded into the workspace by archiveType.
\begin{description}
\item[{Map of all the records into the workspace by archiveType.}] \leavevmode
Uses the default color palette. Enter pyleoclim.plot\_default for detail.

\item[{Args:}] \leavevmode
lipds (dict): A list of LiPD files. (Optional)
markersize (int): The size of the markers. Default is 50
background (str): Plots one of the following images on the map:
\begin{quote}

bluemarble, etopo, shadedrelief, or none (filled continents).
Default is shadedrelief.
\end{quote}

figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)
saveFig (bool): Default is to not save the figure
dir (str): The absolute path of the directory in which to save the
\begin{quote}

figure. If not provided, creates a default folder called ‘figures’
in the LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{mapLipd() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.mapLipd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{mapLipd}}}{\emph{timeseries='', countries=True, counties=False, rivers=False, states=False, background='shadedrelief', scale=0.5, markersize=50, marker='default', figsize={[}4, 4{]}, saveFig=False, dir='', format='eps'}}{}
Create a Map for a single record

Orthographic projection map of a single record.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a LiPD timeseries object. Will prompt for one if not given
countries (bool): Draws the country borders. Default is on (True).
counties (bool): Draws the USA counties. Default is off (False).
rivers (bool): Draws the rivers. Default is off (False).
states (bool): Draws the American and Australian states borders.
\begin{quote}

Default is off (False)
\end{quote}
\begin{description}
\item[{background (str): Plots one of the following images on the map:}] \leavevmode
bluemarble, etopo, shadedrelief, or none (filled continents).
Default is shadedrelief

\item[{scale (float): useful to downgrade the original image resolution to}] \leavevmode
speed up the process. Default is 0.5.

\end{description}

markersize (int): default is 50
marker (str): a string (or list) containing the color and shape of the
\begin{quote}

marker. Default is by archiveType. Type pyleo.plot\_default to see
the default palette.
\end{quote}

figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{mapNearRecords() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.mapNearRecords}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{mapNearRecords}}}{\emph{timeseries='', lipds='', n=5, radius=None, sameArchive=False, projection='ortho', lat\_0='', lon\_0='', llcrnrlat=-90, urcrnrlat=90, llcrnrlon=-180, urcrnrlon=180, countries=True, counties=False, rivers=False, states=False, background='shadedrelief', scale=0.5, markersize=200, markersize\_adjust=True, marker\_r='ko', marker\_c='default', cmap='Reds', colorbar=True, location='right', label='Distance in km', figsize={[}4, 4{]}, ax=None, saveFig=False, dir='', format='eps'}}{}
Map the nearest records from the record of interest
\begin{description}
\item[{Args:}] \leavevmode
timeseries (dict): A timeseries object. If none given, will prompt for one
lipds (list): A list of LiPD files. (Optional)
n (int): the number of records to match
radius (float): The distance (in km) to search for nearby records.
\begin{quote}

Default is to search the entire globe
\end{quote}
\begin{description}
\item[{sameArchive (bool): Returns only records with the same archiveType.}] \leavevmode
Default is not to do so.

\item[{projection (string): the map projection. Refers to the Basemap}] \leavevmode
documentation for a list of available projections. Only projections
supporting setting the map center with a single lat/lon or with
the coordinates of the rectangle are currently supported.
Default is to use a Robinson projection.

\item[{lat\_0, lon\_0 (float): the center coordinates for the map. Default is}] \leavevmode
mean latitude/longitude in the list.
If the chosen projection doesn’t support it, Basemap will
ignore the given values.

\item[{llcrnrlat, urcrnrlat, llcrnrlon, urcrnrlon (float): The coordinates}] \leavevmode
of the two opposite corners of the rectangle.

\end{description}

countries (bool): Draws the countries border. Defaults is off (False).
counties (bool): Draws the USA counties. Default is off (False).
rivers (bool): Draws the rivers. Default is off (False).
states (bool): Draws the American and Australian states borders.
\begin{quote}

Default is off (False).
\end{quote}
\begin{description}
\item[{background (string): Plots one of the following images on the map:}] \leavevmode
bluemarble, etopo, shadedrelief, or none (filled continents).
Default is none.

\item[{scale (float): Useful to downgrade the original image resolution to}] \leavevmode
speed up the process. Default is 0.5.

\end{description}

markersize (int): the size of the marker
markersize\_adjust (bool): If True, will proportionaly adjust the size of
\begin{quote}

the marker according to distance.
\end{quote}
\begin{description}
\item[{marker\_r (list or str): The color and shape of the marker for the}] \leavevmode
reference record.

\item[{marker\_c (list or str): The color and shape of the marker for the other}] \leavevmode
records. Default is to use the color palette by archiveType. If set
to None then the color of the marker will represent the distance from
the reference records.

\item[{cmap (str): The colormap to use to represent the distance from the}] \leavevmode
reference record if no marker is selected.

\end{description}

colorbar (bool): Create a colorbar. Default is True
location (str): Location of the colorbar
label (str): Label for the colorbar.
figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
ax - The figure

\end{description}

\end{fulllineitems}



\subsection{Plotting}
\label{\detokenize{Main:plotting}}\index{plotTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.plotTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{plotTs}}}{\emph{timeseries='', x\_axis='', markersize=50, marker='default', figsize={[}10, 4{]}, saveFig=False, dir='', format='eps'}}{}
Plot a single time series.
\begin{description}
\item[{Args:}] \leavevmode
A timeseries: By default, will prompt the user for one.
x\_axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.
\end{quote}

markersize (int): default is 50.
marker (str): a string (or list) containing the color and shape of the
\begin{quote}

marker. Default is by archiveType. Type pyleo.plot\_default to see
the default palette.
\end{quote}

figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure.

\end{description}

\end{fulllineitems}

\index{histTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.histTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{histTs}}}{\emph{timeseries='', bins=None, hist=True, kde=True, rug=False, fit=None, hist\_kws=\{'label': 'Histogram'\}, kde\_kws=\{'label': 'KDE fit'\}, rug\_kws=\{'label': 'Rug'\}, fit\_kws=\{'label': 'Fit'\}, color='default', vertical=False, norm\_hist=True, figsize={[}5, 5{]}, saveFig=False, format='eps', dir=''}}{}
Plot a univariate distribution of the PaleoData values

This function is based on the seaborn displot function, which is
itself a combination of the matplotlib hist function with the
seaborn kdeplot() and rugplot() functions. It can also fit
scipy.stats distributions and plot the estimated PDF over the data.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: A timeseries. By default, will prompt the user for one.
bins (int): Specification of hist bins following matplotlib(hist),
\begin{quote}

or None to use Freedman-Diaconis rule
\end{quote}

hist (bool): Whether to plot a (normed) histogram
kde (bool): Whether to plot a gaussian kernel density estimate
rug (bool): Whether to draw a rugplot on the support axis
fit: Random variable object. An object with fit method, returning
\begin{quote}

a tuple that can be passed to a pdf method of positional
arguments following a grid of values to evaluate the pdf on.
\end{quote}
\begin{description}
\item[{\{hist, kde, rug, fit\}\_kws: Dictionaries. Keyword arguments for}] \leavevmode
underlying plotting functions. If modifying the dictionary, make
sure the labels “hist”, “kde”, “rug” and “fit” are still passed.

\item[{color (str): matplotlib color. Color to plot everything but the}] \leavevmode
fitted curve in. Default is to use the default paletter for each
archive type.

\end{description}

vertical (bool): if True, oberved values are on y-axis.
norm\_hist (bool): If True (default), the histrogram height shows
\begin{quote}

a density rather than a count. This is implied if a KDE or
fitted density is plotted
\end{quote}

figsize (list): the size for the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns}] \leavevmode
fig - The figure

\end{description}

\end{fulllineitems}



\subsubsection{Summary Plots}
\label{\detokenize{Main:summary-plots}}
Summary plots are a special categories of plots enabled by Pyleoclim.
They allow to plot specific information about a timeseries but are not customizable.
\index{summaryTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.summaryTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{summaryTs}}}{\emph{timeseries=''}, \emph{x\_axis=''}, \emph{saveFig=False}, \emph{dir=''}, \emph{format='eps'}}{}
Basic summary plot

Plots the following information: the time series, a histogram of
the PaleoData\_values, location map, spectral density using the wwz
method, and metadata about the record.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a timeseries object. By default, will prompt for one
x\_axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.
\end{quote}

saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}



\subsection{Statistics}
\label{\detokenize{Main:statistics}}\index{statsTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.statsTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{statsTs}}}{\emph{timeseries=''}}{}
Calculate simple statistics of a timeseries
\begin{description}
\item[{Args:}] \leavevmode
timeseries: sytem will prompt for one if not given

\item[{Returns:}] \leavevmode
the mean, median, min, max, standard deviation and the
inter-quartile range (IQR) of a timeseries.

\item[{Examples:}] \leavevmode
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{mean}\PYG{p}{,} \PYG{n}{median}\PYG{p}{,} \PYG{n}{min\PYGZus{}}\PYG{p}{,} \PYG{n}{max\PYGZus{}}\PYG{p}{,} \PYG{n}{std}\PYG{p}{,} \PYG{n}{IQR} \PYG{o}{=} \PYG{n}{pyleo}\PYG{o}{.}\PYG{n}{statsTs}\PYG{p}{(}\PYG{n}{timeseries}\PYG{p}{)}
\end{sphinxVerbatim}

\end{description}

\end{fulllineitems}

\index{corrSigTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.corrSigTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{corrSigTs}}}{\emph{timeseries1=''}, \emph{timeseries2=''}, \emph{x\_axis=''}, \emph{interp\_step=''}, \emph{start=''}, \emph{end=''}, \emph{nsim=1000}, \emph{method='isospectral'}, \emph{alpha=0.5}}{}
Estimates the significance of correlations between non IID timeseries.

Function written by. F. Zhu.
\begin{description}
\item[{Args:}] \leavevmode
timeseries1, timeseries2: timeseries object. Default is blank.
x-axis (str): The representation against which to express the
\begin{quote}

paleo-data. Options are “age”, “year”, and “depth”.
Default is to let the system choose if only one available
or prompt the user.
\end{quote}

interp\_step (float): the step size. By default, will prompt the user.
start (float): Start time/age/depth. Default is the maximum of
\begin{quote}

the minima of the two timeseries
\end{quote}
\begin{description}
\item[{end (float): End time/age/depth. Default is the minimum of the}] \leavevmode
maxima of the two timeseries

\end{description}

nsim (int): the number of simulations. Default is 1000
method (str): method use to estimate the correlation and significance.
\begin{quote}
\begin{description}
\item[{Available methods include:}] \leavevmode\begin{itemize}
\item {} 
‘ttest’: T-test where the degrees of freedom are corrected for

\end{itemize}

the effect of serial correlation
\begin{itemize}
\item {} 
‘isopersistant’: AR(1) modeling of the two timeseries

\item {} 
‘isospectral’ (default): phase randomization of original

\end{itemize}

inputs.

\end{description}

The T-test is parametric test, hence cheap but usually wrong
except in idyllic circumstances.
The others are non-parametric, but their computational
requirements scales with nsim.
\end{quote}

alpha (float): significance level for critical value estimation. Default is 0.05

\item[{Returns:}] \leavevmode
r (float) - correlation between the two timeseries

sig (bool) -  Returns True if significant, False otherwise

p (real) - the p-value

\end{description}

\end{fulllineitems}



\subsection{Timeseries}
\label{\detokenize{Main:timeseries}}
Basic manipulations of the timeseries objects.
\index{binTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.binTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{binTs}}}{\emph{timeseries=''}, \emph{x\_axis=''}, \emph{bin\_size=''}, \emph{start=''}, \emph{end=''}}{}
Bin the paleoData values of the timeseries
\begin{description}
\item[{Args:}] \leavevmode
timeseries. By default, will prompt the user for one.
x-axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system  choose if only one available or prompt the user.
\end{quote}
\begin{description}
\item[{bin\_size (float): the size of the bins to be used. By default,}] \leavevmode
will prompt for one

\end{description}

start (float): Start time/age/depth. Default is the minimum
end (float): End time/age/depth. Default is the maximum

\item[{Returns:}] \leavevmode
binned\_values- the binned output,

bins-  the bins (centered on the median, i.e. the 100-200 bin is 150),

n-  number of data points in each bin,

error- the standard error on the mean in each bin

\end{description}

\end{fulllineitems}

\index{interpTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.interpTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{interpTs}}}{\emph{timeseries=''}, \emph{x\_axis=''}, \emph{interp\_step=''}, \emph{start=''}, \emph{end=''}}{}
Simple linear interpolation

Simple linear interpolation of the data using the numpy.interp method
\begin{description}
\item[{Args:}] \leavevmode
timeseries. Default is blank, will prompt for it
x-axis (str): The representation against which to plot the paleo-data.
\begin{quote}

Options are “age”, “year”, and “depth”. Default is to let the
system choose if only one available or prompt the user.
\end{quote}

interp\_step (float): the step size. By default, will prompt the user.
start (float): Start year/age/depth. Default is the minimum
end (float): End year/age/depth. Default is the maximum

\item[{Returns:}] \leavevmode
interp\_age - the interpolated age/year/depth according to the end/start
and time step,

interp\_values - the interpolated values

\end{description}

\end{fulllineitems}

\index{standardizeTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.standardizeTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{standardizeTs}}}{\emph{timeseries=''}, \emph{scale=1}, \emph{ddof=0}, \emph{eps=0.001}}{}
Centers and normalizes the paleoData values of a  given time series.

Constant or nearly constant time series not rescaled.
\begin{description}
\item[{Args:}] \leavevmode
x (array): vector of (real) numbers as a time series, NaNs allowed
scale (real): a scale factor used to scale a record to a match a given variance
axis (int or None): axis along which to operate, if None, compute over the whole array
ddof (int): degress of freedom correction in the calculation of the standard deviation
eps (real): a threshold to determine if the standard deviation is too close to zero

\item[{Returns:}] \leavevmode\begin{itemize}
\item {} 
z (array): the standardized time series (z-score), Z = (X - E{[}X{]})/std(X)*scale, NaNs allowed

\item {} 
mu (real): the mean of the original time series, E{[}X{]}

\item {} 
sig (real): the standard deviation of the original time series, std{[}X{]}

\end{itemize}

\item[{References:}] \leavevmode\begin{enumerate}
\item {} 
Tapio Schneider’s MATLAB code: \sphinxurl{http://www.clidyn.ethz.ch/imputation/standardize.m}

\item {} 
The zscore function in SciPy: \sphinxurl{https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py}

\end{enumerate}

\end{description}

@author: fzhu

\end{fulllineitems}

\index{segmentTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.segmentTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{segmentTs}}}{\emph{timeseries=''}, \emph{factor=2}}{}
Divides a time series into several segments using a gap detection algorithm

Gap detection rule: If the time interval between some two data points is
larger than some factor times the mean resolution of the timeseries, then
a brak point is applied and the timseries is divided.
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a LiPD timeseries object
factor (float): factor to adjust the threshold. threshold = factor*dt\_mean.
\begin{quote}

Default is 2.
\end{quote}

\item[{Returns:}] \leavevmode
seg\_y (list) - a list of several segments with potentially different length
seg\_t (list) - A list of the time values for each y segment.
n\_segs (int) - the number of segments

\end{description}

\end{fulllineitems}



\subsection{Analysis in the frequency domain}
\label{\detokenize{Main:analysis-in-the-frequency-domain}}\index{wwzTs() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.wwzTs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{wwzTs}}}{\emph{timeseries=''}, \emph{lim=None}, \emph{wwz=False}, \emph{psd=True}, \emph{wwz\_default=True}, \emph{psd\_default=True}, \emph{wwaplot\_default=True}, \emph{psdplot\_default=True}, \emph{fig=True}, \emph{saveFig=False}, \emph{dir=''}, \emph{format='eps'}}{}
Weigthed wavelet Z-transform analysis

Wavelet analysis for unevenly spaced data adapted from Foster et al. (1996)
\begin{description}
\item[{Args:}] \leavevmode
timeseries (dict): A LiPD timeseries object (Optional, will prompt for one.)
lim (list): Truncate the timeseries between min/max time (e.g., {[}0,10000{]})
wwz (bool): If True, will perform wavelet analysis
psd (bool): If True, will inform the power spectral density of the timeseries
wwz\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{wwz\_default = \{‘tau’:None,}] \leavevmode
‘freqs’:None,
‘c’:1/(8*np.pi**2),
‘Neff’:3,
‘Neff\_coi’:3,
‘nMC’:200,
‘nproc’:8,
‘detrend’:’no’,
‘params’ : {[}“default”,4,0,1{]},
‘gaussianize’: False,
‘standardize’:True,
‘method’:’Kirchner\_f2py’,
‘bc\_mode’:’reflect’,
‘reflect\_type’:’odd’,
‘len\_bd’:0\}

\end{description}

Modify the values for specific keys to change the default behavior.
\end{quote}

psd\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{psd\_default = \{‘tau’:None,}] \leavevmode
‘freqs’: None,
‘c’:1e-3,
‘nproc’:8,
‘nMC’:200,
‘detrend’:’no’,
‘params’ : {[}“default”,4,0,1{]},
‘gaussianize’: False,
‘standardize’:True,
‘Neff’:3,
‘anti\_alias’:False,
‘avgs’:1,
‘method’:’Kirchner\_f2py’,
\}

\end{description}

Modify the values for specific keys to change the default behavior.
\end{quote}

wwaplot\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{wwaplot\_default=\{‘AR1\_q’:AR1\_q,}] \leavevmode
‘coi’:coi,
‘levels’:None,
‘tick\_range’:None,
‘yticks’:None,
‘yticks\_label’: None,
‘ylim’:None,
‘xticks’:None,
‘xlabels’:None,
‘figsize’:{[}20,8{]},
‘clr\_map’:’OrRd’,
‘cbar\_drawedges’:False,
‘cone\_alpha’:0.5,
‘plot\_signif’:True,
‘signif\_style’:’contour’,
‘plot\_cone’:True,
‘title’:None,
‘ax’:None,
‘xlabel’: label.upper(){[}0{]}+label{[}1:{]}+’(‘+s+’)’,
‘ylabel’: ‘Period (‘+ageunits+’)’,
‘cbar\_orientation’:’vertical’,
‘cbar\_pad’:0.05,
‘cbar\_frac’:0.15,
‘cbar\_labelsize’:None\}

\end{description}

Modify the values for specific keys to change the default behavior.
\end{quote}

psdplot\_default: If True, will use the following default parameters:
\begin{quote}
\begin{description}
\item[{psdplot\_default=\{‘lmstyle’:’-‘,}] \leavevmode
‘linewidth’:None,
‘color’: sns.xkcd\_rgb{[}“denim blue”{]},
‘ar1\_lmstyle’:’-‘,
‘ar1\_linewidth’:1,
‘period\_ticks’:None,
‘period\_tickslabel’:None,
‘psd\_lim’:None,
‘period\_lim’:None,
‘figsize’:{[}20,8{]},
‘label’:’PSD’,
‘plot\_ar1’:True,
‘psd\_ar1\_q95’:psd\_ar1\_q95,
‘title’: None,
‘psd\_ar1\_color’:sns.xkcd\_rgb{[}“pale red”{]},
‘ax’:None,
‘vertical’:False,
‘plot\_gridlines’:True,
‘period\_label’:’Period (‘+ageunits+’)’,
‘psd\_label’:’Spectral Density’,
‘zorder’ : None\}

\end{description}

Modify the values for specific keys to change the default behavior.
\end{quote}

fig (bool): If True, plots the figure
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
dict\_out (dict): A dictionary of outputs.
\begin{quote}

For wwz:
\begin{itemize}
\item {} 
wwa (array): The weights wavelet amplitude

\item {} 
AR1\_q (array): AR1 simulations

\item {} 
coi (array): cone of influence

\item {} 
freqs (array): vector for frequencies

\item {} 
tau (array): the evenly-spaced time points, namely the time

\end{itemize}

shift for wavelet analysis.
\begin{itemize}
\item {} 
Neffs (array): The matrix of effective number of points in the

\end{itemize}

time-scale coordinates.
\begin{itemize}
\item {} 
coeff (array): The wavelet transform coefficients

\end{itemize}

For psd:
\begin{itemize}
\item {} 
psd (array): power spectral density

\item {} 
freqs (array): vector of frequency

\item {} 
psd\_ar1\_q95 (array): the 95\% quantile of the psds of AR1 processes

\end{itemize}
\end{quote}

fig: The figure
\begin{description}
\item[{References:}] \leavevmode
Foster, G. (1996). Wavelets for period analysis of unevenly
sampled time series. The Astronomical Journal, 112(4), 1709-1729.

\item[{Examples:}] \leavevmode
To run both wwz and psd:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dict\PYGZus{}out}\PYG{p}{,} \PYG{n}{fig} \PYG{o}{=} \PYG{n}{pyleoclim}\PYG{o}{.}\PYG{n}{wwzTs}\PYG{p}{(}\PYG{n}{wwz}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

Note: This will return a single figure with wwa and psd

To change a default behavior:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dict\PYGZus{}out}\PYG{p}{,} \PYG{n}{fig} \PYG{o}{=} \PYG{n}{pyleoclim}\PYG{o}{.}\PYG{n}{wwzTs}\PYG{p}{(}\PYG{n}{psd\PYGZus{}default} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nMC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+m+mi}{1000}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{description}

\end{description}

\end{fulllineitems}



\subsection{Age modelling}
\label{\detokenize{Main:age-modelling}}\index{Bchron() (in module pyleoclim)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Main:pyleoclim.Bchron}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.}}\sphinxbfcode{\sphinxupquote{Bchron}}}{\emph{lipd, modelNum=None, objectName=None, rejectAges=None, calCurves=None, reservoirAgeCorr=None, predictPositions='paleo', positionsThickness=None, outlierProbs=None, iterations=1000, burn=2000, thin=8, extractDate=-68, maxExtrap=500, thetaMhSd=0.5, muMhSd=0.1, psiMhSd=0.1, ageScaleVal=1000, positionScaleVal=100, saveLipd=True, plot=True, figsize={[}4, 8{]}, flipCoor=False, xlabel=None, ylabel=None, xlim=None, ylim=None, violinColor='\#8B008B', medianLineColor='black', medianLineWidth=2.0, CIFillColor='Silver', samplePaths=True, samplePathNumber=10, alpha=0.5, saveFig=False, dir='', format='eps'}}{}
Runs Bchron and plot if asked

Fits a non-parametric chronology model to age/position data according to
the Compound Poisson-Gamma model defined by Haslett and Parnell (2008).
This version used a slightly modified Markov chain Monte-Carlo fitting
algorithm which aims to converge quicker and requires fewer iterations.
It also a slightly modified procedure for identifying outliers.

The Bchronology functions fits a compounf Poisson-Gamma distribution to the
incrememnts between the dated levels. This involves a stochastic linear
interpolation step where the age gaps are Gamma distributed, and the position
gaps are Exponential. Radiocarbon and non-radiocarbon dates (including outliers)
are updated within the fucntion also by MCMC.

This function also allows to save the ensemble, distributions, and probability
tables as well as the parameters with which the model was run into the LiPD file.

Finally allows to make a plot.
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{lipd (dict): A dictionary containing the entry of a LiPD file. Can be}] \leavevmode
obtained from lipd.readLipd() or pyleoclim.openLipd(). Please note
that the Bchron function currently only allows for a single LiPD file
(i.e., not the entire directory).

\item[{modelNum (int): The model number in which to place the Bchron output.}] \leavevmode
If unknown, the function will try to make a guess and/or prompt
based on the number of already available models.

\item[{objectName (str): The name of the chron object in which to store the new}] \leavevmode
model (e.g. “chron0”)

\item[{rejectAges (vector): A vector of 1/0 where 1 include the dates to be rejected.}] \leavevmode
Default it None.

\item[{calCurves (list): (Optional) A vector of values containing either ‘intcal13’,}] \leavevmode
‘marine13’, ‘shcal13’, or ‘normal’. If none is provided, will
prompt the user. Should be either of length =1 if using the same
calibration for each age or the same length as the vector of ages.

\item[{reservoirAgeCorr (array): (Optional) A list (matrix) of two floats that correspond to the}] \leavevmode
DeltaR and DeltaR uncertainty. If already added to the ages and
ages standard deviation, then enter {[}0,0{]} to bypass the prompt.
Will only be applied if CalCurves is set to ‘marine13’. Otherwise,
leave to none.

\item[{predictPositions (array): (Optional) a vector of positions}] \leavevmode
(e.g. depths) at which predicted age values are required.
Defaults to a sequence of length 100 from the top position to the
bottom position.

\item[{positionsThickness (array): (Optional) Thickness values for each of the positions.}] \leavevmode
The thickness values should be the full thickness value of the
slice. By default set to zero.

\item[{outlierProbs (array): (Optional) A vector of prior outlier probabilities,}] \leavevmode
one for each age. Defaults to 0.01

\item[{iterations (int): (Optional) The number of iterations to start the procedure.}] \leavevmode
Default and minimum should be 10000.

\item[{burn (int): (Optional) The number of starting iterations to discard.}] \leavevmode
Default is 200

\item[{thin (int): (Optional) The step size for every iteration to keep beyond}] \leavevmode
the burnin. Default is 8.

\item[{extractDate (float): (Optional) The top age of the core. Used for}] \leavevmode
extrapolation purposes so that no extrapolated ages go beyond the
top age of the core. Defaults to the current year.

\item[{maxExtrap (int): (Optional) The maximum number of extrapolations to}] \leavevmode
perform before giving up and setting the predicted ages to NA.
Useful for when large amounts of extrapolation are required, i.e.
some of the predictPositions are a long way from the dated
positions. Defaults to 500.

\item[{thetaMhSd (float):  (Optional)  The Metropolis-Hastings standard}] \leavevmode
deviation for the age parameters. Defaults to 0.5.

\item[{muMhSd (float): (Optional)  The Metropolis-Hastings standard deviation}] \leavevmode
for the compound Poisson-Gamma Scale. Defaults to 0.1

\item[{psiMhSd (float): (Optional) The Metropolis-Hastings standard deviation}] \leavevmode
for the Compound Poisson-Gamma Scale.

\item[{ageScaleVal (int): (Optional) A scale value for the ages.}] \leavevmode
Bchronology works best when the ages are scaled to be
approximately between 0 and 100.
The default value is thus 1000 for ages given in years.

\item[{positionScaleVal (int):  (Optional) A scale value for the positions.}] \leavevmode
Bchronology works best when the positions are scaled to be
approximately between 0 and 100. The default value is thus
100 for positions given in cm.

\item[{saveLipd (bool): If True, saves the ensemble, distribution, and probability}] \leavevmode
tables along with the parameters used to run the model in the LiPD
file.

\end{description}

plot (bool): If True, makes a plot for the chronology
figsize (list): The figure size. Default is {[}4,8{]}
flipCoor (bool): If True, plots depth on the y-axis.
xlabel (str): The label for the x-axis
ylabel (str): The label for the y-axis
xlim (list): Limits for the x-axis. Default corresponds to the min/max
\begin{quote}

of the depth vector.
\end{quote}

ylim (list): Limits for the y-axis. Default set by matplotlib
violinColor (str): The color for the violins. Default is purple
medianLineColor (str): The color for the median line. Default is black.
medianLineWidth (float): The width for the median line
CIFillColor (str): Fill color in between the 95\% confidence interval.
\begin{quote}

Default is silver.
\end{quote}
\begin{description}
\item[{samplePaths (bool): If True, draws sample paths from the distribution.}] \leavevmode
Use the same color as the violins.

\item[{samplePathNumber (int): The number of sample paths to draw. Default is 10.}] \leavevmode
Note: samplePaths need to be set to True.

\end{description}

alpha (float): The violins’ transparency. Number between 0 and 1
saveFig (bool): default is to not save the figure
dir (str): the full path of the directory in which to save the figure.
\begin{quote}

If not provided, creates a default folder called ‘figures’ in the
LiPD working directory (lipd.path).
\end{quote}
\begin{description}
\item[{format (str): One of the file extensions supported by the active}] \leavevmode
backend. Default is “eps”. Most backend support png, pdf, ps, eps,
and svg.

\end{description}

\item[{Returns:}] \leavevmode
depth - the predicted positions (either same as the user or the default)
\begin{description}
\item[{chron -  a numpy array of possible chronologies in each column.}] \leavevmode
The number of rows is the same as the length of depth

\end{description}

ageDist - the distribution of ages around each dates.
fig - the figure
run - the full R object containing the outputs of the Bchron run

\item[{Warnings:}] \leavevmode\begin{description}
\item[{This function requires R and the Bchron package and all its}] \leavevmode
dependencies to be installed on the same machine.

\end{description}

\item[{Reference:}] \leavevmode\begin{itemize}
\item {} \begin{description}
\item[{Haslett, J., and Parnell, A. C. (2008). A simple monotone}] \leavevmode
process with application to radiocarbon-dated depth
chronologies. Journal of the Royal Statistical Society,
Series C, 57, 399-418. DOI:10.1111/j.1467-9876.2008.00623.x

\end{description}

\item {} \begin{description}
\item[{Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E.,}] \leavevmode
and Huntley, B. (2008). A flexible approach to assessing
synchroneity of past events using Bayesian reconstructions
of sedimentation history. Quaternary Science Reviews,
27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009

\end{description}

\end{itemize}

\end{description}

\end{fulllineitems}



\section{Using Pyleoclim without a LiPD file}
\label{\detokenize{Main:using-pyleoclim-without-a-lipd-file}}
The Pyleoclim modules can be called separately so the main functions can be used without a timeseries objects.
The following modules are available:
\begin{itemize}
\item {} 
pyleoclim.Map: mapping functions

\item {} 
pyleoclim.Plot: plotting functions

\item {} 
pyleoclim.Stats: statistics (including correlation)

\item {} 
pyleoclim.Timeseries: binning, interpolating

\item {} 
pyleoclim.Spectral: analysis in the frequency domain

\item {} 
pyleoclim.RBchron: Bchron age model analysis

\end{itemize}

In addition, the pyleoclim.LipdUtils module allows the basic manipulation of LiPD files and the pyleoclim.SummaryPlots module
contains some functions to extract information about a timeseries object.


\chapter{Mapping Functions}
\label{\detokenize{Map:mapping-functions}}\label{\detokenize{Map::doc}}
This module uses the Basemap package for mapping.
\index{mapAll() (in module pyleoclim.Map)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Map:pyleoclim.Map.mapAll}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Map.}}\sphinxbfcode{\sphinxupquote{mapAll}}}{\emph{lat, lon, criteria, projection='robin', lat\_0='', lon\_0='', llcrnrlat=-90, urcrnrlat=90, llcrnrlon=-180, urcrnrlon=180, countries=False, counties=False, rivers=False, states=False, figsize={[}10, 4{]}, ax=None, background='none', scale=0.5, palette='', markersize=50}}{}
Map the location of all lat/lon according to some criteria

Map the location of all lat/lon according to some criteria. The choice of 
plotting color/marker is passed through palette according to unique 
criteria (e.g., record name, archive type, proxy observation type).
\begin{description}
\item[{Args:}] \leavevmode
lat (list): a list of latitude.
lon (list): a list of longitude.
criteria (list): a list of criteria for plotting purposes. For instance,
\begin{quote}

a map by the types of archive present in the dataset or proxy
observations.
\end{quote}
\begin{description}
\item[{projection (string): the map projection. Refers to the Basemap}] \leavevmode
documentation for a list of available projections. Only projections
supporting setting the map center with a single lat/lon or with
the coordinates of the rectangle are currently supported. 
Default is to use a Robinson projection.

\item[{lat\_0, lon\_0 (float): the center coordinates for the map. Default is}] \leavevmode
mean latitude/longitude in the list. 
If the chosen projection doesn’t support it, Basemap will
ignore the given values.

\item[{llcrnrlat, urcrnrlat, llcrnrlon, urcrnrlon (float): The coordinates}] \leavevmode
of the two opposite corners of the rectangle.

\end{description}

countries (bool): Draws the countries border. Defaults is off (False). 
counties (bool): Draws the USA counties. Default is off (False).
rivers (bool): Draws the rivers. Default is off (False).
states (bool): Draws the American and Australian states borders.
\begin{quote}

Default is off (False).
\end{quote}
\begin{description}
\item[{background (string): Plots one of the following images on the map: }] \leavevmode
bluemarble, etopo, shadedrelief, or none (filled continents). 
Default is none.

\item[{scale (float): Useful to downgrade the original image resolution to}] \leavevmode
speed up the process. Default is 0.5.

\item[{palette (dict): A dictionary of plotting color/marker by criteria. The}] \leavevmode
keys should correspond to \sphinxstylestrong{*unique*} criteria with a list of 
associated values. The list should be in the format 
{[}‘color’, ‘marker’{]}.

\end{description}

markersize (int): The size of the marker.
figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\item[{Returns:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{mapOne() (in module pyleoclim.Map)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Map:pyleoclim.Map.mapOne}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Map.}}\sphinxbfcode{\sphinxupquote{mapOne}}}{\emph{lat, lon, projection='ortho', lat\_0='', lon\_0='', llcrnrlat=-90, urcrnrlat=90, llcrnrlon=-180, urcrnrlon=180, countries=True, counties=False, rivers=False, states=False, background='shadedrelief', scale=0.5, markersize=50, marker='ro', figsize={[}4, 4{]}, ax=None}}{}
Map one location on the globe
\begin{description}
\item[{Args:}] \leavevmode
lat (float): a float number representing latitude
lon (float): a float number representing longitude
projection (string): the map projection. Refers to the Basemap
\begin{quote}

documentation for a list of available projections. Only projections
supporting setting the map center with a single lat/lon or with
the coordinates of the rectangle are currently supported. 
Default is to use a Robinson projection.
\end{quote}
\begin{description}
\item[{lat\_0, lon\_0 (float): the center coordinates for the map. Default is}] \leavevmode
mean latitude/longitude in the list. 
If the chosen projection doesn’t support it, Basemap will
ignore the given values.

\item[{llcrnrlat, urcrnrlat, llcrnrlon, urcrnrlon (float): The coordinates}] \leavevmode
of the two opposite corners of the rectangle.

\end{description}

countries (bool): Draws the countries border. Defaults is off (False). 
counties (bool): Draws the USA counties. Default is off (False).
rivers (bool): Draws the rivers. Default is off (False).
states (bool): Draws the American and Australian states borders.
\begin{quote}

Default is off (False).
\end{quote}
\begin{description}
\item[{background (string): Plots one of the following images on the map: }] \leavevmode
bluemarble, etopo, shadedrelief, or none (filled continents). 
Default is none.

\item[{scale (float): Useful to downgrade the original image resolution to}] \leavevmode
speed up the process. Default is 0.5.

\end{description}

markersize (int): The size of the marker.
marker (str or list): color and type of marker. 
figsize (list): the size for the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\end{description}

\end{fulllineitems}



\chapter{Plotting Functions}
\label{\detokenize{Plot:plotting-functions}}\label{\detokenize{Plot::doc}}\index{plot() (in module pyleoclim.Plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Plot:pyleoclim.Plot.plot}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Plot.}}\sphinxbfcode{\sphinxupquote{plot}}}{\emph{x, y, markersize=50, marker='ro', x\_label='', y\_label='', title='', figsize={[}10, 4{]}, ax=None}}{}
Make a 2-D plot
\begin{description}
\item[{Args:}] \leavevmode
x (numpy array): a 1xn numpy array of values for the x-axis
y (numpy array): a 1xn numpy array for the y-axis
markersize (int): the size of the marker
marker (string or list): color and shape of the marker
x\_axis\_label (str): the label for the x-axis
y\_axis\_label (str): the label for the y-axis
title (str): the title for the plot
figsize (list): the size of the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\item[{Return:}] \leavevmode
The figure

\end{description}

\end{fulllineitems}

\index{plot\_hist() (in module pyleoclim.Plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Plot:pyleoclim.Plot.plot_hist}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Plot.}}\sphinxbfcode{\sphinxupquote{plot\_hist}}}{\emph{y, bins=None, hist=True, label='', kde=True, rug=False, fit=None, hist\_kws=\{'label': 'Histogram'\}, kde\_kws=\{'label': 'KDE fit'\}, rug\_kws=\{'label': 'rug'\}, fit\_kws=\{'label': 'fit'\}, color='0.7', vertical=False, norm\_hist=True, figsize={[}5, 5{]}, ax=None}}{}
Plot a univariate distribution of the PaleoData values

This function is based on the seaborn displot function, which is
itself a combination of the matplotlib hist function with the 
seaborn kdeplot() and rugplot() functions. It can also fit 
scipy.stats distributions and plot the estimated PDF over the data.
\begin{description}
\item[{Args:}] \leavevmode
y (array): nx1 numpy array. No missing values allowed 
bins (int): Specification of hist bins following matplotlib(hist),
\begin{quote}

or None to use Freedman-Diaconis rule
\end{quote}

hist (bool): Whether to plot a (normed) histogram 
label (str): The label for the axis
kde (bool): Whether to plot a gaussian kernel density estimate
rug (bool): Whether to draw a rugplot on the support axis
fit: Random variable object. An object with fit method, returning
\begin{quote}

a tuple that can be passed to a pdf method of positional 
arguments following a grid of values to evaluate the pdf on.
\end{quote}
\begin{description}
\item[{\{hist, kde, rug, fit\}\_kws: Dictionaries. Keyword arguments for }] \leavevmode
underlying plotting functions. If modifying the dictionary, make
sure the labels “hist”, “kde”, “rug” and “fit” are still passed.

\item[{color (str): matplotlib color. Color to plot everything but the}] \leavevmode
fitted curve in.

\end{description}

vertical (bool): if True, oberved values are on y-axis.
norm\_hist (bool): If True (default), the histrogram height shows
\begin{quote}

a density rather than a count. This is implied if a KDE or 
fitted density is plotted
\end{quote}

figsize (list): the size of the figure
ax: Return as axis instead of figure (useful to integrate plot into a subplot)

\item[{Returns}] \leavevmode
fig - The figure

\end{description}

\end{fulllineitems}



\chapter{Statistics Functions}
\label{\detokenize{Stats:statistics-functions}}\label{\detokenize{Stats::doc}}\index{simpleStats() (in module pyleoclim.Stats)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Stats:pyleoclim.Stats.simpleStats}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Stats.}}\sphinxbfcode{\sphinxupquote{simpleStats}}}{\emph{y}, \emph{axis=None}}{}
Computes simple statistics

Computes the mean, median, min, max, standard deviation, and interquartile
range of a numpy array y.
\begin{description}
\item[{Args:}] \leavevmode
y (array): A Numpy array
axis (int, typle of ints): Optional. Axis or Axes along which the means
\begin{quote}

are computed, the default is to compute the mean of the flattened
array. If a tuple of ints, performed over multiple axes
\end{quote}

\item[{Returns:}] \leavevmode
The mean, median, min, max, standard deviation and IQR by columns

\end{description}

\end{fulllineitems}

\index{corrsig() (in module pyleoclim.Stats)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Stats:pyleoclim.Stats.corrsig}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Stats.}}\sphinxbfcode{\sphinxupquote{corrsig}}}{\emph{y1}, \emph{y2}, \emph{nsim=1000}, \emph{method='isospectral'}, \emph{alpha=0.5}}{}~\begin{description}
\item[{Estimates the significance of correlations between non IID time series by 3 independent methods:}] \leavevmode\begin{enumerate}
\item {} 
‘ttest’: T-test where d.o.f are corrected for the effect of serial correlation

\item {} 
‘isopersistent’: AR(1) modeling of x and y.

\end{enumerate}

3) ‘isospectral’: phase randomization of original inputs. (default)
The T-test is parametric test, hence cheap but usually wrong except in idyllic circumstances.
The others are non-parametric, but their computational requirements scales with nsim.

\item[{Args:}] \leavevmode
y1, y2 (array)- vector of (real) numbers of identical length, no NaNs allowed
nsim (int)- the number of simulations {[}1000{]}
method (str)- methods 1-3 above {[}‘isospectral’{]}
alpha (float)- significance level for critical value estimation {[}0.05{]}

\item[{Returns:}] \leavevmode
r (real): correlation between x and y

signif (int): true  if significant; false otherwise

p (real): Fraction of time series with higher correlation coefficents than observed (approximates the p-value).
\begin{quote}

Note that signif = True if and only if p \textless{}= alpha.
\end{quote}

\end{description}

\end{fulllineitems}



\chapter{Timeseries Functions}
\label{\detokenize{Timeseries:timeseries-functions}}\label{\detokenize{Timeseries::doc}}
This module allows the manipulation of timeseries.
\index{bin() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.bin}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{bin}}}{\emph{x}, \emph{y}, \emph{bin\_size=''}, \emph{start=''}, \emph{end=''}}{}
Bin the values
\begin{description}
\item[{Args:}] \leavevmode
x (array): the x-axis series.
y (array): the y-axis series.
bin\_size (float): The size of the bins. Default is the average resolution
start (float): Where/when to start binning. Default is the minimum
end (float): When/where to stop binning. Defulat is the maximum

\item[{Returns:}] \leavevmode
binned\_values - the binned output

bins - the bins (centered on the median, i.e., the 100-200 bin is 150)

n - number of data points in each bin

error -  the standard error on the mean in each bin

\end{description}

\end{fulllineitems}

\index{interp() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.interp}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{interp}}}{\emph{x}, \emph{y}, \emph{interp\_step=''}, \emph{start=''}, \emph{end=''}}{}
Linear interpolation onto a new x-axis
\begin{description}
\item[{Args:}] \leavevmode
x (array): the x-axis
y (array): the y-axis
interp\_step (float): the interpolation step. Default is mean resolution.
start (float): where/when to start the interpolation. Default is min..
end (float): where/when to stop the interpolation. Default is max.

\item[{Returns:}] \leavevmode
xi - the interpolated x-axis

interp\_values - the interpolated values

\end{description}

\end{fulllineitems}

\index{onCommonAxis() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.onCommonAxis}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{onCommonAxis}}}{\emph{x1}, \emph{y1}, \emph{x2}, \emph{y2}, \emph{interp\_step=''}, \emph{start=''}, \emph{end=''}}{}
Places two timeseries on a common axis
\begin{description}
\item[{Args:}] \leavevmode
x1 (array): x-axis values of the first timeseries
y1 (array): y-axis values of the first timeseries
x2 (array): x-axis values of the second timeseries
y2 (array): y-axis values of the second timeseries
interp\_step (float): The interpolation step. Default is mean resolution
of lowest resolution series
start (float): where/when to start. Default is the maximum of the minima of
the two timeseries
end (float): Where/when to end. Default is the minimum of the maxima of
the two timeseries

\item[{Returns:}] \leavevmode
xi -  the interpolated x-axis

interp\_values1 -  the interpolated y-values for the first timeseries
interp\_values2 - the intespolated y-values for the second timeseries

\end{description}

\end{fulllineitems}

\index{standardize() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.standardize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{standardize}}}{\emph{x}, \emph{scale=1}, \emph{axis=0}, \emph{ddof=0}, \emph{eps=0.001}}{}
Centers and normalizes a given time series. Constant or nearly constant time series not rescaled.
\begin{description}
\item[{Args:}] \leavevmode
x (array): vector of (real) numbers as a time series, NaNs allowed
scale (real): a scale factor used to scale a record to a match a given variance
axis (int or None): axis along which to operate, if None, compute over the whole array
ddof (int): degress of freedom correction in the calculation of the standard deviation
eps (real): a threshold to determine if the standard deviation is too close to zero

\item[{Returns:}] \leavevmode
z (array): the standardized time series (z-score), Z = (X - E{[}X{]})/std(X)*scale, NaNs allowed
mu (real): the mean of the original time series, E{[}X{]}
sig (real): the standard deviation of the original time series, std{[}X{]}

\item[{References:}] \leavevmode\begin{enumerate}
\item {} 
Tapio Schneider’s MATLAB code: \sphinxurl{http://www.clidyn.ethz.ch/imputation/standardize.m}

\item {} 
The zscore function in SciPy: \sphinxurl{https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py}

\end{enumerate}

\end{description}

@author: fzhu

\end{fulllineitems}

\index{ts2segments() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.ts2segments}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{ts2segments}}}{\emph{ys}, \emph{ts}, \emph{factor=10}}{}
Chop a time series into several segments based on gap detection.
\begin{description}
\item[{The rule of gap detection is very simple:}] \leavevmode
we define the intervals between time points as dts, then if dts{[}i{]} is larger than factor * dts{[}i-1{]},
we think that the change of dts (or the gradient) is too large, and we regard it as a breaking point
and chop the time series into two segments here

\item[{Args:}] \leavevmode
ys (array): a time series, NaNs allowed
ts (array): the time points
factor (float): the factor that adjusts the threshold for gap detection

\item[{Returns:}] \leavevmode
seg\_ys (list): a list of several segments with potentially different lengths
seg\_ts (list): a list of the time axis of the several segments
n\_segs (int): the number of segments

\end{description}

@author: fzhu

\end{fulllineitems}

\index{clean\_ts() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.clean_ts}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{clean\_ts}}}{\emph{ys}, \emph{ts}}{}
Delete the NaNs in the time series and sort it with time axis ascending
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs allowed
ts (array): the time axis of the time series, NaNs allowed

\item[{Returns:}] \leavevmode
ys (array): the time series without nans
ts (array): the time axis of the time series without nans

\end{description}

\end{fulllineitems}

\index{annualize() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.annualize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{annualize}}}{\emph{ys}, \emph{ts}}{}
Annualize a time series whose time resolution is finer than 1 year
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs allowed
ts (array): the time axis of the time series, NaNs allowed

\item[{Returns:}] \leavevmode
ys\_ann (array): the annualized time series
year\_int (array): the time axis of the annualized time series

\end{description}

\end{fulllineitems}

\index{gaussianize() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.gaussianize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{gaussianize}}}{\emph{X}}{}
Transforms a (proxy) timeseries to Gaussian distribution.

Originator: Michael Erb, Univ. of Southern California - April 2017

\end{fulllineitems}

\index{gaussianize\_single() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.gaussianize_single}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{gaussianize\_single}}}{\emph{X\_single}}{}
Transforms a single (proxy) timeseries to Gaussian distribution.

Originator: Michael Erb, Univ. of Southern California - April 2017

\end{fulllineitems}

\index{detrend() (in module pyleoclim.Timeseries)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Timeseries:pyleoclim.Timeseries.detrend}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Timeseries.}}\sphinxbfcode{\sphinxupquote{detrend}}}{\emph{y, x=None, method='linear', params={[}'default', 4, 0, 1{]}}}{}
Detrend a timeseries according to three methods
\begin{description}
\item[{Detrending methods include, “linear” (default), “constant”, and using a low-pass}] \leavevmode
Savitzky-Golay filters.

\item[{Args:}] \leavevmode
y (array): The series to be detrended.
x (array): The time axis for the timeseries. Necessary for use with
\begin{quote}

the Savitzky-Golay filters method since the series should be evenly spaced.
\end{quote}
\begin{description}
\item[{method (str): The type of detrending. If linear (default), the result of}] \leavevmode
a linear least-squares fit to y is subtracted from y. If constant,
only the mean of data is subtrated. If “savitzy-golay”, y is filtered
using the Savitzky-Golay filters and the resulting filtered series
is subtracted from y.

\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

\item[{Returns:}] \leavevmode
ys (array) - the detrended timeseries.

\end{description}

\end{fulllineitems}



\chapter{Summary Plots}
\label{\detokenize{SummaryPlots:summary-plots}}\label{\detokenize{SummaryPlots::doc}}
This module handles some basic return for the summary plots.

\sphinxstylestrong{Requires} a LiPD file
\index{getMetadata() (in module pyleoclim.SummaryPlots)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{SummaryPlots:pyleoclim.SummaryPlots.getMetadata}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.SummaryPlots.}}\sphinxbfcode{\sphinxupquote{getMetadata}}}{\emph{timeseries}}{}
Get the necessary metadata to be printed out automatically
\begin{description}
\item[{Args:}] \leavevmode
timeseries: a specific timeseries object.

\item[{Returns:}] \leavevmode
A dictionary containing the following metadata:

archiveType

Authors (if more than 2, replace by et al.

PublicationYear

Publication DOI

Variable Name

Units

Climate Interpretation

Calibration Equation

Calibration References

Calibration Notes

\end{description}

\end{fulllineitems}

\index{TsData() (in module pyleoclim.SummaryPlots)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{SummaryPlots:pyleoclim.SummaryPlots.TsData}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.SummaryPlots.}}\sphinxbfcode{\sphinxupquote{TsData}}}{\emph{timeseries}, \emph{x\_axis=''}}{}
Get the PaleoData with age/depth information

Get the necessary information for the TS plots/necessary to allow for
axes specification
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{timeseries: a single timeseries object. }] \leavevmode
By default, will prompt the user

\item[{x-axis (str): The representation against which to plot the }] \leavevmode
paleo-data. Options are “age”, “year”, and “depth”. 
Default is to let the system choose if only one available 
or prompt the user.

\end{description}

\item[{Returns:}] \leavevmode
x - the x-valus

y - the y-values

archiveType - the archiveType (for plot settings)

x\_label - the label for the x-axis

y\_label - the label for the y-axis

label - the results of the x-axis query. Either depth, year, or age

\end{description}

\end{fulllineitems}

\index{agemodelData() (in module pyleoclim.SummaryPlots)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{SummaryPlots:pyleoclim.SummaryPlots.agemodelData}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.SummaryPlots.}}\sphinxbfcode{\sphinxupquote{agemodelData}}}{\emph{timeseries}}{}
Get the necessary information for the agemodel plot
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{timeseries: a single timeseries object. By default, will}] \leavevmode
prompt the user

\end{description}

\item[{Returns:}] \leavevmode
depth - the depth values

age - the age values

x\_label - the label for the x-axis

y\_label - the label for the y-axis

archiveType - the archiveType (for default plot settings)

\end{description}

\end{fulllineitems}



\chapter{Spectral Functions}
\label{\detokenize{Spectral:spectral-functions}}\label{\detokenize{Spectral::doc}}
This module allows analysis in the frequency domain
\index{ar1\_fit() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.ar1_fit}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{ar1\_fit}}}{\emph{ys, ts=None, detrend='no', params={[}'default', 4, 0, 1{]}}}{}
Returns the lag-1 autocorrelation from ar1 fit OR persistence from tauest.
\begin{description}
\item[{Args:}] \leavevmode
ys (array): the time series
ts (array): the time axis of that series
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}
\end{quote}

\item[{Returns:}] \leavevmode
g (float): lag-1 autocorrelation coefficient (for evenly-spaced time series)
OR estimated persistence (for unevenly-spaced time series)

\end{description}

\end{fulllineitems}

\index{ar1\_sim() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.ar1_sim}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{ar1\_sim}}}{\emph{ys, n, p, ts=None, detrend='no', params={[}'default', 4, 0, 1{]}}}{}
Produce p realizations of an AR1 process of length n with lag-1 autocorrelation g calculated from \sphinxtitleref{ys} and \sphinxtitleref{ts}
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series
n, p (int): dimensions as n rows by p columns
ts (array): the time axis of that series
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

\item[{Returns:}] \leavevmode
red (matrix): n rows by p columns matrix of an AR1 process

\end{description}

\end{fulllineitems}

\index{wwz() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.wwz}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{wwz}}}{\emph{ys, ts, tau=None, freqs=None, c=0.012665147955292222, Neff=3, Neff\_coi=3, nMC=200, nproc=8, detrend='no', params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, method='Kirchner\_f2py', len\_bd=0, bc\_mode='reflect', reflect\_type='odd'}}{}
Return the weighted wavelet amplitude (WWA) with phase, AR1\_q, and cone of influence, as well as WT coeeficients
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs will be deleted automatically
ts (array): the time points, if \sphinxtitleref{ys} contains any NaNs, some of the time points will be deleted accordingly
tau (array): the evenly-spaced time points
freqs (array): vector of frequency
c (float): the decay constant, the default value 1/(8*np.pi**2) is good for most of the cases
Neff (int): effective number of points
nMC (int): the number of Monte-Carlo simulations
nproc (int): the number of processes for multiprocessing
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\item[{method (str): ‘Foster’ - the original WWZ method;}] \leavevmode
‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner\_f2py’ - the method Kirchner adapted from Foster with f2py

\end{description}

len\_bd (int): the number of the ghost grids want to creat on each boundary
bc\_mode (str): see np.lib.pad()
reflect\_type (str): see np.lib.pad()

\item[{Returns:}] \leavevmode
wwa (array): the weighted wavelet amplitude.
AR1\_q (array): AR1 simulations
coi (array): cone of influence
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
Neffs (array): the matrix of effective number of points in the time-scale coordinates
coeff (array): the wavelet transform coefficents

\end{description}

\end{fulllineitems}

\index{wwz\_psd() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.wwz_psd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{wwz\_psd}}}{\emph{ys, ts, freqs=None, tau=None, c=0.001, nproc=8, nMC=200, detrend='no', params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, Neff=3, anti\_alias=False, avgs=2, method='Kirchner\_f2py'}}{}
Return the psd of a timeseries directly using wwz method.
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series, NaNs will be deleted automatically
ts (array): the time points, if \sphinxtitleref{ys} contains any NaNs, some of the time points will be deleted accordingly
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
c (float): the decay constant, the default value 1e-3 is good for most of the cases
nproc (int): the number of processes for multiprocessing
nMC (int): the number of Monte-Carlo simulations
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

gaussianize (bool): If True, gaussianizes the timeseries
standardize (bool): If True, standardizes the timeseries
method (str): ‘Foster’ - the original WWZ method;
\begin{quote}

‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner\_f2py’ - the method Kirchner adapted from Foster with f2py
\end{quote}

\item[{Returns:}] \leavevmode
psd (array): power spectral density
freqs (array): vector of frequency
psd\_ar1\_q95 (array): the 95\% quantile of the psds of AR1 processes
psd\_ar1 (array): the psds of AR1 processes

\end{description}

\end{fulllineitems}

\index{xwc() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.xwc}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{xwc}}}{\emph{ys1, ts1, ys2, ts2, smooth\_factor=0.25, tau=None, freqs=None, c=0.012665147955292222, Neff=3, nproc=8, detrend='no', nMC=200, params={[}'default', 4, 0, 1{]}, gaussianize=False, standardize=True, method='Kirchner\_f2py'}}{}
Return the crosse wavelet coherence of two time series.
\begin{description}
\item[{Args:}] \leavevmode
ys1, ys2 (array): the two time series
ts1, ts2 (array): the time axis of the two time series
tau (array): the evenly-spaced time points
freqs (array): vector of frequency
c (float): the decay constant, the default value 1/(8*np.pi**2) is good for most of the cases
Neff (int): effective number of points
nproc (int): the number of processes for multiprocessing
nMC (int): the number of Monte-Carlo simulations
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay
\begin{quote}

filters and the resulting filtered series is subtracted from y.
\end{quote}
\end{quote}
\begin{description}
\item[{params (list): The paramters for the Savitzky-Golay filters. The first parameter}] \leavevmode
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)

\end{description}

gaussianize (bool): If True, gaussianizes the timeseries
standardize (bool): If True, standardizes the timeseries
method (str): ‘Foster’ - the original WWZ method;
\begin{quote}

‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner\_f2py’ - the method Kirchner adapted from Foster with f2py
\end{quote}

\item[{Returns:}] \leavevmode
xw\_coherence (array): the cross wavelet coherence
xw\_phase (array): the cross wavelet phase
freqs (array): vector of frequency
tau (array): the evenly-spaced time points
AR1\_q (array): AR1 simulations
coi (array): cone of influence

\end{description}

\end{fulllineitems}

\index{plot\_wwa() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_wwa}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_wwa}}}{\emph{wwa, freqs, tau, AR1\_q=None, coi=None, levels=None, tick\_range=None, yticks=None, yticks\_label=None, ylim=None, xticks=None, xlabels=None, figsize={[}20, 8{]}, clr\_map='OrRd', cbar\_drawedges=False, cone\_alpha=0.5, plot\_signif=False, signif\_style='contour', title=None, plot\_cbar=True, plot\_cone=False, ax=None, xlabel='Year (AD)', ylabel='Period (years)', cbar\_orientation='vertical', cbar\_pad=0.05, cbar\_frac=0.15, cbar\_labelsize=None}}{}
Plot the wavelet amplitude
\begin{description}
\item[{Args:}] \leavevmode
wwa (array): the weighted wavelet amplitude.
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
AR1\_q (array): AR1 simulations
coi (array): cone of influence
levels (array): levels of values to plot
tick\_range (array): levels of ticks to show on the colorbar
yticks (list): ticks on y-axis
ylim (list): limitations for y-axis
xticks (list): ticks on x-axis
figsize (list): the size for the figure
clr\_map (str): the name of the colormap
cbar\_drawedges (bool): whether to draw edges on the colorbar or not
cone\_alpha (float): the alpha value for the area covered by cone of influence
plot\_signif (bool): plot 95\% significant area or not
signif\_style (str): plot 95\% significant area with \sphinxtitleref{contour} or \sphinxtitleref{shade}
plot\_cone (bool): plot cone of influence or not
ax: Return as axis instead of figure (useful to integrate plot into a subplot)
xlabel (str): The x-axis label
ylabel (str): The y-axis label
cbar\_pad (float): the pad for the colorbar
cbar\_frac (float): the frac for the colorbar
cbar\_labelsize (float): the font size of the colorbar label

\item[{Returns:}] \leavevmode
fig (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_coherence() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_coherence}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_coherence}}}{\emph{res\_xwc, pt=0.5, levels=None, tick\_range=None, basey=2, yticks=None, ylim=None, xticks=None, xlabels=None, figsize={[}20, 8{]}, clr\_map='OrRd', skip\_x=5, skip\_y=5, scale=30, width=0.004, cbar\_drawedges=False, cone\_alpha=0.5, plot\_signif=False, signif\_style='contour', title=None, plot\_cone=False, ax=None, xlabel='Year', ylabel='Period', cbar\_orientation='vertical', cbar\_pad=0.05, cbar\_frac=0.15, cbar\_labelsize=None}}{}
Plot the wavelet amplitude
\begin{description}
\item[{Args:}] \leavevmode
xw\_coherence (array): the wavelet cohernce
xw\_phase (array): the wavelet cohernce phase
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
AR1\_q (array): AR1 simulations
coi (array): cone of influence
levels (array): levels of values to plot
tick\_range (array): levels of ticks to show on the colorbar
yticks (list): ticks on y-axis
ylim (list): limitations for y-axis
xticks (list): ticks on x-axis
figsize (list): the size for the figure
clr\_map (str): the name of the colormap
cbar\_drawedges (bool): whether to draw edges on the colorbar or not
cone\_alpha (float): the alpha value for the area covered by cone of influence
plot\_signif (bool): plot 95\% significant area or not
signif\_style (str): plot 95\% significant area with \sphinxtitleref{contour} or \sphinxtitleref{shade}
plot\_cone (bool): plot cone of influence or not
ax: Return as axis instead of figure (useful to integrate plot into a subplot)
xlabel (str): The x-axis label
ylabel (str): The y-axis label
cbar\_pad (float): the pad for the colorbar
c)bar\_frac (float): the frac for the colorbar
cbar\_labelsize (float): the font size of the colorbar label
pt (float): plot arrows above pt value
skip\_x, skip\_y (float): scale factors for arrows

\item[{Returns:}] \leavevmode
fig (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_wwadist() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_wwadist}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_wwadist}}}{\emph{wwa}, \emph{ylim=None}}{}
Plot the distribution of wwa with the 95\% quantile line.
\begin{description}
\item[{Args:}] \leavevmode
wwa (array): the weighted wavelet amplitude.
ylim (list): limitations for y-axis

\item[{Returns:}] \leavevmode
fig (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_psd() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_psd}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_psd}}}{\emph{psd, freqs, lmstyle='-', linewidth=None, color='\#3b5b92', ar1\_lmstyle='-', ar1\_linewidth=None, period\_ticks=None, period\_tickslabel=None, psd\_lim=None, period\_lim=None, figsize={[}20, 8{]}, label='PSD', plot\_ar1=False, psd\_ar1\_q95=None, title=None, legend=True, psd\_ar1\_color='\#d9544d', ax=None, vertical=False, plot\_gridlines=True, period\_label='Period (years)', psd\_label='Spectral Density', zorder=None}}{}
Plot the wavelet amplitude
\begin{description}
\item[{Args:}] \leavevmode
psd (array): power spectral density
freqs (array): vector of frequency
period\_ticks (list): ticks for period
psd\_lim (list): limits for spectral density axis
label (str): the label for the PSD
plot\_ar1 (bool): plot the ar1 curve or not
psd\_ar1\_q95 (array): the 95\% quantile of the AR1 PSD
psd\_ar1\_color (str): the color for the 95\% quantile of the AR1 PSD
title (str): the title for the figure
period\_lim (list): limits for period axis
figsize (list): the size for the figure
ax (axis): Return as axis instead of figure (useful to integrate plot into a subplot)
vertical (bool): plot in vertical layout or not
legend (bool): plot legend or not
lmstyle (str): the line style
linewidth (float): the line width
period\_label (str): the label for period
psd\_label (str): the label for psd
zorder (int): the order of the layer

\item[{Returns:}] \leavevmode
ax (figure): the 2-D plot of wavelet analysis

\end{description}

\end{fulllineitems}

\index{plot\_summary() (in module pyleoclim.Spectral)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Spectral:pyleoclim.Spectral.plot_summary}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.Spectral.}}\sphinxbfcode{\sphinxupquote{plot\_summary}}}{\emph{ys, ts, freqs=None, tau=None, c1=0.012665147955292222, c2=0.001, nMC=200, nproc=8, detrend='no', gaussianize=False, standardize=True, levels=None, method='Kirchner\_f2py', anti\_alias=False, period\_ticks=None, ts\_color=None, ts\_style='-o', title=None, ts\_ylabel=None, wwa\_xlabel=None, wwa\_ylabel=None, psd\_lmstyle='-', psd\_lim=None, period\_S\_str='beta\_I', period\_S={[}0.125, 0.5{]}, period\_L\_str='beta\_D', period\_L={[}0.005, 0.05{]}}}{}
Plot the time series with the wavelet analysis and psd
\begin{description}
\item[{Args:}] \leavevmode
ys (array): a time series
ts (array): time axis of the time series
freqs (array): vector of frequency
tau (array): the evenly-spaced time points, namely the time shift for wavelet analysis
c (float): the decay constant
Neff (int): the threshold of the number of effective degree of freedom
nproc (int): fake argument, just for convenience
detrend (str): ‘no’ - the original time series is assumed to have no trend;
\begin{quote}

‘linear’ - a linear least-squares fit to \sphinxtitleref{ys} is subtracted;
‘constant’ - the mean of \sphinxtitleref{ys} is subtracted
\end{quote}

ts\_color (str): the color for the time series curve
title (str): the title for the time series plot
ts\_ylabel (str): label for y-axis in the time series plot
wwa\_xlabel (str): label for x-axis in the wwa plot
wwa\_ylabel (str): label for y-axis in the wwa plot
psd\_lmstyle (str): the line style in the psd plot
psd\_lim (list): the limits for psd
period\_S, period\_L (list): the ranges for beta estimation

\item[{Returns:}] \leavevmode
fig (figure): the summary plot

\end{description}

\end{fulllineitems}



\chapter{RBchron}
\label{\detokenize{RBchron:rbchron}}\label{\detokenize{RBchron::doc}}
This module helps in the preparation of a Bchron run.

When using this module, please cite:
* Haslett, J., and Parnell, A.C. (2008). A simple monotone process with application to radiocarbon-dated depth chronologies. Journal of the Royal Statistical Society, Series C, 57, 399-418, DOI:10.111/j.1467-9876.2008.00623.x
* Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E.,  and Huntley, B. (2008). A flexible approach to assessing  synchroneity of past events using Bayesian reconstructions of sedimentation history. Quaternary Science Reviews, 27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009
\index{chooseCalCurves() (in module pyleoclim.RBchron)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.chooseCalCurves}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{chooseCalCurves}}}{}{}
Prompt for a calibration curve if not given by the user.

Prompt the user for the name of a calibration curve used to run the Bchron 
software package. The user can enter either enter only one name that will
be applied to each age or a list of names of different ages. To enter a list, 
separate each name with a comma. No quotation marks needed.
\begin{description}
\item[{Returns:}] \leavevmode
A list of calibration curves to be applied

\end{description}

\end{fulllineitems}

\index{reservoirAgeCorrection() (in module pyleoclim.RBchron)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.reservoirAgeCorrection}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{reservoirAgeCorrection}}}{}{}
Estimate reservoir age correction

Assists in estimating the reservoir age correction for marine records.
If unknown, will direct the user to copy and paste the table available
on the 14Chrono Marine Reservoir database: \sphinxurl{http://intcal.qub.ac.uk/marine/}
\begin{description}
\item[{Returns:}] \leavevmode
ageCorr -  the DeltaR for the site.

ageCorrStd - The error on DeltaR estimated as the standard error on the 
mean if using the 14Chrono Marine Reservoir database.

\end{description}

\end{fulllineitems}

\index{runBchron() (in module pyleoclim.RBchron)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.runBchron}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{runBchron}}}{\emph{ages}, \emph{agesStd}, \emph{positions}, \emph{rejectAges=None}, \emph{positionsThickness=None}, \emph{calCurves=None}, \emph{reservoirAgeCorr=None}, \emph{outlierProbs=None}, \emph{predictPositions=None}, \emph{iterations=10000}, \emph{burn=2000}, \emph{thin=8}, \emph{extractDate=-68}, \emph{maxExtrap=500}, \emph{thetaMhSd=0.5}, \emph{muMhSd=0.1}, \emph{psiMhSd=0.1}, \emph{ageScaleVal=1000}, \emph{positionScaleVal=100}}{}
Age model for Tie-Point chronologies

Fits a non-parametric chronology model to age/position data according to
the Compound Poisson-Gamma model defined by Haslett and Parnell (2008). 
This version used a slightly modified Markov chain Monte-Carlo fitting
algorithm which aims to converge quicker and requires fewer iterations.
It also a slightly modified procedure for identifying outliers.

The Bchronology functions fits a compounf Poisson-Gamma distribution to the
incrememnts between the dated levels. This involves a stochastic linear
interpolation step where the age gaps are Gamma distributed, and the position
gaps are Exponential. Radiocarbon and non-radiocarbon dates (including outliers)
are updated within the fucntion also by MCMC.
\begin{description}
\item[{Args:}] \leavevmode
ages (array): A vector of ages (most likely 14C)
ageSds (array): A vector of 1-sigma values for the ages given above
positions (array): Position values (e.g. depths) for each age
rejectAges (vector): A vector of 1/0 where 1 include the dates to be rejected.
\begin{quote}

Default it None.
\end{quote}
\begin{description}
\item[{positionsThickness (array): (Optional) Thickness values for each of the positions.}] \leavevmode
The thickness values should be the full thickness value of the
slice. By default set to zero.

\item[{calCurves (list): (Optional) A vector of values containing either ‘intcal13’,}] \leavevmode
‘marine13’, ‘shcal13’, or ‘normal’. If none is provided, will
prompt the user. Should be either of length =1 if using the same
calibration for each age or the same length as the vector of ages.

\item[{reservoirAgeCorr (array): (Optional) A list (matrix) of two floats that correspond to the}] \leavevmode
DeltaR and DeltaR uncertainty. If already added to the ages and
ages standard deviation, then enter {[}0,0{]} to bypass the prompt.
Will only be applied if CalCurves is set to ‘marine13’. Otherwise,
leave to none.

\item[{outlierProbs (array): (Optional) A vector of prior outlier probabilities,}] \leavevmode
one for each age. Defaults to 0.01

\item[{predictPositions (array): (Optional) a vector of positions }] \leavevmode
(e.g. depths) at which predicted age values are required. 
Defaults to a sequence of length 100 from the top position to the
bottom position.

\item[{iterations (int): (Optional) The number of iterations to start the procedure. }] \leavevmode
Default and minimum should be 10000.

\item[{burn (int): (Optional) The number of starting iterations to discard.}] \leavevmode
Default is 200

\item[{thin (int): (Optional) The step size for every iteration to keep beyond}] \leavevmode
the burnin. Default is 8.

\item[{extractDate (float): (Optional) The top age of the core. Used for}] \leavevmode
extrapolation purposes so that no extrapolated ages go beyond the
top age of the core. Defaults to the current year.

\item[{maxExtrap (int): (Optional) The maximum number of extrapolations to}] \leavevmode
perform before giving up and setting the predicted ages to NA. 
Useful for when large amounts of extrapolation are required, i.e.
some of the predictPositions are a long way from the dated
positions. Defaults to 500.

\item[{thetaMhSd (float):  (Optional)  The Metropolis-Hastings standard}] \leavevmode
deviation for the age parameters. Defaults to 0.5.

\item[{muMhSd (float): (Optional)  The Metropolis-Hastings standard deviation}] \leavevmode
for the compound Poisson-Gamma Scale. Defaults to 0.1

\item[{psiMhSd (float): (Optional) The Metropolis-Hastings standard deviation }] \leavevmode
for the Compound Poisson-Gamma Scale.

\item[{ageScaleVal (int): (Optional) A scale value for the ages. }] \leavevmode
Bchronology works best when the ages are scaled to be 
approximately between 0 and 100.
The default value is thus 1000 for ages given in years.

\item[{positionScaleVal (int):  (Optional) A scale value for the positions. }] \leavevmode
Bchronology works best when the positions are scaled to be 
approximately between 0 and 100. The default value is thus
100 for positions given in cm.

\item[{Returns:}] \leavevmode
depth - the predicted positions (either same as the user or the default)
\begin{description}
\item[{chron -  a numpy array of possible chronologies in each column.}] \leavevmode
The number of rows is the same as the length of depth

\end{description}

ageDist - the distribution of ages around each dates.
run - the full R object containing the outputs of the Bchron run

\item[{Warnings:}] \leavevmode\begin{description}
\item[{This function requires R and the Bchron package and all its}] \leavevmode
dependencies to be installed on the same machine.

\end{description}

\item[{Reference:}] \leavevmode\begin{itemize}
\item {} \begin{description}
\item[{Haslett, J., and Parnell, A. C. (2008). A simple monotone }] \leavevmode
process with application to radiocarbon-dated depth 
chronologies. Journal of the Royal Statistical Society, 
Series C, 57, 399-418. DOI:10.1111/j.1467-9876.2008.00623.x

\end{description}

\item {} \begin{description}
\item[{Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E., }] \leavevmode
and Huntley, B. (2008). A flexible approach to assessing 
synchroneity of past events using Bayesian reconstructions
of sedimentation history. Quaternary Science Reviews, 
27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009

\end{description}

\end{itemize}

\end{description}

\end{description}

\end{fulllineitems}

\index{plotBchron() (in module pyleoclim.RBchron)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{RBchron:pyleoclim.RBchron.plotBchron}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pyleoclim.RBchron.}}\sphinxbfcode{\sphinxupquote{plotBchron}}}{\emph{depth, chron, positions, ageDist, flipCoor=False, xlabel='Depth', ylabel='Age', xlim=None, ylim=None, violinColor='\#8B008B', medianLineColor='black', medianLineWidth=2.0, CIFillColor='Silver', samplePaths=True, samplePathNumber=10, alpha=0.5, figsize={[}4, 8{]}, ax=None}}{}
Plot a Bchron output

This function creates a plot showing the calibrated calendar ages and
associated 95\% confidence interval as error bars, the 95\% ensemble from
the produced age model as well as randomly drawn members of the ensemble.
\begin{description}
\item[{Args:}] \leavevmode\begin{description}
\item[{depth (array): the positions in the archive (often referred to as}] \leavevmode
depth) where the age model was interpolated to. Should be a vector

\item[{chron (array): The possible age models returned by BChron. The number}] \leavevmode
of rows should be the same length as the depth vector, with each
possible realization stored in the columns.

\item[{positions (array): The depth on the archive at which chronological}] \leavevmode
measurements have been made. Should be a vector

\item[{agesDist (array): The distribution of ages for each chronological tie}] \leavevmode
points. The number of columns should correspond to the number of
chronological tie points available.

\end{description}

flipCoor (bool): If True, plots depth on the y-axis.     
xlabel (str): The label for the x-axis
ylabel (str): The label for the y-axis
xlim (list): Limits for the x-axis. Default corresponds to the min/max
\begin{quote}

of the depth vector.
\end{quote}

ylim (list): Limits for the y-axis. Default set by matplotlib
violinColor (str): The color for the violins. Default is purple
medianLineColor (str): The color for the median line. Default is black.
medianLineWidth (float): The width for the median line
CIFillColor (str): Fill color in between the 95\% confidence interval.
\begin{quote}

Default is silver.
\end{quote}
\begin{description}
\item[{samplePaths (bool): If True, draws sample paths from the distribution.}] \leavevmode
Use the same color as the violins.

\item[{samplePathNumber (int): The number of sample paths to draw. Default is 10.}] \leavevmode
Note: samplePaths need to be set to True.

\end{description}

alpha (float): The violins’ transparency. Number between 0 and 1
figsize (list): The figure size. Default is {[}4,8{]}
ax: Default is None. Useful to set for subplots.

\item[{Returns:}] \leavevmode\begin{itemize}
\item {} 
fig: the figure.

\end{itemize}

\end{description}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}