

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Series.ssa (pyleoclim.core.ui.Series.ssa) &mdash; Pyleoclim 0.5.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Pyleoclim
          

          
          </a>

          
            
            
              <div class="version">
                0.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Series.ssa (pyleoclim.core.ui.Series.ssa)</a></li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Pyleoclim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Series.ssa (pyleoclim.core.ui.Series.ssa)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/core/Series/ssa.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="series-ssa-pyleoclim-core-ui-series-ssa">
<span id="series-ssa"></span><h1>Series.ssa (pyleoclim.core.ui.Series.ssa)<a class="headerlink" href="#series-ssa-pyleoclim-core-ui-series-ssa" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="pyleoclim.core.ui.Series.ssa">
<code class="sig-prename descclassname">pyleoclim.core.ui.Series.</code><code class="sig-name descname">ssa</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">M</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nMC</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">f</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.core.ui.Series.ssa" title="Permalink to this definition">¶</a></dt>
<dd><p>Singular Spectrum Analysis</p>
<p>Nonparametric, orthogonal decomposition of timeseries into constituent oscillations.
This implementation  uses the method of [1], with applications presented in [2].
Optionally (MC&gt;0), the significance of eigenvalues is assessed by Monte-Carlo simulations of an AR(1) model fit to X, using [3].
The method expects regular spacing, but is tolerant to missing values, up to a fraction 0&lt;f&lt;1 (see [4]).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>int</em><em>, </em><em>optional</em>) – window size. The default is None (10% of the length of the series).</p></li>
<li><p><strong>MC</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iteration in the Monte-Carlo process. The default is 0.</p></li>
<li><p><strong>f</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum allowable fraction of missing values. The default is 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res</strong> – Containing:</p>
<ul class="simple">
<li><p>eig_val : (M, 1) array of eigenvalue spectrum of length r, the number of SSA modes. As in Principal Component Analysis, eigenvaluesare closely related to the fraction of variance accounted for (“explained”, a common but not-so-helpful term) by each mode.</p></li>
<li><p>eig_vec : is a matrix of the temporal eigenvectors (T-EOFs), i.e. the temporal patterns that explain most of the variations in the original series.</p></li>
<li><p>PC : (N - M + 1, M) array of principal components, i.e. the loadings that, convolved with the T-EOFs, produce the reconstructed components, or RCs</p></li>
<li><p>RC : (N,  M) array of reconstructed components, One can think of each RC as the contribution of each mode to the timeseries, weighted by their eigenvalue (loosely speaking, their “amplitude”). Summing over all columns of RC recovers the original series. (synthesis, the reciprocal operation of analysis).</p></li>
<li><p>eig_val_q : (M, 2) array containing the 5% and 95% quantiles of the Monte-Carlo eigenvalue spectrum [ if MC &gt;0 ]</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>SSA with SOI</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="gp">In [4]: </span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">time</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">value</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [7]: </span><span class="n">ts</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span><span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year C.E&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">)</span>

<span class="go">#plot</span>
<span class="gp">In [8]: </span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [9]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go">#SSA</span>
<span class="gp">In [10]: </span><span class="n">nino_ssa</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">ssa</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/ts_plot.png" src="../../_images/ts_plot.png" />
<p>Let us now see how to make use of all these arrays. The first step is too inspect the eigenvalue spectrum (“scree plot”) to identify remarkable modes. Let us restrict ourselves to the first 40, so we can see something:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="gp">In [12]: </span><span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>

<span class="gp">In [13]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [14]: </span><span class="n">d</span>  <span class="o">=</span> <span class="n">nino_ssa</span><span class="p">[</span><span class="s1">&#39;eig_val&#39;</span><span class="p">]</span> <span class="c1"># extract eigenvalue vector</span>

<span class="gp">In [15]: </span><span class="n">M</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># infer window size</span>

<span class="gp">In [16]: </span><span class="n">de</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="gp">In [17]: </span><span class="n">var_pct</span> <span class="o">=</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>  <span class="c1"># extract the fraction of variance attributable to each mode</span>

<span class="go"># plot eigenvalues</span>
<span class="gp">In [18]: </span><span class="n">r</span> <span class="o">=</span> <span class="mi">20</span>

<span class="gp">In [19]: </span><span class="n">rk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>

<span class="gp">In [20]: </span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="gp">In [21]: </span><span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">rk</span><span class="p">,</span><span class="n">d</span><span class="p">[:</span><span class="n">r</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">de</span><span class="p">[:</span><span class="n">r</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SSA eigenvalues w/ 95% CI&#39;</span><span class="p">)</span>
<span class="gh">Out[21]: </span><span class="go">&lt;ErrorbarContainer object of 3 artists&gt;</span>

<span class="gp">In [22]: </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Scree plot of SSA eigenvalues&#39;</span><span class="p">)</span>
<span class="gh">Out[22]: </span><span class="go">Text(0.5, 1.0, &#39;Scree plot of SSA eigenvalues&#39;)</span>

<span class="gp">In [23]: </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Rank $i$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_i$&#39;</span><span class="p">)</span>
<span class="gh">Out[23]: </span><span class="go">Text(0, 0.5, &#39;$\\lambda_i$&#39;)</span>

<span class="gp">In [24]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="gh">Out[24]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x163fdbe50&gt;</span>

<span class="gp">In [25]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 640x480 with 1 Axes&gt;</span>

<span class="gp">In [26]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/scree_plot.png" src="../../_images/scree_plot.png" />
<dl class="simple">
<dt>This highlights a few common phenomena with SSA:</dt><dd><ul class="simple">
<li><p>the eigenvalues are in descending order</p></li>
<li><p>their uncertainties are proportional to the eigenvalues themselves</p></li>
<li><p>the eigenvalues tend to come in pairs : (1,2) (3,4), are all clustered within uncertainties . (5,6) looks like another doublet</p></li>
<li><p>around i=15, the eigenvalues appear to reach a floor, and all subsequent eigenvalues explain a very small amount of variance.</p></li>
</ul>
</dd>
</dl>
<p>So, summing the variance of all modes higher than 19, we get:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="nb">print</span><span class="p">(</span><span class="n">var_pct</span><span class="p">[</span><span class="mi">15</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="go">282.301930950568</span>
</pre></div>
</div>
<p>That is, over 95% of the variance is in the first 15 modes. That is a typical result for a “warm-colored” timeseries, which is most geophysical timeseries; a few modes do the vast majority of the work. That means we can focus our attention on these modes and capture most of the interesting behavior. To see this, let’s use the reconstructed components (RCs), and sum the RC matrix over the first 15 columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">RCk</span> <span class="o">=</span> <span class="n">nino_ssa</span><span class="p">[</span><span class="s1">&#39;RC&#39;</span><span class="p">][:,:</span><span class="mi">14</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [29]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;ONI&#39;</span><span class="p">,</span><span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># we mute the first call to only get the plot with 2 lines</span>

<span class="gp">In [30]: </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">RCk</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SSA reconstruction, 14 modes&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="gh">Out[30]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x161f38700&gt;]</span>

<span class="gp">In [31]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gh">Out[31]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x161f2da30&gt;</span>

<span class="gp">In [32]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [33]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/ssa_recon.png" src="../../_images/ssa_recon.png" />
<dl class="simple">
<dt>Indeed, these first few modes capture the vast majority of the low-frequency behavior, including all the El Niño/La Niña events. What is left (the blue wiggles not captured in the orange curve) are high-frequency oscillations that might be considered “noise” from the standpoint of ENSO dynamics. This illustrates how SSA might be used for filtering a timeseries. One must be careful however:</dt><dd><ul class="simple">
<li><p>there was not much rhyme or reason for picking 15 modes. Why not 5, or 39? All we have seen so far is that they gather &gt;95% of the variance, which is by no means a magic number.</p></li>
<li><p>there is no guarantee that the first few modes will filter out high-frequency behavior, or at what frequency cutoff they will do so. If you need to cut out specific frequencies, you are better off doing it with a classical filter, like the butterworth filter implemented in Pyleoclim. However, in many instances the choice of a cutoff frequency is itself rather arbitrary. In such cases, SSA provides a principled alternative for generating a version of a timeseries that preserves features and excludes others (i.e, a filter).</p></li>
<li><p>as with all orthgonal decompositions, summing over all RCs will recover the original signal within numerical precision.</p></li>
</ul>
</dd>
</dl>
<p>Monte-Carlo SSA</p>
<p>Selecting meaningful modes in eigenproblems (e.g. EOF analysis) is more art than science. However, one technique stands out: Monte Carlo SSA, introduced by Allen &amp; Smith, (1996) to identiy SSA modes that rise above what one would expect from “red noise”, specifically an AR(1) process_process). To run it, simply provide the parameter MC, ideally with a number of iterations sufficient to get decent statistics. Here’s let’s use MC = 1000. The result will be stored in the eig_val_q array, which has the same length as eig_val, and its two columns contain the 5% and 95% quantiles of the ensemble of MC-SSA eigenvalues.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">nino_mcssa</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">ssa</span><span class="p">(</span><span class="n">M</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">nMC</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s look at the result:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">d</span>  <span class="o">=</span> <span class="n">nino_mcssa</span><span class="p">[</span><span class="s1">&#39;eig_val&#39;</span><span class="p">]</span> <span class="c1"># extract eigenvalue vector</span>

<span class="gp">In [36]: </span><span class="n">de</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="gp">In [37]: </span><span class="n">du</span> <span class="o">=</span> <span class="n">nino_mcssa</span><span class="p">[</span><span class="s1">&#39;eig_val_q&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># extract upper quantile of MC-SSA eigenvalues</span>

<span class="gp">In [38]: </span><span class="n">dl</span> <span class="o">=</span> <span class="n">nino_mcssa</span><span class="p">[</span><span class="s1">&#39;eig_val_q&#39;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># extract lower quantile of MC-SSA eigenvalues</span>

<span class="go"># plot eigenvalues</span>
<span class="gp">In [39]: </span><span class="n">rk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>

<span class="gp">In [40]: </span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="gp">In [41]: </span><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">rk</span><span class="p">,</span><span class="n">dl</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span><span class="n">du</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;MC-SSA 95% CI&#39;</span><span class="p">)</span>
<span class="gh">Out[41]: </span><span class="go">&lt;matplotlib.collections.PolyCollection at 0x1624d3b80&gt;</span>

<span class="gp">In [42]: </span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">rk</span><span class="p">,</span><span class="n">d</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">de</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SSA eigenvalues w/ 95% CI&#39;</span><span class="p">)</span>
<span class="gh">Out[42]: </span><span class="go">&lt;ErrorbarContainer object of 3 artists&gt;</span>

<span class="gp">In [43]: </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scree plot of SSA eigenvalues, w/ MC-SSA bounds&#39;</span><span class="p">)</span>
<span class="gh">Out[43]: </span><span class="go">Text(0.5, 1.0, &#39;Scree plot of SSA eigenvalues, w/ MC-SSA bounds&#39;)</span>

<span class="gp">In [44]: </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rank $i$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_i$&#39;</span><span class="p">)</span>
<span class="gh">Out[44]: </span><span class="go">Text(0, 0.5, &#39;$\\lambda_i$&#39;)</span>

<span class="gp">In [45]: </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="gh">Out[45]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x1624d3a30&gt;</span>

<span class="gp">In [46]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 640x480 with 1 Axes&gt;</span>

<span class="gp">In [47]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/scree_nmc.png" src="../../_images/scree_nmc.png" />
<p>This suggests that modes 1-5 fall above the red noise benchmark.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017-2020, Deborah Khider, Feng Zhu, Julien Emile-Geay

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>