

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Spectral Functions &mdash; Pyleoclim 0.4.10 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Pyleoclim
          

          
          </a>

          
            
            
              <div class="version">
                0.4.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pyleoclim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Spectral Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/deprec/spectral.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="spectral-functions">
<h1>Spectral Functions<a class="headerlink" href="#spectral-functions" title="Permalink to this headline">¶</a></h1>
<p>This module allows analysis in the frequency domain</p>
<dl class="py function">
<dt id="pyleoclim.spectral.wwz">
<code class="sig-prename descclassname">pyleoclim.spectral.</code><code class="sig-name descname">wwz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ys</span></em>, <em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">tau</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">freq</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">freq_method</span><span class="o">=</span><span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">freq_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">c</span><span class="o">=</span><span class="default_value">0.012665147955292222</span></em>, <em class="sig-param"><span class="n">Neff</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">Neff_coi</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">nMC</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">detrend</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">['default', 4, 0, 1]</span></em>, <em class="sig-param"><span class="n">gaussianize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">standardize</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">len_bd</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">bc_mode</span><span class="o">=</span><span class="default_value">'reflect'</span></em>, <em class="sig-param"><span class="n">reflect_type</span><span class="o">=</span><span class="default_value">'odd'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.spectral.wwz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weighted wavelet amplitude (WWA) with phase, AR1_q, and cone of influence, as well as WT coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ys</strong> (<em>array</em>) – a time series, NaNs will be deleted automatically</p></li>
<li><p><strong>ts</strong> (<em>array</em>) – the time points, if <cite>ys</cite> contains any NaNs, some of the time points will be deleted accordingly</p></li>
<li><p><strong>tau</strong> (<em>array</em>) – the evenly-spaced time points</p></li>
<li><p><strong>freq</strong> (<em>array</em>) – vector of frequency</p></li>
<li><p><strong>freq_method</strong> (<em>str</em>) – when freq=None, freq will be ganerated according to freq_method</p></li>
<li><p><strong>freq_kwargs</strong> (<em>str</em>) – used when freq=None for certain methods</p></li>
<li><p><strong>c</strong> (<em>float</em>) – the decay constant, the default value 1/(8*np.pi**2) is good for most of the cases</p></li>
<li><p><strong>Neff</strong> (<em>int</em>) – effective number of points</p></li>
<li><p><strong>nMC</strong> (<em>int</em>) – the number of Monte-Carlo simulations</p></li>
<li><p><strong>nproc</strong> (<em>int</em>) – the number of processes for multiprocessing</p></li>
<li><p><strong>detrend</strong> (<em>str</em>) – <p>None - the original time series is assumed to have no trend;
‘linear’ - a linear least-squares fit to <cite>ys</cite> is subtracted;
‘constant’ - the mean of <cite>ys</cite> is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay</p>
<blockquote>
<div><p>filters and the resulting filtered series is subtracted from y.</p>
</div></blockquote>
</p></li>
<li><p><strong>params</strong> (<em>list</em>) – The paramters for the Savitzky-Golay filters. The first parameter
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)</p></li>
<li><p><strong>method</strong> (<em>string</em>) – ‘Foster’ - the original WWZ method;
‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner_f2py’ - the method Kirchner adapted from Foster with f2py</p></li>
<li><p><strong>len_bd</strong> (<em>int</em>) – the number of the ghost grids want to creat on each boundary</p></li>
<li><p><strong>bc_mode</strong> (<em>string</em>) – {‘constant’, ‘edge’, ‘linear_ramp’, ‘maximum’, ‘mean’, ‘median’, ‘minimum’, ‘reflect’ , ‘symmetric’, ‘wrap’}
For more details, see np.lib.pad()</p></li>
<li><p><strong>reflect_type</strong> (<em>string</em>) – {‘even’, ‘odd’}, optional
Used in ‘reflect’, and ‘symmetric’. The ‘even’ style is the default with an unaltered reflection around the edge value.
For the ‘odd’ style, the extented part of the array is created by subtracting the reflected values from two times the edge value.
For more details, see np.lib.pad()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wwa</strong> (<em>array</em>) – the weighted wavelet amplitude.</p></li>
<li><p><strong>AR1_q</strong> (<em>array</em>) – AR1 simulations</p></li>
<li><p><strong>coi</strong> (<em>array</em>) – cone of influence</p></li>
<li><p><strong>freq</strong> (<em>array</em>) – vector of frequency</p></li>
<li><p><strong>tau</strong> (<em>array</em>) – the evenly-spaced time points, namely the time shift for wavelet analysis</p></li>
<li><p><strong>Neffs</strong> (<em>array</em>) – the matrix of effective number of points in the time-scale coordinates</p></li>
<li><p><strong>coeff</strong> (<em>array</em>) – the wavelet transform coefficents</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyleoclim.spectral.wwz_psd">
<code class="sig-prename descclassname">pyleoclim.spectral.</code><code class="sig-name descname">wwz_psd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ys</span></em>, <em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">freq</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">freq_method</span><span class="o">=</span><span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">freq_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tau</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">detrend</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">['default', 4, 0, 1]</span></em>, <em class="sig-param"><span class="n">gaussianize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">standardize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">Neff</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">anti_alias</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">avgs</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'default'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyleoclim.spectral.wwz_psd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the psd of a timeseries using wwz method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ys</strong> (<em>array</em>) – a time series, NaNs will be deleted automatically</p></li>
<li><p><strong>ts</strong> (<em>array</em>) – the time points, if <cite>ys</cite> contains any NaNs, some of the time points will be deleted accordingly</p></li>
<li><p><strong>freq</strong> (<em>array</em>) – vector of frequency</p></li>
<li><p><strong>freq_method</strong> (<em>str</em>) – <dl class="simple">
<dt>Method to generate the frequency vector if not set directly. The following options are avialable:</dt><dd><ul>
<li><p>log (default)</p></li>
<li><p>lomb-scargle</p></li>
<li><p>welch</p></li>
<li><p>scale</p></li>
<li><p>nfft</p></li>
</ul>
</dd>
</dl>
<p>See utils.wavelet.make_freq_vector for details</p>
</p></li>
<li><p><strong>freq_kwargs</strong> (<em>dict</em>) – Arguments for the method chosen in freq_method. See specific functions in utils.wavelet for details</p></li>
<li><p><strong>tau</strong> (<em>array</em>) – the evenly-spaced time points, namely the time shift for wavelet analysis</p></li>
<li><p><strong>c</strong> (<em>float</em>) – the decay constant, the default value 1e-3 is good for most of the cases</p></li>
<li><p><strong>nproc</strong> (<em>int</em>) – the number of processes for multiprocessing</p></li>
<li><p><strong>detrend</strong> (<em>str</em>) – <p>None - the original time series is assumed to have no trend;
‘linear’ - a linear least-squares fit to <cite>ys</cite> is subtracted;
‘constant’ - the mean of <cite>ys</cite> is subtracted
‘savitzy-golay’ - ys is filtered using the Savitzky-Golay</p>
<blockquote>
<div><p>filters and the resulting filtered series is subtracted from y.</p>
</div></blockquote>
</p></li>
<li><p><strong>params</strong> (<em>list</em>) – The paramters for the Savitzky-Golay filters. The first parameter
corresponds to the window size (default it set to half of the data)
while the second parameter correspond to the order of the filter
(default is 4). The third parameter is the order of the derivative
(the default is zero, which means only smoothing.)</p></li>
<li><p><strong>gaussianize</strong> (<em>bool</em>) – If True, gaussianizes the timeseries</p></li>
<li><p><strong>standardize</strong> (<em>bool</em>) – If True, standardizes the timeseries</p></li>
<li><p><strong>method</strong> (<em>string</em>) – ‘Foster’ - the original WWZ method;
‘Kirchner’ - the method Kirchner adapted from Foster;
‘Kirchner_f2py’ - the method Kirchner adapted from Foster with f2py
‘default’ - the Numba version of the Kirchner algorithm will be called. Defaults to default</p></li>
<li><p><strong>Neff</strong> (<em>int</em>) – effective number of points</p></li>
<li><p><strong>anti_alias</strong> (<em>bool</em>) – If True, uses anti-aliasing</p></li>
<li><p><strong>avgs</strong> (<em>int</em>) – flag for whether spectrum is derived from instantaneous point measurements (avgs&lt;&gt;1)
OR from measurements averaged over each sampling interval (avgs==1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>psd</strong> (<em>array</em>) – power spectral density</p></li>
<li><p><strong>freq</strong> (<em>array</em>) – vector of frequency</p></li>
<li><p><strong>psd_ar1_q95</strong> (<em>array</em>) – the 95% quantile of the psds of AR1 processes</p></li>
<li><p><strong>psd_ar1</strong> (<em>array</em>) – the psds of AR1 processes</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">periodogram()</span></code></dt><dd><p>Estimate power spectral density using a periodogram</p>
</dd>
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">mtm()</span></code></dt><dd><p>Retuns spectral density using a multi-taper method</p>
</dd>
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">lomb_scargle()</span></code></dt><dd><p>Return the computed periodogram using lomb-scargle algorithm</p>
</dd>
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">welch()</span></code></dt><dd><p>Estimate power spectral density using the Welch method</p>
</dd>
</dl>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017-2019, Deborah Khider, Feng Zhu, Julien Emile-Geay

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>