

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RBchron &mdash; Pyleoclim 0.4.10 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Spectral Functions" href="Spectral.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Pyleoclim
          

          
          </a>

          
            
            
              <div class="version">
                0.4.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Pyleoclim</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Main.html">Main Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Map.html">Mapping Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plot.html">Plotting Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Stats.html">Statistics Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Timeseries.html">Timeseries Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="LIPDutils.html">LiPD Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="SummaryPlots.html">Summary Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectral.html">Spectral Functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">RBchron</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyleoclim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>RBchron</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/RBchron.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="rbchron">
<h1>RBchron<a class="headerlink" href="#rbchron" title="Permalink to this headline">¶</a></h1>
<p>This module helps in the preparation of a Bchron run.</p>
<p>When using this module, please cite:
* Haslett, J., and Parnell, A.C. (2008). A simple monotone process with application to radiocarbon-dated depth chronologies. Journal of the Royal Statistical Society, Series C, 57, 399-418, DOI:10.111/j.1467-9876.2008.00623.x
* Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E.,  and Huntley, B. (2008). A flexible approach to assessing  synchroneity of past events using Bayesian reconstructions of sedimentation history. Quaternary Science Reviews, 27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009</p>
<dl class="function">
<dt id="pyleoclim.RBchron.chooseCalCurves">
<code class="sig-prename descclassname">pyleoclim.RBchron.</code><code class="sig-name descname">chooseCalCurves</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim/RBchron.html#chooseCalCurves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.RBchron.chooseCalCurves" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompt for a calibration curve if not given by the user.</p>
<p>Prompt the user for the name of a calibration curve used to run the Bchron
software package. The user can enter either enter only one name that will
be applied to each age or a list of names of different ages. To enter a list,
separate each name with a comma. No quotation marks needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of calibration curves to be applied</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.RBchron.verifyCalCurves">
<code class="sig-prename descclassname">pyleoclim.RBchron.</code><code class="sig-name descname">verifyCalCurves</code><span class="sig-paren">(</span><em class="sig-param">CalCurves</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim/RBchron.html#verifyCalCurves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.RBchron.verifyCalCurves" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that the list of calibration curves contain valid entries for BChron</p>
<p>Performs a verification that the names entered in the list of calibration
curves are conformed to the names used by Bchron. Will prompt the user to
replace the name if needed.</p>
<dl class="simple">
<dt>Agrs:</dt><dd><dl class="simple">
<dt>CalCurves (list): A list of strings containing the name(s) of the</dt><dd><p>calibration curves to be used</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CalCurves - Checked list of calibration curves names</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.RBchron.reservoirAgeCorrection">
<code class="sig-prename descclassname">pyleoclim.RBchron.</code><code class="sig-name descname">reservoirAgeCorrection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim/RBchron.html#reservoirAgeCorrection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.RBchron.reservoirAgeCorrection" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate reservoir age correction</p>
<p>Assists in estimating the reservoir age correction for marine records.
If unknown, will direct the user to copy and paste the table available
on the 14Chrono Marine Reservoir database: <a class="reference external" href="http://intcal.qub.ac.uk/marine/">http://intcal.qub.ac.uk/marine/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>ageCorr -  the DeltaR for the site.</p>
<p>ageCorrStd - The error on DeltaR estimated as the standard error on the
mean if using the 14Chrono Marine Reservoir database.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.RBchron.runBchron">
<code class="sig-prename descclassname">pyleoclim.RBchron.</code><code class="sig-name descname">runBchron</code><span class="sig-paren">(</span><em class="sig-param">ages</em>, <em class="sig-param">agesStd</em>, <em class="sig-param">positions</em>, <em class="sig-param">rejectAges=None</em>, <em class="sig-param">positionsThickness=None</em>, <em class="sig-param">calCurves=None</em>, <em class="sig-param">reservoirAgeCorr=None</em>, <em class="sig-param">outlierProbs=None</em>, <em class="sig-param">predictPositions=None</em>, <em class="sig-param">iterations=10000</em>, <em class="sig-param">burn=2000</em>, <em class="sig-param">thin=8</em>, <em class="sig-param">extractDate=-70</em>, <em class="sig-param">maxExtrap=500</em>, <em class="sig-param">thetaMhSd=0.5</em>, <em class="sig-param">muMhSd=0.1</em>, <em class="sig-param">psiMhSd=0.1</em>, <em class="sig-param">ageScaleVal=1000</em>, <em class="sig-param">positionScaleVal=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim/RBchron.html#runBchron"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.RBchron.runBchron" title="Permalink to this definition">¶</a></dt>
<dd><p>Age model for Tie-Point chronologies</p>
<p>Fits a non-parametric chronology model to age/position data according to
the Compound Poisson-Gamma model defined by Haslett and Parnell (2008).
This version used a slightly modified Markov chain Monte-Carlo fitting
algorithm which aims to converge quicker and requires fewer iterations.
It also a slightly modified procedure for identifying outliers.</p>
<p>The Bchronology functions fits a compounf Poisson-Gamma distribution to the
incrememnts between the dated levels. This involves a stochastic linear
interpolation step where the age gaps are Gamma distributed, and the position
gaps are Exponential. Radiocarbon and non-radiocarbon dates (including outliers)
are updated within the fucntion also by MCMC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ages</strong> (<em>array</em>) – A vector of ages (most likely 14C)</p></li>
<li><p><strong>ageSds</strong> (<em>array</em>) – A vector of 1-sigma values for the ages given above</p></li>
<li><p><strong>positions</strong> (<em>array</em>) – Position values (e.g. depths) for each age</p></li>
<li><p><strong>rejectAges</strong> (<em>vector</em>) – A vector of 1/0 where 1 include the dates to be rejected.
Default it None.</p></li>
<li><p><strong>positionsThickness</strong> (<em>array</em>) – (Optional) Thickness values for each of the positions.
The thickness values should be the full thickness value of the
slice. By default set to zero.</p></li>
<li><p><strong>calCurves</strong> (<em>list</em>) – (Optional) A vector of values containing either ‘intcal13’,
‘marine13’, ‘shcal13’, or ‘normal’. If none is provided, will
prompt the user. Should be either of length =1 if using the same
calibration for each age or the same length as the vector of ages.</p></li>
<li><p><strong>reservoirAgeCorr</strong> (<em>array</em>) – (Optional) A list (matrix) of two floats that correspond to the
DeltaR and DeltaR uncertainty. If already added to the ages and
ages standard deviation, then enter [0,0] to bypass the prompt.
Will only be applied if CalCurves is set to ‘marine13’. Otherwise,
leave to none.</p></li>
<li><p><strong>outlierProbs</strong> (<em>array</em>) – (Optional) A vector of prior outlier probabilities,
one for each age. Defaults to 0.01</p></li>
<li><p><strong>predictPositions</strong> (<em>array</em>) – (Optional) a vector of positions
(e.g. depths) at which predicted age values are required.
Defaults to a sequence of length 100 from the top position to the
bottom position.</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – (Optional) The number of iterations to start the procedure.
Default and minimum should be 10000.</p></li>
<li><p><strong>burn</strong> (<em>int</em>) – (Optional) The number of starting iterations to discard.
Default is 200</p></li>
<li><p><strong>thin</strong> (<em>int</em>) – (Optional) The step size for every iteration to keep beyond
the burnin. Default is 8.</p></li>
<li><p><strong>extractDate</strong> (<em>float</em>) – (Optional) The top age of the core. Used for
extrapolation purposes so that no extrapolated ages go beyond the
top age of the core. Defaults to the current year.</p></li>
<li><p><strong>maxExtrap</strong> (<em>int</em>) – (Optional) The maximum number of extrapolations to
perform before giving up and setting the predicted ages to NA.
Useful for when large amounts of extrapolation are required, i.e.
some of the predictPositions are a long way from the dated
positions. Defaults to 500.</p></li>
<li><p><strong>thetaMhSd</strong> (<em>float</em>) – (Optional)  The Metropolis-Hastings standard
deviation for the age parameters. Defaults to 0.5.</p></li>
<li><p><strong>muMhSd</strong> (<em>float</em>) – (Optional)  The Metropolis-Hastings standard deviation
for the compound Poisson-Gamma Scale. Defaults to 0.1</p></li>
<li><p><strong>psiMhSd</strong> (<em>float</em>) – (Optional) The Metropolis-Hastings standard deviation
for the Compound Poisson-Gamma Scale.</p></li>
<li><p><strong>ageScaleVal</strong> (<em>int</em>) – (Optional) A scale value for the ages.
Bchronology works best when the ages are scaled to be
approximately between 0 and 100.
The default value is thus 1000 for ages given in years.</p></li>
<li><p><strong>positionScaleVal</strong> (<em>int</em>) – (Optional) A scale value for the positions.
Bchronology works best when the positions are scaled to be
approximately between 0 and 100. The default value is thus
100 for positions given in cm.</p></li>
<li><p><strong>Returns</strong> – <p>depth - the predicted positions (either same as the user or the default)</p>
<dl class="simple">
<dt>chron -  a numpy array of possible chronologies in each column.</dt><dd><p>The number of rows is the same as the length of depth</p>
</dd>
</dl>
<p>ageDist - the distribution of ages around each dates.
run - the full R object containing the outputs of the Bchron run</p>
</p></li>
<li><p><strong>Warnings</strong> – <dl class="simple">
<dt>This function requires R and the Bchron package and all its</dt><dd><p>dependencies to be installed on the same machine.</p>
</dd>
</dl>
</p></li>
<li><p><strong>Reference</strong> – <ul>
<li><dl class="simple">
<dt>Haslett, J., and Parnell, A. C. (2008). A simple monotone</dt><dd><p>process with application to radiocarbon-dated depth
chronologies. Journal of the Royal Statistical Society,
Series C, 57, 399-418. DOI:10.1111/j.1467-9876.2008.00623.x</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E.,</dt><dd><p>and Huntley, B. (2008). A flexible approach to assessing
synchroneity of past events using Bayesian reconstructions
of sedimentation history. Quaternary Science Reviews,
27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyleoclim.RBchron.plotBchron">
<code class="sig-prename descclassname">pyleoclim.RBchron.</code><code class="sig-name descname">plotBchron</code><span class="sig-paren">(</span><em class="sig-param">depth, chron, positions, ageDist, flipCoor=False, xlabel='Depth', ylabel='Age', xlim=None, ylim=None, violinColor='#8B008B', medianLineColor='black', medianLineWidth=2.0, CIFillColor='Silver', samplePaths=True, samplePathNumber=10, alpha=0.5, figsize=[4, 8], ax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyleoclim/RBchron.html#plotBchron"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyleoclim.RBchron.plotBchron" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a Bchron output</p>
<p>This function creates a plot showing the calibrated calendar ages and
associated 95% confidence interval as error bars, the 95% ensemble from
the produced age model as well as randomly drawn members of the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>depth</strong> (<em>array</em>) – the positions in the archive (often referred to as
depth) where the age model was interpolated to. Should be a vector</p></li>
<li><p><strong>chron</strong> (<em>array</em>) – The possible age models returned by BChron. The number
of rows should be the same length as the depth vector, with each
possible realization stored in the columns.</p></li>
<li><p><strong>positions</strong> (<em>array</em>) – The depth on the archive at which chronological
measurements have been made. Should be a vector</p></li>
<li><p><strong>agesDist</strong> (<em>array</em>) – The distribution of ages for each chronological tie
points. The number of columns should correspond to the number of
chronological tie points available.</p></li>
<li><p><strong>flipCoor</strong> (<em>bool</em>) – If True, plots depth on the y-axis.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>) – The label for the x-axis</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – The label for the y-axis</p></li>
<li><p><strong>xlim</strong> (<em>list</em>) – Limits for the x-axis. Default corresponds to the min/max
of the depth vector.</p></li>
<li><p><strong>ylim</strong> (<em>list</em>) – Limits for the y-axis. Default set by matplotlib</p></li>
<li><p><strong>violinColor</strong> (<em>str</em>) – The color for the violins. Default is purple</p></li>
<li><p><strong>medianLineColor</strong> (<em>str</em>) – The color for the median line. Default is black.</p></li>
<li><p><strong>medianLineWidth</strong> (<em>float</em>) – The width for the median line</p></li>
<li><p><strong>CIFillColor</strong> (<em>str</em>) – Fill color in between the 95% confidence interval.
Default is silver.</p></li>
<li><p><strong>samplePaths</strong> (<em>bool</em>) – If True, draws sample paths from the distribution.
Use the same color as the violins.</p></li>
<li><p><strong>samplePathNumber</strong> (<em>int</em>) – The number of sample paths to draw. Default is 10.
Note: samplePaths need to be set to True.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The violins’ transparency. Number between 0 and 1</p></li>
<li><p><strong>figsize</strong> (<em>list</em>) – The figure size. Default is [4,8]</p></li>
<li><p><strong>ax</strong> – Default is None. Useful to set for subplots.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the figure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>fig</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="Spectral.html" class="btn btn-neutral float-left" title="Spectral Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2019, Deborah Khider, Feng Zhu, Julien Emile-Geay

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>